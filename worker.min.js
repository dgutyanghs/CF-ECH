function isValidFormat(e){const n=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;return n.test(e)}function isValidIP(e){const n=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;if(n.test(e))return!0;const t=/^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$/;if(t.test(e))return!0;const o=/^::1$|^::$|^(?:[0-9a-fA-F]{1,4}:)*::(?:[0-9a-fA-F]{1,4}:)*[0-9a-fA-F]{1,4}$/;return!!o.test(e)}async function initKVStore(e){if(e.C)try{kvStore=e.C,await loadKVConfig()}catch(e){kvStore=null}}async function loadKVConfig(){if(kvStore)try{const e=await kvStore.get("c");e&&(kvConfig=JSON.parse(e))}catch(e){kvConfig={}}}async function saveKVConfig(){if(kvStore)try{const e=JSON.stringify(kvConfig);await kvStore.put("c",e)}catch(e){throw e}}function getConfigValue(e,n=""){return void 0!==kvConfig[e]?kvConfig[e]:n}async function setConfigValue(e,n){kvConfig[e]=n,await saveKVConfig()}async function detectWorkerRegion(e){try{const n=e.cf?.country;if(n){const e={US:"US",SG:"SG",JP:"JP",KR:"KR",DE:"DE",SE:"SE",NL:"NL",FI:"FI",GB:"GB",CN:"SG",TW:"JP",AU:"SG",CA:"US",FR:"DE",IT:"DE",ES:"DE",CH:"DE",AT:"DE",BE:"NL",DK:"SE",NO:"SE",IE:"GB"};if(e[n])return e[n]}return"SG"}catch(e){return"SG"}}async function checkIPAvailability(e,n=443,t=2e3){try{const n=new AbortController,o=setTimeout(()=>n.abort(),t),a=await fetch(`https://${e}`,{method:"HEAD",signal:n.signal,headers:{"User-Agent":"Mozilla/5.0 (compatible; CF-IP-Checker/1.0)"}});return clearTimeout(o),a.status<500}catch(e){return!0}}async function getBestBackupIP(e=""){if(0===backupIPs.length)return null;const n=backupIPs.map(e=>({...e,available:!0}));if(enableRegionMatching&&e){const t=getSmartRegionSelection(e,n);if(t.length>0){const e=t[0];return e}}const t=n[0];return t}function getNearbyRegions(e){const n={US:["SG","JP","KR"],SG:["JP","KR","US"],JP:["SG","KR","US"],KR:["JP","SG","US"],DE:["NL","GB","SE","FI"],SE:["DE","NL","FI","GB"],NL:["DE","GB","SE","FI"],FI:["SE","DE","NL","GB"],GB:["DE","NL","SE","FI"]};return n[e]||[]}function getAllRegionsByPriority(e){const n=getNearbyRegions(e),t=["US","SG","JP","KR","DE","SE","NL","FI","GB"];return[e,...n,...t.filter(t=>t!==e&&!n.includes(t))]}function getSmartRegionSelection(e,n){if(!enableRegionMatching||!e)return n;const t=getAllRegionsByPriority(e),o=[];for(const e of t){const t=n.filter(n=>n.regionCode===e);o.push(...t)}return o}function parseAddressAndPort(e){if(e.includes("[")&&e.includes("]")){const n=e.match(/^\[([^\]]+)\](?::(\d+))?$/);if(n)return{address:n[1],port:n[2]?parseInt(n[2],10):null}}const n=e.lastIndexOf(":");if(n>0){const t=e.substring(0,n),o=e.substring(n+1),a=parseInt(o,10);if(!isNaN(a)&&a>0&&a<=65535)return{address:t,port:a}}return{address:e,port:null}}function generateQuantumultConfig(e){return btoa(e.join("\n"))}function parseLinkToClashNode(e){try{if(e.startsWith("vless://")){const n=new URL(e),t=decodeURIComponent(n.hash.substring(1)),o=n.username,a=n.hostname,r=parseInt(n.port)||443,s=new URLSearchParams(n.search),i="tls"===s.get("security")||"true"===s.get("tls"),l=s.get("type")||"ws",c=s.get("path")||"/?ed=2048",d=s.get("host")||a,p=s.get("sni")||d,u=s.get("alpn")||"h3,h2,http/1.1",f=s.get("fp")||s.get("client-fingerprint")||"chrome",m=s.get("ech"),g={name:t,type:"vless",server:a,port:r,uuid:o,tls:i,network:l,"client-fingerprint":f};return i&&(g.servername=p,g.alpn=u.split(",").map(e=>e.trim()),g["skip-cert-verify"]=!1),"ws"===l&&(g["ws-opts"]={path:c,headers:{Host:d}}),m&&(g["ech-opts"]={enable:!0}),g}if(e.startsWith("trojan://")){const n=new URL(e),t=decodeURIComponent(n.hash.substring(1)),o=n.username,a=n.hostname,r=parseInt(n.port)||443,s=new URLSearchParams(n.search),i=s.get("type")||"ws",l=s.get("path")||"/?ed=2048",c=s.get("host")||a,d=s.get("sni")||c,p=s.get("alpn")||"h3,h2,http/1.1",u=s.get("ech"),f={name:t,type:"trojan",server:a,port:r,password:o,network:i,sni:d,alpn:p.split(",").map(e=>e.trim()),"skip-cert-verify":!1};return"ws"===i&&(f["ws-opts"]={path:l,headers:{Host:c}}),u&&(f["ech-opts"]={enable:!0}),f}}catch(e){return null}return null}async function generateClashConfig(e,n,t){const o=new URL(n.url);o.pathname=o.pathname.replace(/\/sub$/,"")+"/sub",o.searchParams.set("target","base64");const a=encodeURIComponent(o.toString()),r=`${scu}?target=clash&url=${a}&insert=false&emoji=true&list=false&xudp=false&udp=false&tfo=false&expand=true&scv=false&fdn=false&new_name=true`;try{const e=await fetch(r);if(!e.ok)throw new Error("è®¢é˜…è½¬æ¢æœåŠ¡å¤±è´¥");let n=await e.text();return enableECH&&(n=n.split("\n").map(e=>{if(/^\s*-\s*\{/.test(e)&&e.includes("name:")&&e.includes("server:")){if(e.includes("ech-opts"))return e;const n=e.lastIndexOf("}");if(n>0){const t=e.substring(0,n).trim();if(t.length>0){const o=!t.endsWith(",")&&!t.endsWith("{");return e.substring(0,n)+(o?", ":" ")+"ech-opts: {enable: true}"+e.substring(n)}}}return e}).join("\n")),n=n.replace(/^(\s*nameserver:\s*\n)((?:\s*-\s*[^\n]+\n)*)/m,(e,n,t)=>{const o=customDNS||"https://dns.aliyuncs.com/dns-query";return n+`    - ${o}\n`}),n}catch(e){throw new Error("æ— æ³•è·å– Clash é…ç½®: "+e.message)}}async function fetchECHConfig(e){if(!enableECH)return echDebugInfo="ECHåŠŸèƒ½å·²ç¦ç”¨",null;echDebugInfo="";const n=[];try{n.push("å°è¯•ä½¿ç”¨ Google DNS æŸ¥è¯¢ cloudflare-ech.com...");const t="https://v.recipes/dns/dns.google/dns-query?name=cloudflare-ech.com&type=65",o=await fetch(t,{headers:{Accept:"application/json"}});if(n.push(`Google DNS å“åº”çŠ¶æ€: ${o.status}`),o.ok){const e=await o.json();if(n.push(`Google DNS è¿”å›æ•°æ®: ${JSON.stringify(e).substring(0,200)}...`),e.Answer&&e.Answer.length>0){n.push(`æ‰¾åˆ° ${e.Answer.length} æ¡ç­”æ¡ˆè®°å½•`);for(const t of e.Answer)if(t.data){n.push(`è§£æç­”æ¡ˆæ•°æ®: ${typeof t.data}, é•¿åº¦: ${String(t.data).length}`);const e="string"==typeof t.data?t.data:JSON.stringify(t.data),o=e.match(/ech=([^\s"']+)/);if(o&&o[1])return echDebugInfo=n.join("\\n")+"\\nâœ… æˆåŠŸä» Google DNS è·å– ECH é…ç½®",o[1];if(t.data&&!e.includes("ech="))try{const e=atob(t.data);n.push(`å°è¯• base64 è§£ç ï¼Œè§£ç åé•¿åº¦: ${e.length}`);const o=e.match(/ech=([^\s"']+)/);if(o&&o[1])return echDebugInfo=n.join("\\n")+"\\nâœ… æˆåŠŸä» Google DNS (base64è§£ç ) è·å– ECH é…ç½®",o[1]}catch(e){n.push(`base64 è§£ç å¤±è´¥: ${e.message}`)}}}else n.push("Google DNS æœªè¿”å›ç­”æ¡ˆè®°å½•")}else n.push(`Google DNS è¯·æ±‚å¤±è´¥: ${o.status}`);n.push(`å°è¯•ä½¿ç”¨ Google DNS æŸ¥è¯¢ç›®æ ‡åŸŸå ${e}...`);const a=`https://v.recipes/dns/dns.google/dns-query?name=${encodeURIComponent(e)}&type=65`,r=await fetch(a,{headers:{Accept:"application/json"}});if(n.push(`Google DNS (ç›®æ ‡åŸŸå) å“åº”çŠ¶æ€: ${r.status}`),r.ok){const e=await r.json();if(n.push(`Google DNS (ç›®æ ‡åŸŸå) è¿”å›æ•°æ®: ${JSON.stringify(e).substring(0,200)}...`),e.Answer&&e.Answer.length>0){n.push(`æ‰¾åˆ° ${e.Answer.length} æ¡ç­”æ¡ˆè®°å½•`);for(const t of e.Answer)if(t.data){const e="string"==typeof t.data?t.data:JSON.stringify(t.data),o=e.match(/ech=([^\s"']+)/);if(o&&o[1])return echDebugInfo=n.join("\\n")+"\\nâœ… æˆåŠŸä» Google DNS (ç›®æ ‡åŸŸå) è·å– ECH é…ç½®",o[1];try{const e=atob(t.data),o=e.match(/ech=([^\s"']+)/);if(o&&o[1])return echDebugInfo=n.join("\\n")+"\\nâœ… æˆåŠŸä» Google DNS (ç›®æ ‡åŸŸå, base64è§£ç ) è·å– ECH é…ç½®",o[1]}catch(e){n.push(`base64 è§£ç å¤±è´¥: ${e.message}`)}}}else n.push("Google DNS (ç›®æ ‡åŸŸå) æœªè¿”å›ç­”æ¡ˆè®°å½•")}else n.push(`Google DNS (ç›®æ ‡åŸŸå) è¯·æ±‚å¤±è´¥: ${r.status}`);n.push("å°è¯•ä½¿ç”¨ Cloudflare DNS ä½œä¸ºå¤‡é€‰...");const s="https://cloudflare-dns.com/dns-query?name=cloudflare-ech.com&type=65",i=await fetch(s,{headers:{Accept:"application/dns-json"}});if(n.push(`Cloudflare DNS å“åº”çŠ¶æ€: ${i.status}`),i.ok){const e=await i.json();if(n.push(`Cloudflare DNS è¿”å›æ•°æ®: ${JSON.stringify(e).substring(0,200)}...`),e.Answer&&e.Answer.length>0){n.push(`æ‰¾åˆ° ${e.Answer.length} æ¡ç­”æ¡ˆè®°å½•`);for(const t of e.Answer)if(t.data){const e=t.data.match(/ech=([^\s"']+)/);if(e&&e[1])return echDebugInfo=n.join("\\n")+"\\nâœ… æˆåŠŸä» Cloudflare DNS è·å– ECH é…ç½®",e[1]}}else n.push("Cloudflare DNS æœªè¿”å›ç­”æ¡ˆè®°å½•")}else n.push(`Cloudflare DNS è¯·æ±‚å¤±è´¥: ${i.status}`);return echDebugInfo=n.join("\\n")+"\\nâŒ æ‰€æœ‰DNSæŸ¥è¯¢å‡å¤±è´¥ï¼Œæœªè·å–åˆ°ECHé…ç½®",null}catch(e){return echDebugInfo=n.join("\\n")+"\\nâŒ è·å–ECHé…ç½®æ—¶å‘ç”Ÿé”™è¯¯: "+e.message,null}}async function handleSubscriptionRequest(e,n,t=null){async function o(e){ev&&a.push(...generateLinksFromSource(e,n,r,i)),et&&a.push(...await generateTrojanLinksFromSource(e,n,r,i)),ex&&a.push(...generateXhttpLinksFromSource(e,n,r,i))}t||(t=new URL(e.url));const a=[],r=t.hostname,s=t.searchParams.get("target")||"base64";let i=null;if(enableECH){const e=customDNS||"https://dns.alidns.com/dns-query",n=customECHDomain||"cloudflare-ech.com";i=`${n}+${e}`}if("CUSTOM"===currentWorkerRegion){const e=[{ip:r,isp:"åŸç”Ÿåœ°å€"}];await o(e)}else try{const e=[{ip:r,isp:"åŸç”Ÿåœ°å€"}];await o(e)}catch(n){currentWorkerRegion||(currentWorkerRegion=await detectWorkerRegion(e));const t=await getBestBackupIP(currentWorkerRegion);if(t){fallbackAddress=t.domain+":"+t.port;const e=[{ip:t.domain,isp:"ProxyIP-"+currentWorkerRegion}];await o(e)}else{const e=[{ip:r,isp:"åŸç”Ÿåœ°å€"}];await o(e)}}const l=customPreferredIPs.length>0||customPreferredDomains.length>0;if(disablePreferred);else if(l){if(customPreferredIPs.length>0&&epi&&await o(customPreferredIPs),customPreferredDomains.length>0&&epd){const e=customPreferredDomains.map(e=>({ip:e.domain,isp:e.name||e.domain}));await o(e)}}else{if(epd){const e=directDomains.map(e=>({ip:e.domain,isp:e.name||e.domain}));await o(e)}if(epi){const n="https://raw.githubusercontent.com/qwer-search/bestip/refs/heads/main/kejilandbestip.txt";if(piu===n)try{const e=await fetchDynamicIPs();e.length>0&&await o(e)}catch(n){currentWorkerRegion||(currentWorkerRegion=await detectWorkerRegion(e));const t=await getBestBackupIP(currentWorkerRegion);if(t){fallbackAddress=t.domain+":"+t.port;const e=[{ip:t.domain,isp:"ProxyIP-"+currentWorkerRegion}];await o(e)}}}if(egi)try{const e=await fetchAndParseNewIPs();e.length>0&&(ev&&a.push(...generateLinksFromNewIPs(e,n,r,i)),et&&a.push(...await generateTrojanLinksFromNewIPs(e,n,r,i)))}catch(n){currentWorkerRegion||(currentWorkerRegion=await detectWorkerRegion(e));const t=await getBestBackupIP(currentWorkerRegion);if(t){fallbackAddress=t.domain+":"+t.port;const e=[{ip:t.domain,isp:"ProxyIP-"+currentWorkerRegion}];await o(e)}}}if(0===a.length){const e="æ‰€æœ‰èŠ‚ç‚¹è·å–å¤±è´¥",n=atob("dmxlc3M="),t=`${n}://00000000-0000-0000-0000-000000000000@127.0.0.1:80?encryption=none&security=none&type=ws&host=error.com&path=%2F#${encodeURIComponent(e)}`;a.push(t)}let c,d="text/plain; charset=utf-8";switch(s.toLowerCase()){case atob("Y2xhc2g="):case atob("Y2xhc2hy"):c=await generateClashConfig(a,e,n),d="text/yaml; charset=utf-8";break;case atob("c3VyZ2U="):case atob("c3VyZ2Uy"):case atob("c3VyZ2Uz"):case atob("c3VyZ2U0"):c=generateSurgeConfig(a);break;case atob("cXVhbnR1bXVsdA=="):case atob("cXVhbng="):case"quanx":c=generateQuantumultConfig(a);break;case atob("c3M="):case atob("c3Ny"):c=generateSSConfig(a);break;case atob("djJyYXk="):c=generateV2RayConfig(a);break;case atob("bG9vbg=="):c=generateLoonConfig(a);break;default:c=btoa(a.join("\n"))}const p={"Content-Type":d,"Cache-Control":"no-store, no-cache, must-revalidate, max-age=0"};return enableECH&&(p["X-ECH-Status"]="ENABLED",i&&(p["X-ECH-Config-Length"]=String(i.length))),new Response(c,{headers:p})}function generateLinksFromSource(e,n,t,o=null){const a=[80,8080,8880,2052,2082,2086,2095],r=[443,2053,2083,2087,2096,8443],s=[443],i=disableNonTLS?[]:[80],l=[],c="/?ed=2048",d=atob("dmxlc3M=");return e.forEach(e=>{let o=e.isp.replace(/\s/g,"_");e.colo&&e.colo.trim()&&(o=`${o}-${e.colo.trim()}`);const p=e.ip.includes(":")?`[${e.ip}]`:e.ip;let u=[];if(e.port){const n=e.port;r.includes(n)?u.push({port:n,tls:!0}):a.includes(n)?disableNonTLS||u.push({port:n,tls:!1}):u.push({port:n,tls:!0})}else s.forEach(e=>{u.push({port:e,tls:!0})}),i.forEach(e=>{u.push({port:e,tls:!1})});u.forEach(({port:e,tls:a})=>{if(a){const a=`${o}-${e}-WS-TLS`,r=new URLSearchParams({encryption:"none",security:"tls",sni:t,fp:enableECH?"chrome":"randomized",type:"ws",host:t,path:c});if(enableECH){const e=customDNS||"https://dns.alidns.com/dns-query",n=customECHDomain||"cloudflare-ech.com";r.set("alpn","h3,h2,http/1.1"),r.set("ech",`${n}+${e}`)}l.push(`${d}://${n}@${p}:${e}?${r.toString()}#${encodeURIComponent(a)}`)}else{const a=`${o}-${e}-WS`,r=new URLSearchParams({encryption:"none",security:"none",type:"ws",host:t,path:c});l.push(`${d}://${n}@${p}:${e}?${r.toString()}#${encodeURIComponent(a)}`)}})}),l}async function generateTrojanLinksFromSource(e,n,t,o=null){const a=[80,8080,8880,2052,2082,2086,2095],r=[443,2053,2083,2087,2096,8443],s=[443],i=disableNonTLS?[]:[80],l=[],c="/?ed=2048",d=tp||n;return e.forEach(e=>{let n=e.isp.replace(/\s/g,"_");e.colo&&e.colo.trim()&&(n=`${n}-${e.colo.trim()}`);const o=e.ip.includes(":")?`[${e.ip}]`:e.ip;let p=[];if(e.port){const n=e.port;r.includes(n)?p.push({port:n,tls:!0}):a.includes(n)?disableNonTLS||p.push({port:n,tls:!1}):p.push({port:n,tls:!0})}else s.forEach(e=>{p.push({port:e,tls:!0})}),i.forEach(e=>{p.push({port:e,tls:!1})});p.forEach(({port:e,tls:a})=>{if(a){const a=`${n}-${e}-${atob("VHJvamFu")}-WS-TLS`,r=new URLSearchParams({security:"tls",sni:t,fp:"chrome",type:"ws",host:t,path:c});if(enableECH){const e=customDNS||"https://dns.alidns.com/dns-query",n=customECHDomain||"cloudflare-ech.com";r.set("alpn","h3,h2,http/1.1"),r.set("ech",`${n}+${e}`)}l.push(`${atob("dHJvamFuOi8v")}${d}@${o}:${e}?${r.toString()}#${encodeURIComponent(a)}`)}else{const a=`${n}-${e}-${atob("VHJvamFu")}-WS`,r=new URLSearchParams({security:"none",type:"ws",host:t,path:c});l.push(`${atob("dHJvamFuOi8v")}${d}@${o}:${e}?${r.toString()}#${encodeURIComponent(a)}`)}})}),l}async function fetchDynamicIPs(){const e="https://www.wetest.vip/page/cloudflare/address_v4.html",n="https://www.wetest.vip/page/cloudflare/address_v6.html";let t=[];const o=""===getConfigValue("ipv4","")||"no"!==getConfigValue("ipv4","yes"),a=""===getConfigValue("ipv6","")||"no"!==getConfigValue("ipv6","yes"),r=""===getConfigValue("ispMobile","")||"no"!==getConfigValue("ispMobile","yes"),s=""===getConfigValue("ispUnicom","")||"no"!==getConfigValue("ispUnicom","yes"),i=""===getConfigValue("ispTelecom","")||"no"!==getConfigValue("ispTelecom","yes");try{const l=[];o?l.push(fetchAndParseWetest(e)):l.push(Promise.resolve([])),a?l.push(fetchAndParseWetest(n)):l.push(Promise.resolve([]));const[c,d]=await Promise.all(l);if(t=[...c,...d],t.length>0&&(t=t.filter(e=>{const n=e.isp||"";return!(n.includes("ç§»åŠ¨")&&!r)&&(!(n.includes("è”é€š")&&!s)&&!(n.includes("ç”µä¿¡")&&!i))})),t.length>0)return t}catch(e){}return[]}async function fetchAndParseWetest(e){try{const n=await fetch(e,{headers:{"User-Agent":"Mozilla/5.0"}});if(!n.ok)return[];const t=await n.text(),o=[],a=/<tr[\s\S]*?<\/tr>/g,r=/<td data-label="çº¿è·¯åç§°">(.+?)<\/td>[\s\S]*?<td data-label="ä¼˜é€‰åœ°å€">([\d.:a-fA-F]+)<\/td>[\s\S]*?<td data-label="æ•°æ®ä¸­å¿ƒ">(.+?)<\/td>/;let s;for(;null!==(s=a.exec(t));){const e=s[0],n=e.match(r);if(n&&n[1]&&n[2]){const e=n[3]?n[3].trim().replace(/<.*?>/g,""):"";o.push({isp:n[1].trim().replace(/<.*?>/g,""),ip:n[2].trim(),colo:e})}}return o.length,o}catch(e){return[]}}async function handleWsRequest(e){currentWorkerRegion&&""!==currentWorkerRegion||(currentWorkerRegion=manualWorkerRegion&&manualWorkerRegion.trim()?manualWorkerRegion.trim().toUpperCase():await detectWorkerRegion(e));const n=new WebSocketPair,[t,o]=Object.values(n);o.accept();let a={socket:null},r=!1,s=null;const i=e.headers.get(atob("c2VjLXdlYnNvY2tldC1wcm90b2NvbA=="))||"",l=makeReadableStream(o,i);return l.pipeTo(new WritableStream({async write(e){if(r)return await forwardUDP(e,o,null);if(a.socket){const n=a.socket.writable.getWriter();return await n.write(e),void n.releaseLock()}if(!s){if(ev&&e.byteLength>=24){const n=parseWsPacketHeader(e,at);if(!n.hasError){s="vless";const{addressType:t,port:i,hostname:l,rawIndex:c,version:d,isUDP:p}=n;if(p){if(53!==i)throw new Error(E_UDP_DNS_ONLY);r=!0}const u=new Uint8Array([d[0],0]),f=e.slice(c);return r?forwardUDP(f,o,u):void await forwardTCP(t,l,i,f,o,u,a)}}if(et&&e.byteLength>=56){const n=await parseTrojanHeader(e,at);if(!n.hasError){s=atob("dHJvamFu");const{addressType:e,port:t,hostname:r,rawClientData:i}=n;return void await forwardTCP(e,r,t,i,o,null,a)}}throw new Error("Invalid protocol or authentication failed")}}})).catch(e=>{}),new Response(null,{status:101,webSocket:t})}async function forwardTCP(e,n,t,o,a,r,s){async function i(n,t,a=!1){const r=a?await establishSocksConnection(e,n,t):connect({hostname:n,port:t}),s=r.writable.getWriter();return await s.write(o),s.releaseLock(),r}async function l(){if(enableSocksDowngrade&&isSocksEnabled)try{const e=await i(n,t,!0);return s.socket=e,e.closed.catch(()=>{}).finally(()=>closeSocketQuietly(a)),void connectStreams(e,a,r,null)}catch(e){let o,l;if(fallbackAddress&&fallbackAddress.trim()){const e=parseAddressAndPort(fallbackAddress);o=e.address,l=e.port||t}else{const e=await getBestBackupIP(currentWorkerRegion);o=e?e.domain:n,l=e?e.port:t}try{const e=await i(o,l,!1);s.socket=e,e.closed.catch(()=>{}).finally(()=>closeSocketQuietly(a)),connectStreams(e,a,r,null)}catch(e){closeSocketQuietly(a)}}else{let e,o;if(fallbackAddress&&fallbackAddress.trim()){const n=parseAddressAndPort(fallbackAddress);e=n.address,o=n.port||t}else{const a=await getBestBackupIP(currentWorkerRegion);e=a?a.domain:n,o=a?a.port:t}try{const n=await i(e,o,isSocksEnabled);s.socket=n,n.closed.catch(()=>{}).finally(()=>closeSocketQuietly(a)),connectStreams(n,a,r,null)}catch(e){closeSocketQuietly(a)}}}try{const e=await i(n,t,!enableSocksDowngrade&&isSocksEnabled);s.socket=e,connectStreams(e,a,r,l)}catch(e){l()}}function parseWsPacketHeader(e,n){if(e.byteLength<24)return{hasError:!0,message:E_INVALID_DATA};const t=new Uint8Array(e.slice(0,1));if(formatIdentifier(new Uint8Array(e.slice(1,17)))!==n)return{hasError:!0,message:E_INVALID_USER};const o=new Uint8Array(e.slice(17,18))[0],a=new Uint8Array(e.slice(18+o,19+o))[0];let r=!1;if(1===a);else{if(2!==a)return{hasError:!0,message:E_UNSUPPORTED_CMD};r=!0}const s=19+o,i=new DataView(e.slice(s,s+2)).getUint16(0);let l=s+2,c=0,d=l+1,p="";const u=new Uint8Array(e.slice(l,d))[0];switch(u){case ADDRESS_TYPE_IPV4:c=4,p=new Uint8Array(e.slice(d,d+c)).join(".");break;case ADDRESS_TYPE_URL:c=new Uint8Array(e.slice(d,d+1))[0],d+=1,p=(new TextDecoder).decode(e.slice(d,d+c));break;case ADDRESS_TYPE_IPV6:c=16;const n=[],t=new DataView(e.slice(d,d+c));for(let e=0;e<8;e++)n.push(t.getUint16(2*e).toString(16));p=n.join(":");break;default:return{hasError:!0,message:`${E_INVALID_ADDR_TYPE}: ${u}`}}return p?{hasError:!1,addressType:u,port:i,hostname:p,isUDP:r,rawIndex:d+c,version:t}:{hasError:!0,message:`${E_EMPTY_ADDR}: ${u}`}}function makeReadableStream(e,n){let t=!1;return new ReadableStream({start(o){e.addEventListener("message",e=>{t||o.enqueue(e.data)}),e.addEventListener("close",()=>{t||(closeSocketQuietly(e),o.close())}),e.addEventListener("error",e=>o.error(e));const{earlyData:a,error:r}=base64ToArray(n);r?o.error(r):a&&o.enqueue(a)},cancel(){t=!0,closeSocketQuietly(e)}})}async function connectStreams(e,n,t,o){let a=t,r=!1;await e.readable.pipeTo(new WritableStream({async write(e,t){r=!0,1!==n.readyState&&t.error(E_WS_NOT_OPEN),a?(n.send(await new Blob([a,e]).arrayBuffer()),a=null):n.send(e)},abort(e){}})).catch(e=>{closeSocketQuietly(n)}),!r&&o&&o()}async function forwardUDP(e,n,t){try{const o=connect({hostname:"8.8.4.4",port:53});let a=t;const r=o.writable.getWriter();await r.write(e),r.releaseLock(),await o.readable.pipeTo(new WritableStream({async write(e){1===n.readyState&&(a?(n.send(await new Blob([a,e]).arrayBuffer()),a=null):n.send(e))}}))}catch(e){}}async function establishSocksConnection(e,n,t){const{username:o,password:a,hostname:r,socksPort:s}=parsedSocks5Config,i=connect({hostname:r,port:s}),l=i.writable.getWriter();await l.write(new Uint8Array(o?[5,2,0,2]:[5,1,0]));const c=i.readable.getReader();let d=(await c.read()).value;if(5!==d[0]||255===d[1])throw new Error(E_SOCKS_NO_METHOD);if(2===d[1]){if(!o||!a)throw new Error(E_SOCKS_AUTH_NEEDED);const e=new TextEncoder,n=new Uint8Array([1,o.length,...e.encode(o),a.length,...e.encode(a)]);if(await l.write(n),d=(await c.read()).value,1!==d[0]||0!==d[1])throw new Error(E_SOCKS_AUTH_FAIL)}const p=new TextEncoder;let u;switch(e){case ADDRESS_TYPE_IPV4:u=new Uint8Array([1,...n.split(".").map(Number)]);break;case ADDRESS_TYPE_URL:u=new Uint8Array([3,n.length,...p.encode(n)]);break;case ADDRESS_TYPE_IPV6:u=new Uint8Array([4,...n.split(":").flatMap(e=>[parseInt(e.slice(0,2),16),parseInt(e.slice(2),16)])]);break;default:throw new Error(E_INVALID_ADDR_TYPE)}if(await l.write(new Uint8Array([5,1,0,...u,t>>8,255&t])),d=(await c.read()).value,0!==d[1])throw new Error(E_SOCKS_CONN_FAIL);return l.releaseLock(),c.releaseLock(),i}function parseSocksConfig(e){let n,t,o,a,[r,s]=e.split("@").reverse();if(s){const e=s.split(":");if(2!==e.length)throw new Error(E_INVALID_SOCKS_ADDR);[n,t]=e}const i=r.split(":");if(a=Number(i.pop()),isNaN(a))throw new Error(E_INVALID_SOCKS_ADDR);if(o=i.join(":"),o.includes(":")&&!/^\[.*\]$/.test(o))throw new Error(E_INVALID_SOCKS_ADDR);return{username:n,password:t,hostname:o,socksPort:a}}async function handleSubscriptionPage(e,n=null){n||(n=at);new URL(e.url);const t=e.headers.get("Cookie")||"";let o=null;if(t){const e=t.split(";").map(e=>e.trim());for(const n of e)if(n.startsWith("preferredLanguage=")){o=n.split("=")[1];break}}let a=!1;if("fa"===o||"fa-IR"===o)a=!0;else if("zh"===o||"zh-CN"===o)a=!1;else{const n=e.headers.get("Accept-Language")||"",t=n.split(",")[0].split("-")[0].toLowerCase();a="fa"===t||n.includes("fa-IR")||n.includes("fa")}const r=a?"fa-IR":"zh-CN",s={zh:{title:"è®¢é˜…ä¸­å¿ƒ",subtitle:"å¤šå®¢æˆ·ç«¯æ”¯æŒ â€¢ æ™ºèƒ½ä¼˜é€‰ â€¢ ä¸€é”®ç”Ÿæˆ",selectClient:"[ é€‰æ‹©å®¢æˆ·ç«¯ ]",systemStatus:"[ ç³»ç»ŸçŠ¶æ€ ]",configManagement:"[ é…ç½®ç®¡ç† ]",relatedLinks:"[ ç›¸å…³é“¾æ¥ ]",checking:"æ£€æµ‹ä¸­...",workerRegion:"Workeråœ°åŒº: ",detectionMethod:"æ£€æµ‹æ–¹å¼: ",proxyIPStatus:"ProxyIPçŠ¶æ€: ",currentIP:"å½“å‰ä½¿ç”¨IP: ",regionMatch:"åœ°åŒºåŒ¹é…: ",selectionLogic:"é€‰æ‹©é€»è¾‘: ",kvStatusChecking:"æ£€æµ‹KVçŠ¶æ€ä¸­...",kvEnabled:"âœ… KVå­˜å‚¨å·²å¯ç”¨ï¼Œå¯ä»¥ä½¿ç”¨é…ç½®ç®¡ç†åŠŸèƒ½",kvDisabled:"âš ï¸ KVå­˜å‚¨æœªå¯ç”¨æˆ–æœªé…ç½®",specifyRegion:"æŒ‡å®šåœ°åŒº (wk):",autoDetect:"è‡ªåŠ¨æ£€æµ‹",saveRegion:"ä¿å­˜åœ°åŒºé…ç½®",protocolSelection:"åè®®é€‰æ‹©:",enableVLESS:"å¯ç”¨ VLESS åè®®",enableTrojan:"å¯ç”¨ Trojan åè®®",enableXhttp:"å¯ç”¨ xhttp åè®®",trojanPassword:"Trojan å¯†ç  (å¯é€‰):",customPath:"è‡ªå®šä¹‰è·¯å¾„ (d):",customIP:"è‡ªå®šä¹‰ProxyIP (p):",preferredIPs:"ä¼˜é€‰IPåˆ—è¡¨ (yx):",preferredIPsURL:"ä¼˜é€‰IPæ¥æºURL (yxURL):",latencyTest:"å»¶è¿Ÿæµ‹è¯•",latencyTestIP:"æµ‹è¯•IP/åŸŸå:",latencyTestIPPlaceholder:"è¾“å…¥IPæˆ–åŸŸåï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”",latencyTestPort:"ç«¯å£:",startTest:"å¼€å§‹æµ‹è¯•",stopTest:"åœæ­¢æµ‹è¯•",testResult:"æµ‹è¯•ç»“æœ:",addToYx:"æ·»åŠ åˆ°ä¼˜é€‰åˆ—è¡¨",addSelectedToYx:"æ·»åŠ é€‰ä¸­é¡¹åˆ°ä¼˜é€‰åˆ—è¡¨",selectAll:"å…¨é€‰",deselectAll:"å–æ¶ˆå…¨é€‰",testingInProgress:"æµ‹è¯•ä¸­...",testComplete:"æµ‹è¯•å®Œæˆ",latencyMs:"å»¶è¿Ÿ",timeout:"è¶…æ—¶",ipSource:"IPæ¥æº:",manualInput:"æ‰‹åŠ¨è¾“å…¥",cfRandomIP:"CFéšæœºIP",urlFetch:"URLè·å–",randomCount:"ç”Ÿæˆæ•°é‡:",fetchURL:"è·å–URL:",fetchURLPlaceholder:"è¾“å…¥ä¼˜é€‰IPçš„URLåœ°å€",generateIP:"ç”ŸæˆIP",fetchIP:"è·å–IP",socks5Config:"SOCKS5é…ç½® (s):",customHomepage:"è‡ªå®šä¹‰é¦–é¡µURL (homepage):",customHomepagePlaceholder:"ä¾‹å¦‚: https://example.com",customHomepageHint:"è®¾ç½®è‡ªå®šä¹‰URLä½œä¸ºé¦–é¡µä¼ªè£…ã€‚è®¿é—®æ ¹è·¯å¾„ / æ—¶å°†æ˜¾ç¤ºè¯¥URLçš„å†…å®¹ã€‚ç•™ç©ºåˆ™æ˜¾ç¤ºé»˜è®¤ç»ˆç«¯é¡µé¢ã€‚",saveConfig:"ä¿å­˜é…ç½®",advancedControl:"é«˜çº§æ§åˆ¶",subscriptionConverter:"è®¢é˜…è½¬æ¢åœ°å€:",builtinPreferred:"å†…ç½®ä¼˜é€‰ç±»å‹:",enablePreferredDomain:"å¯ç”¨ä¼˜é€‰åŸŸå",enablePreferredIP:"å¯ç”¨ä¼˜é€‰ IP",enableGitHubPreferred:"å¯ç”¨ GitHub é»˜è®¤ä¼˜é€‰",allowAPIManagement:"å…è®¸APIç®¡ç† (ae):",regionMatching:"åœ°åŒºåŒ¹é… (rm):",downgradeControl:"é™çº§æ§åˆ¶ (qj):",tlsControl:"TLSæ§åˆ¶ (dkby):",preferredControl:"ä¼˜é€‰æ§åˆ¶ (yxby):",saveAdvanced:"ä¿å­˜é«˜çº§é…ç½®",loading:"åŠ è½½ä¸­...",currentConfig:"ğŸ“ å½“å‰è·¯å¾„é…ç½®",refreshConfig:"åˆ·æ–°é…ç½®",resetConfig:"é‡ç½®é…ç½®",subscriptionCopied:"è®¢é˜…é“¾æ¥å·²å¤åˆ¶",autoSubscriptionCopied:"è‡ªåŠ¨è¯†åˆ«è®¢é˜…é“¾æ¥å·²å¤åˆ¶ï¼Œå®¢æˆ·ç«¯è®¿é—®æ—¶ä¼šæ ¹æ®User-Agentè‡ªåŠ¨è¯†åˆ«å¹¶è¿”å›å¯¹åº”æ ¼å¼",trojanPasswordPlaceholder:"ç•™ç©ºåˆ™è‡ªåŠ¨ä½¿ç”¨ UUID",trojanPasswordHint:"è®¾ç½®è‡ªå®šä¹‰ Trojan å¯†ç ã€‚ç•™ç©ºåˆ™ä½¿ç”¨ UUIDã€‚å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨å¯¹å¯†ç è¿›è¡Œ SHA224 å“ˆå¸Œã€‚",protocolHint:"å¯ä»¥åŒæ—¶å¯ç”¨å¤šä¸ªåè®®ã€‚è®¢é˜…å°†ç”Ÿæˆé€‰ä¸­åè®®çš„èŠ‚ç‚¹ã€‚<br>â€¢ VLESS WS: åŸºäº WebSocket çš„æ ‡å‡†åè®®<br>â€¢ Trojan: ä½¿ç”¨ SHA224 å¯†ç è®¤è¯<br>â€¢ xhttp: åŸºäº HTTP POST çš„ä¼ªè£…åè®®ï¼ˆéœ€è¦ç»‘å®šè‡ªå®šä¹‰åŸŸåå¹¶å¼€å¯ gRPCï¼‰",enableECH:"å¯ç”¨ ECH (Encrypted Client Hello)",enableECHHint:"å¯ç”¨åï¼Œæ¯æ¬¡åˆ·æ–°è®¢é˜…æ—¶ä¼šè‡ªåŠ¨ä» DoH è·å–æœ€æ–°çš„ ECH é…ç½®å¹¶æ·»åŠ åˆ°é“¾æ¥ä¸­",customDNS:"è‡ªå®šä¹‰ DNS æœåŠ¡å™¨",customDNSPlaceholder:"ä¾‹å¦‚: https://dns.alidns.com/dns-query",customDNSHint:"ç”¨äºECHé…ç½®æŸ¥è¯¢çš„DNSæœåŠ¡å™¨åœ°å€ï¼ˆDoHæ ¼å¼ï¼‰",customECHDomain:"è‡ªå®šä¹‰ ECH åŸŸå",customECHDomainPlaceholder:"ä¾‹å¦‚: cloudflare-ech.com",customECHDomainHint:"ECHé…ç½®ä¸­ä½¿ç”¨çš„åŸŸåï¼Œç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤å€¼",saveProtocol:"ä¿å­˜åè®®é…ç½®",subscriptionConverterPlaceholder:"é»˜è®¤: https://url.v1.mk/sub",subscriptionConverterHint:"è‡ªå®šä¹‰è®¢é˜…è½¬æ¢APIåœ°å€ï¼Œç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤åœ°å€",builtinPreferredHint:"æ§åˆ¶è®¢é˜…ä¸­åŒ…å«å“ªäº›å†…ç½®ä¼˜é€‰èŠ‚ç‚¹ã€‚é»˜è®¤å…¨éƒ¨å¯ç”¨ã€‚",apiEnabledDefault:"é»˜è®¤ï¼ˆå…³é—­APIï¼‰",apiEnabledYes:"å¼€å¯APIç®¡ç†",apiEnabledHint:"âš ï¸ å®‰å…¨æé†’ï¼šå¼€å¯åå…è®¸é€šè¿‡APIåŠ¨æ€æ·»åŠ ä¼˜é€‰IPã€‚å»ºè®®ä»…åœ¨éœ€è¦æ—¶å¼€å¯ã€‚",regionMatchingDefault:"é»˜è®¤ï¼ˆå¯ç”¨åœ°åŒºåŒ¹é…ï¼‰",regionMatchingNo:"å…³é—­åœ°åŒºåŒ¹é…",regionMatchingHint:'è®¾ç½®ä¸º"å…³é—­"æ—¶ä¸è¿›è¡Œåœ°åŒºæ™ºèƒ½åŒ¹é…',downgradeControlDefault:"é»˜è®¤ï¼ˆä¸å¯ç”¨é™çº§ï¼‰",downgradeControlNo:"å¯ç”¨é™çº§æ¨¡å¼",downgradeControlHint:'è®¾ç½®ä¸º"å¯ç”¨"æ—¶ï¼šCFç›´è¿å¤±è´¥â†’SOCKS5è¿æ¥â†’fallbackåœ°å€',tlsControlDefault:"é»˜è®¤ï¼ˆä¿ç•™æ‰€æœ‰èŠ‚ç‚¹ï¼‰",tlsControlYes:"ä»…TLSèŠ‚ç‚¹",tlsControlHint:'è®¾ç½®ä¸º"ä»…TLSèŠ‚ç‚¹"æ—¶åªç”Ÿæˆå¸¦TLSçš„èŠ‚ç‚¹ï¼Œä¸ç”ŸæˆéTLSèŠ‚ç‚¹ï¼ˆå¦‚80ç«¯å£ï¼‰',preferredControlDefault:"é»˜è®¤ï¼ˆå¯ç”¨ä¼˜é€‰ï¼‰",preferredControlYes:"å…³é—­ä¼˜é€‰",preferredControlHint:'è®¾ç½®ä¸º"å…³é—­ä¼˜é€‰"æ—¶åªä½¿ç”¨åŸç”Ÿåœ°å€ï¼Œä¸ç”Ÿæˆä¼˜é€‰IPå’ŒåŸŸåèŠ‚ç‚¹',regionNames:{US:"ğŸ‡ºğŸ‡¸ ç¾å›½",SG:"ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡",JP:"ğŸ‡¯ğŸ‡µ æ—¥æœ¬",KR:"ğŸ‡°ğŸ‡· éŸ©å›½",DE:"ğŸ‡©ğŸ‡ª å¾·å›½",SE:"ğŸ‡¸ğŸ‡ª ç‘å…¸",NL:"ğŸ‡³ğŸ‡± è·å…°",FI:"ğŸ‡«ğŸ‡® èŠ¬å…°",GB:"ğŸ‡¬ğŸ‡§ è‹±å›½"},terminal:"ç»ˆç«¯ v2.9.2",githubProject:"GitHub é¡¹ç›®",autoDetectClient:"è‡ªåŠ¨è¯†åˆ«",selectionLogicText:"åŒåœ°åŒº â†’ é‚»è¿‘åœ°åŒº â†’ å…¶ä»–åœ°åŒº",customIPDisabledHint:"ä½¿ç”¨è‡ªå®šä¹‰ProxyIPæ—¶ï¼Œåœ°åŒºé€‰æ‹©å·²ç¦ç”¨",customIPMode:"è‡ªå®šä¹‰ProxyIPæ¨¡å¼ (på˜é‡å¯ç”¨)",customIPModeDesc:"è‡ªå®šä¹‰IPæ¨¡å¼ (å·²ç¦ç”¨åœ°åŒºåŒ¹é…)",usingCustomProxyIP:"ä½¿ç”¨è‡ªå®šä¹‰ProxyIP: ",customIPConfig:" (på˜é‡é…ç½®)",customIPModeDisabled:"è‡ªå®šä¹‰IPæ¨¡å¼ï¼Œåœ°åŒºé€‰æ‹©å·²ç¦ç”¨",manualRegion:"æ‰‹åŠ¨æŒ‡å®šåœ°åŒº",manualRegionDesc:" (æ‰‹åŠ¨æŒ‡å®š)",proxyIPAvailable:"10/10 å¯ç”¨ (ProxyIPåŸŸåé¢„è®¾å¯ç”¨)",smartSelection:"æ™ºèƒ½å°±è¿‘é€‰æ‹©ä¸­",sameRegionIP:"åŒåœ°åŒºIPå¯ç”¨ (1ä¸ª)",cloudflareDetection:"Cloudflareå†…ç½®æ£€æµ‹",detectionFailed:"æ£€æµ‹å¤±è´¥",apiTestResult:"APIæ£€æµ‹ç»“æœ: ",apiTestTime:"æ£€æµ‹æ—¶é—´: ",apiTestFailed:"APIæ£€æµ‹å¤±è´¥: ",unknownError:"æœªçŸ¥é”™è¯¯",apiTestError:"APIæµ‹è¯•å¤±è´¥: ",kvNotConfigured:"KVå­˜å‚¨æœªé…ç½®ï¼Œæ— æ³•ä½¿ç”¨é…ç½®ç®¡ç†åŠŸèƒ½ã€‚\\n\\nè¯·åœ¨Cloudflare Workersä¸­:\\n1. åˆ›å»ºKVå‘½åç©ºé—´\\n2. ç»‘å®šç¯å¢ƒå˜é‡ C\\n3. é‡æ–°éƒ¨ç½²ä»£ç ",kvNotEnabled:"KVå­˜å‚¨æœªé…ç½®",kvCheckFailed:"KVå­˜å‚¨æ£€æµ‹å¤±è´¥: å“åº”æ ¼å¼é”™è¯¯",kvCheckFailedStatus:"KVå­˜å‚¨æ£€æµ‹å¤±è´¥ - çŠ¶æ€ç : ",kvCheckFailedError:"KVå­˜å‚¨æ£€æµ‹å¤±è´¥ - é”™è¯¯: "},fa:{title:"Ù…Ø±Ú©Ø² Ø§Ø´ØªØ±Ø§Ú©",subtitle:"Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ú†Ù†Ø¯ Ú©Ù„Ø§ÛŒÙ†Øª â€¢ Ø§Ù†ØªØ®Ø§Ø¨ Ù‡ÙˆØ´Ù…Ù†Ø¯ â€¢ ØªÙˆÙ„ÛŒØ¯ ÛŒÚ© Ú©Ù„ÛŒÚ©ÛŒ",selectClient:"[ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù„Ø§ÛŒÙ†Øª ]",systemStatus:"[ ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ… ]",configManagement:"[ Ù…Ø¯ÛŒØ±ÛŒØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª ]",relatedLinks:"[ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ù…Ø±ØªØ¨Ø· ]",checking:"Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ...",workerRegion:"Ù…Ù†Ø·Ù‚Ù‡ Worker: ",detectionMethod:"Ø±ÙˆØ´ ØªØ´Ø®ÛŒØµ: ",proxyIPStatus:"ÙˆØ¶Ø¹ÛŒØª ProxyIP: ",currentIP:"IP ÙØ¹Ù„ÛŒ: ",regionMatch:"ØªØ·Ø¨ÛŒÙ‚ Ù…Ù†Ø·Ù‚Ù‡: ",selectionLogic:"Ù…Ù†Ø·Ù‚ Ø§Ù†ØªØ®Ø§Ø¨: ",kvStatusChecking:"Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª KV...",kvEnabled:"âœ… Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV ÙØ¹Ø§Ù„ Ø§Ø³ØªØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ù…Ø¯ÛŒØ±ÛŒØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯",kvDisabled:"âš ï¸ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV ÙØ¹Ø§Ù„ Ù†ÛŒØ³Øª ÛŒØ§ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª",specifyRegion:"ØªØ¹ÛŒÛŒÙ† Ù…Ù†Ø·Ù‚Ù‡ (wk):",autoDetect:"ØªØ´Ø®ÛŒØµ Ø®ÙˆØ¯Ú©Ø§Ø±",saveRegion:"Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ù†Ø·Ù‚Ù‡",protocolSelection:"Ø§Ù†ØªØ®Ø§Ø¨ Ù¾Ø±ÙˆØªÚ©Ù„:",enableVLESS:"ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø±ÙˆØªÚ©Ù„ VLESS",enableTrojan:"ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø±ÙˆØªÚ©Ù„ Trojan",enableXhttp:"ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø±ÙˆØªÚ©Ù„ xhttp",enableECH:"ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ ECH (Encrypted Client Hello)",enableECHHint:"Ù¾Ø³ Ø§Ø² ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒØŒ Ø¯Ø± Ù‡Ø± Ø¨Ø§Ø± ØªØ§Ø²Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ø´ØªØ±Ø§Ú©ØŒ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ ECH Ø¨Ù‡â€ŒØ±ÙˆØ² Ø¨Ù‡â€ŒØ·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø² DoH Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯Ù‡ Ùˆ Ø¨Ù‡ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯",customDNS:"Ø³Ø±ÙˆØ± DNS Ø³ÙØ§Ø±Ø´ÛŒ",customDNSPlaceholder:"Ù…Ø«Ø§Ù„: https://dns.aliyuncs.com/dns-query",customDNSHint:"Ø¢Ø¯Ø±Ø³ Ø³Ø±ÙˆØ± DNS Ø¨Ø±Ø§ÛŒ Ø¬Ø³ØªØ¬ÙˆÛŒ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ ECH (ÙØ±Ù…Øª DoH)",customECHDomain:"Ø¯Ø§Ù…Ù†Ù‡ ECH Ø³ÙØ§Ø±Ø´ÛŒ",customECHDomainPlaceholder:"Ù…Ø«Ø§Ù„: cloudflare-ech.com",customECHDomainHint:"Ø¯Ø§Ù…Ù†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø¯Ø± Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ ECHØŒ Ø®Ø§Ù„ÛŒ Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯ ØªØ§ Ø§Ø² Ù…Ù‚Ø¯Ø§Ø± Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´ÙˆØ¯",trojanPassword:"Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Trojan (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):",customPath:"Ù…Ø³ÛŒØ± Ø³ÙØ§Ø±Ø´ÛŒ (d):",customIP:"ProxyIP Ø³ÙØ§Ø±Ø´ÛŒ (p):",preferredIPs:"Ù„ÛŒØ³Øª IP ØªØ±Ø¬ÛŒØ­ÛŒ (yx):",preferredIPsURL:"URL Ù…Ù†Ø¨Ø¹ IP ØªØ±Ø¬ÛŒØ­ÛŒ (yxURL):",latencyTest:"ØªØ³Øª ØªØ§Ø®ÛŒØ±",latencyTestIP:"IP/Ø¯Ø§Ù…Ù†Ù‡ ØªØ³Øª:",latencyTestIPPlaceholder:"IP ÛŒØ§ Ø¯Ø§Ù…Ù†Ù‡ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ØŒ Ú†Ù†Ø¯ Ù…ÙˆØ±Ø¯ Ø¨Ø§ Ú©Ø§Ù…Ø§ Ø¬Ø¯Ø§ Ø´ÙˆÙ†Ø¯",latencyTestPort:"Ù¾ÙˆØ±Øª:",startTest:"Ø´Ø±ÙˆØ¹ ØªØ³Øª",stopTest:"ØªÙˆÙ‚Ù ØªØ³Øª",testResult:"Ù†ØªÛŒØ¬Ù‡ ØªØ³Øª:",addToYx:"Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ù„ÛŒØ³Øª ØªØ±Ø¬ÛŒØ­ÛŒ",addSelectedToYx:"Ø§ÙØ²ÙˆØ¯Ù† Ù…ÙˆØ§Ø±Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡",selectAll:"Ø§Ù†ØªØ®Ø§Ø¨ Ù‡Ù…Ù‡",deselectAll:"Ù„ØºÙˆ Ø§Ù†ØªØ®Ø§Ø¨",testingInProgress:"Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...",testComplete:"ØªØ³Øª Ú©Ø§Ù…Ù„ Ø´Ø¯",latencyMs:"ØªØ§Ø®ÛŒØ±",timeout:"Ø²Ù…Ø§Ù† ØªÙ…Ø§Ù… Ø´Ø¯",ipSource:"Ù…Ù†Ø¨Ø¹ IP:",manualInput:"ÙˆØ±ÙˆØ¯ÛŒ Ø¯Ø³ØªÛŒ",cfRandomIP:"IP ØªØµØ§Ø¯ÙÛŒ CF",urlFetch:"Ø¯Ø±ÛŒØ§ÙØª Ø§Ø² URL",randomCount:"ØªØ¹Ø¯Ø§Ø¯ ØªÙˆÙ„ÛŒØ¯:",fetchURL:"URL Ø¯Ø±ÛŒØ§ÙØª:",fetchURLPlaceholder:"Ø¢Ø¯Ø±Ø³ URL Ù„ÛŒØ³Øª IP Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯",generateIP:"ØªÙˆÙ„ÛŒØ¯ IP",fetchIP:"Ø¯Ø±ÛŒØ§ÙØª IP",socks5Config:"ØªÙ†Ø¸ÛŒÙ…Ø§Øª SOCKS5 (s):",customHomepage:"URL ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ (homepage):",customHomepagePlaceholder:"Ù…Ø«Ø§Ù„: https://example.com",customHomepageHint:"ØªÙ†Ø¸ÛŒÙ… URL Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø§Ø³ØªØªØ§Ø± ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ. Ù‡Ù†Ú¯Ø§Ù… Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ù…Ø³ÛŒØ± Ø§ØµÙ„ÛŒ / Ù…Ø­ØªÙˆØ§ÛŒ Ø§ÛŒÙ† URL Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø§Ú¯Ø± Ø®Ø§Ù„ÛŒ Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯ ØµÙØ­Ù‡ ØªØ±Ù…ÛŒÙ†Ø§Ù„ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.",saveConfig:"Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª",advancedControl:"Ú©Ù†ØªØ±Ù„ Ù¾ÛŒØ´Ø±ÙØªÙ‡",subscriptionConverter:"Ø¢Ø¯Ø±Ø³ ØªØ¨Ø¯ÛŒÙ„ Ø§Ø´ØªØ±Ø§Ú©:",builtinPreferred:"Ù†ÙˆØ¹ ØªØ±Ø¬ÛŒØ­ÛŒ Ø¯Ø§Ø®Ù„ÛŒ:",enablePreferredDomain:"ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ù…Ù†Ù‡ ØªØ±Ø¬ÛŒØ­ÛŒ",enablePreferredIP:"ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ IP ØªØ±Ø¬ÛŒØ­ÛŒ",enableGitHubPreferred:"ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ ØªØ±Ø¬ÛŒØ­ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ GitHub",allowAPIManagement:"Ø§Ø¬Ø§Ø²Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª API (ae):",regionMatching:"ØªØ·Ø¨ÛŒÙ‚ Ù…Ù†Ø·Ù‚Ù‡ (rm):",downgradeControl:"Ú©Ù†ØªØ±Ù„ Ú©Ø§Ù‡Ø´ Ø³Ø·Ø­ (qj):",tlsControl:"Ú©Ù†ØªØ±Ù„ TLS (dkby):",preferredControl:"Ú©Ù†ØªØ±Ù„ ØªØ±Ø¬ÛŒØ­ÛŒ (yxby):",saveAdvanced:"Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡",loading:"Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...",currentConfig:"ğŸ“ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ù…Ø³ÛŒØ± ÙØ¹Ù„ÛŒ",refreshConfig:"ØªØ§Ø²Ù‡â€ŒØ³Ø§Ø²ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª",resetConfig:"Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª",subscriptionCopied:"Ù„ÛŒÙ†Ú© Ø§Ø´ØªØ±Ø§Ú© Ú©Ù¾ÛŒ Ø´Ø¯",autoSubscriptionCopied:"Ù„ÛŒÙ†Ú© Ø§Ø´ØªØ±Ø§Ú© ØªØ´Ø®ÛŒØµ Ø®ÙˆØ¯Ú©Ø§Ø± Ú©Ù¾ÛŒ Ø´Ø¯ØŒ Ú©Ù„Ø§ÛŒÙ†Øª Ù‡Ù†Ú¯Ø§Ù… Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ User-Agent Ø¨Ù‡ Ø·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø¯Ù‡ Ùˆ Ù‚Ø§Ù„Ø¨ Ù…Ø±Ø¨ÙˆØ·Ù‡ Ø±Ø§ Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯",trojanPasswordPlaceholder:"Ø®Ø§Ù„ÛŒ Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯ ØªØ§ Ø§Ø² UUID Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´ÙˆØ¯",trojanPasswordHint:"Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Trojan Ø³ÙØ§Ø±Ø´ÛŒ Ø±Ø§ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ÛŒØ¯. Ø§Ú¯Ø± Ø®Ø§Ù„ÛŒ Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯ Ø§Ø² UUID Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ú©Ù„Ø§ÛŒÙ†Øª Ø¨Ù‡ Ø·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø±Ø§ Ø¨Ø§ SHA224 Ù‡Ø´ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.",protocolHint:"Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ú†Ù†Ø¯ÛŒÙ† Ù¾Ø±ÙˆØªÚ©Ù„ Ø±Ø§ Ù‡Ù…Ø²Ù…Ø§Ù† ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯. Ø§Ø´ØªØ±Ø§Ú© Ú¯Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø±ÙˆØªÚ©Ù„â€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ Ø±Ø§ ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.<br>â€¢ VLESS WS: Ù¾Ø±ÙˆØªÚ©Ù„ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± WebSocket<br>â€¢ Trojan: Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø¨Ø§ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± SHA224<br>â€¢ xhttp: Ù¾Ø±ÙˆØªÚ©Ù„ Ø§Ø³ØªØªØ§Ø± Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± HTTP POST (Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø§ØªØµØ§Ù„ Ø¯Ø§Ù…Ù†Ù‡ Ø³ÙØ§Ø±Ø´ÛŒ Ùˆ ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ gRPC Ø¯Ø§Ø±Ø¯)",saveProtocol:"Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾Ø±ÙˆØªÚ©Ù„",subscriptionConverterPlaceholder:"Ù¾ÛŒØ´â€ŒÙØ±Ø¶: https://url.v1.mk/sub",subscriptionConverterHint:"Ø¢Ø¯Ø±Ø³ API ØªØ¨Ø¯ÛŒÙ„ Ø§Ø´ØªØ±Ø§Ú© Ø³ÙØ§Ø±Ø´ÛŒØŒ Ø§Ú¯Ø± Ø®Ø§Ù„ÛŒ Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯ Ø§Ø² Ø¢Ø¯Ø±Ø³ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯",builtinPreferredHint:"Ú©Ù†ØªØ±Ù„ Ø§ÛŒÙ†Ú©Ù‡ Ú©Ø¯Ø§Ù… Ú¯Ø±Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ±Ø¬ÛŒØ­ÛŒ Ø¯Ø§Ø®Ù„ÛŒ Ø¯Ø± Ø§Ø´ØªØ±Ø§Ú© Ú¯Ù†Ø¬Ø§Ù†Ø¯Ù‡ Ø´ÙˆÙ†Ø¯. Ø¨Ù‡ Ø·ÙˆØ± Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ù‡Ù…Ù‡ ÙØ¹Ø§Ù„ Ù‡Ø³ØªÙ†Ø¯.",apiEnabledDefault:"Ù¾ÛŒØ´â€ŒÙØ±Ø¶ (Ø¨Ø³ØªÙ† API)",apiEnabledYes:"ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª API",apiEnabledHint:"âš ï¸ Ù‡Ø´Ø¯Ø§Ø± Ø§Ù…Ù†ÛŒØªÛŒ: ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø§ÛŒÙ† Ú¯Ø²ÛŒÙ†Ù‡ Ø§Ø¬Ø§Ø²Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ IP Ù‡Ø§ÛŒ ØªØ±Ø¬ÛŒØ­ÛŒ Ø§Ø² Ø·Ø±ÛŒÙ‚ API Ø¨Ù‡ Ø·ÙˆØ± Ù¾ÙˆÛŒØ§ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆÙ†Ø¯. ØªÙˆØµÛŒÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ ÙÙ‚Ø· Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯.",regionMatchingDefault:"Ù¾ÛŒØ´â€ŒÙØ±Ø¶ (ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ ØªØ·Ø¨ÛŒÙ‚ Ù…Ù†Ø·Ù‚Ù‡)",regionMatchingNo:"Ø¨Ø³ØªÙ† ØªØ·Ø¨ÛŒÙ‚ Ù…Ù†Ø·Ù‚Ù‡",regionMatchingHint:'ÙˆÙ‚ØªÛŒ "Ø¨Ø³ØªÙ†" ØªÙ†Ø¸ÛŒÙ… Ø´ÙˆØ¯ØŒ ØªØ·Ø¨ÛŒÙ‚ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù…Ù†Ø·Ù‚Ù‡ Ø§Ù†Ø¬Ø§Ù… Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯',downgradeControlDefault:"Ù¾ÛŒØ´â€ŒÙØ±Ø¶ (Ø¹Ø¯Ù… ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù‡Ø´ Ø³Ø·Ø­)",downgradeControlNo:"ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø­Ø§Ù„Øª Ú©Ø§Ù‡Ø´ Ø³Ø·Ø­",downgradeControlHint:'ÙˆÙ‚ØªÛŒ "ÙØ¹Ø§Ù„" ØªÙ†Ø¸ÛŒÙ… Ø´ÙˆØ¯: Ø§ØªØµØ§Ù„ Ù…Ø³ØªÙ‚ÛŒÙ… CF Ù†Ø§Ù…ÙˆÙÙ‚ â†’ Ø§ØªØµØ§Ù„ SOCKS5 â†’ Ø¢Ø¯Ø±Ø³ fallback',tlsControlDefault:"Ù¾ÛŒØ´â€ŒÙØ±Ø¶ (Ø­ÙØ¸ Ù‡Ù…Ù‡ Ú¯Ø±Ù‡â€ŒÙ‡Ø§)",tlsControlYes:"ÙÙ‚Ø· Ú¯Ø±Ù‡â€ŒÙ‡Ø§ÛŒ TLS",tlsControlHint:'ÙˆÙ‚ØªÛŒ "ÙÙ‚Ø· Ú¯Ø±Ù‡â€ŒÙ‡Ø§ÛŒ TLS" ØªÙ†Ø¸ÛŒÙ… Ø´ÙˆØ¯ØŒ ÙÙ‚Ø· Ú¯Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§ TLS ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ØŒ Ú¯Ø±Ù‡â€ŒÙ‡Ø§ÛŒ ØºÛŒØ± TLS (Ù…Ø§Ù†Ù†Ø¯ Ù¾ÙˆØ±Øª 80) ØªÙˆÙ„ÛŒØ¯ Ù†Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯',preferredControlDefault:"Ù¾ÛŒØ´â€ŒÙØ±Ø¶ (ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ ØªØ±Ø¬ÛŒØ­)",preferredControlYes:"Ø¨Ø³ØªÙ† ØªØ±Ø¬ÛŒØ­",preferredControlHint:'ÙˆÙ‚ØªÛŒ "Ø¨Ø³ØªÙ† ØªØ±Ø¬ÛŒØ­" ØªÙ†Ø¸ÛŒÙ… Ø´ÙˆØ¯ØŒ ÙÙ‚Ø· Ø§Ø² Ø¢Ø¯Ø±Ø³ Ø§ØµÙ„ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ú¯Ø±Ù‡â€ŒÙ‡Ø§ÛŒ IP Ùˆ Ø¯Ø§Ù…Ù†Ù‡ ØªØ±Ø¬ÛŒØ­ÛŒ ØªÙˆÙ„ÛŒØ¯ Ù†Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯',regionNames:{US:"ğŸ‡ºğŸ‡¸ Ø¢Ù…Ø±ÛŒÚ©Ø§",SG:"ğŸ‡¸ğŸ‡¬ Ø³Ù†Ú¯Ø§Ù¾ÙˆØ±",JP:"ğŸ‡¯ğŸ‡µ Ú˜Ø§Ù¾Ù†",KR:"ğŸ‡°ğŸ‡· Ú©Ø±Ù‡ Ø¬Ù†ÙˆØ¨ÛŒ",DE:"ğŸ‡©ğŸ‡ª Ø¢Ù„Ù…Ø§Ù†",SE:"ğŸ‡¸ğŸ‡ª Ø³ÙˆØ¦Ø¯",NL:"ğŸ‡³ğŸ‡± Ù‡Ù„Ù†Ø¯",FI:"ğŸ‡«ğŸ‡® ÙÙ†Ù„Ø§Ù†Ø¯",GB:"ğŸ‡¬ğŸ‡§ Ø¨Ø±ÛŒØªØ§Ù†ÛŒØ§"},terminal:"ØªØ±Ù…ÛŒÙ†Ø§Ù„ v2.9.2",githubProject:"Ù¾Ø±ÙˆÚ˜Ù‡ GitHub",autoDetectClient:"ØªØ´Ø®ÛŒØµ Ø®ÙˆØ¯Ú©Ø§Ø±",selectionLogicText:"Ù‡Ù…â€ŒÙ…Ù†Ø·Ù‚Ù‡ â†’ Ù…Ù†Ø·Ù‚Ù‡ Ù…Ø¬Ø§ÙˆØ± â†’ Ø³Ø§ÛŒØ± Ù…Ù†Ø§Ø·Ù‚",customIPDisabledHint:"Ù‡Ù†Ú¯Ø§Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ProxyIP Ø³ÙØ§Ø±Ø´ÛŒØŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ù†Ø·Ù‚Ù‡ ØºÛŒØ±ÙØ¹Ø§Ù„ Ø§Ø³Øª",customIPMode:"Ø­Ø§Ù„Øª ProxyIP Ø³ÙØ§Ø±Ø´ÛŒ (Ù…ØªØºÛŒØ± p ÙØ¹Ø§Ù„ Ø§Ø³Øª)",customIPModeDesc:"Ø­Ø§Ù„Øª IP Ø³ÙØ§Ø±Ø´ÛŒ (ØªØ·Ø¨ÛŒÙ‚ Ù…Ù†Ø·Ù‚Ù‡ ØºÛŒØ±ÙØ¹Ø§Ù„ Ø§Ø³Øª)",usingCustomProxyIP:"Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ProxyIP Ø³ÙØ§Ø±Ø´ÛŒ: ",customIPConfig:" (Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ù…ØªØºÛŒØ± p)",customIPModeDisabled:"Ø­Ø§Ù„Øª IP Ø³ÙØ§Ø±Ø´ÛŒØŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ù†Ø·Ù‚Ù‡ ØºÛŒØ±ÙØ¹Ø§Ù„ Ø§Ø³Øª",manualRegion:"ØªØ¹ÛŒÛŒÙ† Ù…Ù†Ø·Ù‚Ù‡ Ø¯Ø³ØªÛŒ",manualRegionDesc:" (ØªØ¹ÛŒÛŒÙ† Ø¯Ø³ØªÛŒ)",proxyIPAvailable:"10/10 Ø¯Ø± Ø¯Ø³ØªØ±Ø³ (Ø¯Ø§Ù…Ù†Ù‡ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ ProxyIP Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ø§Ø³Øª)",smartSelection:"Ø§Ù†ØªØ®Ø§Ø¨ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù†Ø²Ø¯ÛŒÚ© Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù… Ø§Ø³Øª",sameRegionIP:"IP Ù‡Ù…â€ŒÙ…Ù†Ø·Ù‚Ù‡ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ø§Ø³Øª (1)",cloudflareDetection:"ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø®Ù„ÛŒ Cloudflare",
detectionFailed:"ØªØ´Ø®ÛŒØµ Ù†Ø§Ù…ÙˆÙÙ‚",apiTestResult:"Ù†ØªÛŒØ¬Ù‡ ØªØ´Ø®ÛŒØµ API: ",apiTestTime:"Ø²Ù…Ø§Ù† ØªØ´Ø®ÛŒØµ: ",apiTestFailed:"ØªØ´Ø®ÛŒØµ API Ù†Ø§Ù…ÙˆÙÙ‚: ",unknownError:"Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡",apiTestError:"ØªØ³Øª API Ù†Ø§Ù…ÙˆÙÙ‚: ",kvNotConfigured:"Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³ØªØŒ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù…Ø¯ÛŒØ±ÛŒØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.\\n\\nÙ„Ø·ÙØ§ Ø¯Ø± Cloudflare Workers:\\n1. ÙØ¶Ø§ÛŒ Ù†Ø§Ù… KV Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†ÛŒØ¯\\n2. Ù…ØªØºÛŒØ± Ù…Ø­ÛŒØ·ÛŒ C Ø±Ø§ Ù¾ÛŒÙˆÙ†Ø¯ Ø¯Ù‡ÛŒØ¯\\n3. Ú©Ø¯ Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù…Ø³ØªÙ‚Ø± Ú©Ù†ÛŒØ¯",kvNotEnabled:"Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª",kvCheckFailed:"Ø¨Ø±Ø±Ø³ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV Ù†Ø§Ù…ÙˆÙÙ‚: Ø®Ø·Ø§ÛŒ ÙØ±Ù…Øª Ù¾Ø§Ø³Ø®",kvCheckFailedStatus:"Ø¨Ø±Ø±Ø³ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV Ù†Ø§Ù…ÙˆÙÙ‚ - Ú©Ø¯ ÙˆØ¶Ø¹ÛŒØª: ",kvCheckFailedError:"Ø¨Ø±Ø±Ø³ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV Ù†Ø§Ù…ÙˆÙÙ‚ - Ø®Ø·Ø§: "}
},i=s[a?"fa":"zh"],l=`<!DOCTYPE html>\n        <html lang="${r}" dir="${a?"rtl":"ltr"}">\n    <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <title>${i.title}</title>\n        <style>\n            * { margin: 0; padding: 0; box-sizing: border-box; }\n            body {\n                font-family: "Courier New", monospace;\n                background: #000; color: #00ff00; min-height: 100vh;\n                overflow-x: hidden; position: relative;\n            }\n            .matrix-bg {\n                position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n                background: #000;\n                z-index: -1;\n            }\n            @keyframes bg-pulse {\n                0%, 100% { background: linear-gradient(45deg, #000 0%, #001100 50%, #000 100%); }\n                50% { background: linear-gradient(45deg, #000 0%, #002200 50%, #000 100%); }\n            }\n            .matrix-rain {\n                position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n                background: transparent;\n                z-index: -1;\n                display: none;\n            }\n            @keyframes matrix-fall {\n                0% { transform: translateY(-100%); }\n                100% { transform: translateY(100vh); }\n            }\n            .matrix-code-rain {\n                position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n                pointer-events: none; z-index: -1;\n                overflow: hidden;\n                display: none;\n            }\n            .matrix-column {\n                position: absolute; top: -100%; left: 0;\n                color: #00ff00; font-family: "Courier New", monospace;\n                font-size: 14px; line-height: 1.2;\n                text-shadow: 0 0 5px #00ff00;\n            }\n            @keyframes matrix-drop {\n                0% { top: -100%; opacity: 1; }\n                10% { opacity: 1; }\n                90% { opacity: 0.3; }\n                100% { top: 100vh; opacity: 0; }\n            }\n            .matrix-column:nth-child(odd) {\n                animation-duration: 12s;\n                animation-delay: -2s;\n            }\n            .matrix-column:nth-child(even) {\n                animation-duration: 18s;\n                animation-delay: -5s;\n            }\n            .matrix-column:nth-child(3n) {\n                animation-duration: 20s;\n                animation-delay: -8s;\n            }\n            .container { max-width: 900px; margin: 0 auto; padding: 20px; position: relative; z-index: 1; }\n            .header { text-align: center; margin-bottom: 40px; }\n            .title {\n                font-size: 3.5rem; font-weight: bold;\n                text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00, 0 0 30px #00ff00, 0 0 40px #00ff00;\n                margin-bottom: 10px;\n                position: relative;\n                color: #00ff00;\n            }\n            @keyframes matrix-glow {\n                from { text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00, 0 0 30px #00ff00, 0 0 40px #00ff00; }\n                to { text-shadow: 0 0 20px #00ff00, 0 0 30px #00ff00, 0 0 40px #00ff00, 0 0 50px #00ff00; }\n            }\n            @keyframes matrix-pulse {\n                0%, 100% { background-position: 0% 50%; }\n                50% { background-position: 100% 50%; }\n            }\n            .subtitle { color: #00aa00; margin-bottom: 30px; font-size: 1.2rem; }\n            .card {\n                background: rgba(0, 20, 0, 0.9);\n                border: 2px solid #00ff00;\n                border-radius: 0; padding: 30px; margin-bottom: 20px;\n                box-shadow: 0 0 30px rgba(0, 255, 0, 0.5), inset 0 0 20px rgba(0, 255, 0, 0.1);\n                position: relative;\n                backdrop-filter: blur(10px);\n                box-sizing: border-box;\n                width: 100%;\n                max-width: 100%;\n            }\n            @keyframes card-glow {\n                0%, 100% { box-shadow: 0 0 30px rgba(0, 255, 0, 0.5), inset 0 0 20px rgba(0, 255, 0, 0.1); }\n                50% { box-shadow: 0 0 40px rgba(0, 255, 0, 0.7), inset 0 0 30px rgba(0, 255, 0, 0.2); }\n            }\n            .card::before {\n                content: ""; position: absolute; top: 0; left: 0;\n                width: 100%; height: 100%;\n                background: none;\n                opacity: 0; pointer-events: none;\n            }\n            @keyframes scan-line {\n                0% { transform: translateX(-100%); }\n                100% { transform: translateX(100%); }\n            }\n            .card-title {\n                font-size: 1.8rem; margin-bottom: 20px;\n                color: #00ff00; text-shadow: 0 0 5px #00ff00;\n            }\n            .client-grid {\n                display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));\n                gap: 15px; margin: 20px 0;\n            }\n            .client-btn {\n                background: rgba(0, 20, 0, 0.8);\n                border: 2px solid #00ff00;\n                padding: 15px 20px; color: #00ff00;\n                font-family: "Courier New", monospace; font-weight: bold;\n                cursor: pointer; transition: all 0.4s ease;\n                text-align: center; position: relative;\n                overflow: hidden;\n                text-shadow: 0 0 5px #00ff00;\n                box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);\n            }\n            .client-btn::before {\n                content: ""; position: absolute; top: 0; left: -100%;\n                width: 100%; height: 100%;\n                background: linear-gradient(90deg, transparent, rgba(0,255,0,0.4), transparent);\n                transition: left 0.6s ease;\n            }\n            .client-btn::after {\n                content: ""; position: absolute; top: 0; left: 0;\n                width: 100%; height: 100%;\n                background: linear-gradient(45deg, transparent 30%, rgba(0,255,0,0.1) 50%, transparent 70%);\n                opacity: 0;\n                transition: opacity 0.3s ease;\n            }\n            .client-btn:hover::before { left: 100%; }\n            .client-btn:hover::after { opacity: 1; }\n            .client-btn:hover {\n                background: rgba(0, 255, 0, 0.3);\n                box-shadow: 0 0 25px #00ff00, 0 0 35px rgba(0, 255, 0, 0.5);\n                transform: translateY(-3px) scale(1.05);\n                text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00;\n            }\n            .generate-btn {\n                background: rgba(0, 255, 0, 0.15);\n                border: 2px solid #00ff00; padding: 15px 30px;\n                color: #00ff00; font-family: "Courier New", monospace;\n                font-weight: bold; cursor: pointer;\n                transition: all 0.4s ease; margin-right: 15px;\n                text-shadow: 0 0 8px #00ff00;\n                box-shadow: 0 0 15px rgba(0, 255, 0, 0.4);\n                position: relative;\n                overflow: hidden;\n            }\n            .generate-btn::before {\n                content: ""; position: absolute; top: 0; left: -100%;\n                width: 100%; height: 100%;\n                background: linear-gradient(90deg, transparent, rgba(0,255,0,0.5), transparent);\n                transition: left 0.8s ease;\n            }\n            .generate-btn:hover::before { left: 100%; }\n            .generate-btn:hover {\n                background: rgba(0, 255, 0, 0.4);\n                box-shadow: 0 0 30px #00ff00, 0 0 40px rgba(0, 255, 0, 0.6);\n                transform: translateY(-4px) scale(1.08);\n                text-shadow: 0 0 15px #00ff00, 0 0 25px #00ff00;\n            }\n            .atob('c3Vic2NyaXB0aW9u')-url {\n                background: rgba(0, 0, 0, 0.9);\n                border: 2px solid #00ff00; padding: 15px;\n                word-break: break-all; font-family: "Courier New", monospace;\n                color: #00ff00; margin-top: 20px; display: none;\n                box-shadow: inset 0 0 15px rgba(0, 255, 0, 0.4), 0 0 20px rgba(0, 255, 0, 0.3);\n                border-radius: 5px;\n                position: relative;\n                overflow-wrap: break-word;\n                overflow-x: auto;\n                max-width: 100%;\n                box-sizing: border-box;\n            }\n            @keyframes url-glow {\n                from { box-shadow: inset 0 0 15px rgba(0, 255, 0, 0.4), 0 0 20px rgba(0, 255, 0, 0.3); }\n                to { box-shadow: inset 0 0 20px rgba(0, 255, 0, 0.6), 0 0 30px rgba(0, 255, 0, 0.5); }\n            }\n            .atob('c3Vic2NyaXB0aW9u')-url::before {\n                content: ""; position: absolute; top: 0; left: -100%;\n                width: 100%; height: 100%;\n                background: none;\n            }\n            @keyframes url-scan {\n                0% { left: -100%; }\n                100% { left: 100%; }\n            }\n            .matrix-text {\n                position: fixed; top: 20px; right: 20px;\n                color: #00ff00; font-family: "Courier New", monospace;\n                font-size: 0.8rem; opacity: 0.6;\n            }\n            @keyframes matrix-flicker {\n                0%, 100% { opacity: 0.6; }\n                50% { opacity: 1; }\n            }\n        </style>\n    </head>\n    <body>\n        <div class="matrix-bg"></div>\n        <div class="matrix-rain"></div>\n        <div class="matrix-code-rain" id="matrixCodeRain"></div>\n            <div class="matrix-text">${i.terminal}</div>\n            <div style="position: fixed; top: 20px; left: 20px; z-index: 1000;">\n                <select id="languageSelector" style="background: rgba(0, 20, 0, 0.9); border: 2px solid #00ff00; color: #00ff00; padding: 8px 12px; font-family: 'Courier New', monospace; font-size: 14px; cursor: pointer; text-shadow: 0 0 5px #00ff00; box-shadow: 0 0 15px rgba(0, 255, 0, 0.4);" onchange="changeLanguage(this.value)">\n                    <option value="zh" ${a?"":"selected"}>ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>\n                    <option value="fa" ${a?"selected":""}>ğŸ‡®ğŸ‡· ÙØ§Ø±Ø³ÛŒ</option>\n                </select>\n            </div>\n        <div class="container">\n            <div class="header">\n                    <h1 class="title">${i.title}</h1>\n                    <p class="subtitle">${i.subtitle}</p>\n            </div>\n            <div class="card">\n                    <h2 class="card-title">${i.selectClient}</h2>\n                <div class="client-grid">\n                    <button class="client-btn" onclick="generateClientLink(atob('Y2xhc2g='), 'CLASH')">CLASH</button>\n                    <button class="client-btn" onclick="generateClientLink(atob('Y2xhc2g='), 'STASH')">STASH</button>\n                    <button class="client-btn" onclick="generateClientLink(atob('c3VyZ2U='), 'SURGE')">SURGE</button>\n                    <button class="client-btn" onclick="generateClientLink(atob('c2luZ2JveA=='), 'SING-BOX')">SING-BOX</button>\n                    <button class="client-btn" onclick="generateClientLink(atob('bG9vbg=='), 'LOON')">LOON</button>\n                    <button class="client-btn" onclick="generateClientLink(atob('cXVhbng='), 'QUANTUMULT X')">QUANTUMULT X</button>\n                    <button class="client-btn" onclick="generateClientLink(atob('djJyYXk='), 'V2RAY')">V2RAY</button>\n                    <button class="client-btn" onclick="generateClientLink(atob('djJyYXk='), 'V2RAYNG')">V2RAYNG</button>\n                    <button class="client-btn" onclick="generateClientLink(atob('djJyYXk='), 'NEKORAY')">NEKORAY</button>\n                    <button class="client-btn" onclick="generateClientLink(atob('djJyYXk='), 'Shadowrocket')">Shadowrocket</button>\n                </div>\n                <div class=atob('c3Vic2NyaXB0aW9uLXVybA==') id="clientSubscriptionUrl"></div>\n            </div>\n            <div class="card">\n                    <h2 class="card-title">${i.systemStatus}</h2>\n                <div id="systemStatus" style="margin: 20px 0; padding: 15px; background: rgba(0, 20, 0, 0.8); border: 2px solid #00ff00; box-shadow: 0 0 20px rgba(0, 255, 0, 0.3), inset 0 0 15px rgba(0, 255, 0, 0.1); position: relative; overflow: hidden;">\n                        <div style="color: #00ff00; margin-bottom: 15px; font-weight: bold; text-shadow: 0 0 5px #00ff00;">[ ${i.checking} ]</div>\n                        <div id="regionStatus" style="margin: 8px 0; color: #00ff00; font-family: 'Courier New', monospace; text-shadow: 0 0 3px #00ff00;">${i.workerRegion}${i.checking}</div>\n                        <div id="geoInfo" style="margin: 8px 0; color: #00aa00; font-family: 'Courier New', monospace; font-size: 0.9rem; text-shadow: 0 0 3px #00aa00;">${i.detectionMethod}${i.checking}</div>\n                        <div id="backupStatus" style="margin: 8px 0; color: #00ff00; font-family: 'Courier New', monospace; text-shadow: 0 0 3px #00ff00;">${i.proxyIPStatus}${i.checking}</div>\n                        <div id="currentIP" style="margin: 8px 0; color: #00ff00; font-family: 'Courier New', monospace; text-shadow: 0 0 3px #00ff00;">${i.currentIP}${i.checking}</div>\n                        <div id="echStatus" style="margin: 8px 0; color: #00ff00; font-family: 'Courier New', monospace; text-shadow: 0 0 3px #00ff00; font-size: 0.9rem;">ECHçŠ¶æ€: ${i.checking}</div>\n                        <div id="regionMatch" style="margin: 8px 0; color: #00ff00; font-family: 'Courier New', monospace; text-shadow: 0 0 3px #00ff00;">${i.regionMatch}${i.checking}</div>\n                        <div id="selectionLogic" style="margin: 8px 0; color: #00aa00; font-family: 'Courier New', monospace; font-size: 0.9rem; text-shadow: 0 0 3px #00aa00;">${i.selectionLogic}${i.selectionLogicText}</div>\n                </div>\n            </div>\n            <div class="card" id="configCard" style="display: none;">\n                    <h2 class="card-title">${i.configManagement}</h2>\n                <div id="kvStatus" style="margin-bottom: 20px; padding: 10px; background: rgba(0, 20, 0, 0.8); border: 1px solid #00ff00; color: #00ff00;">\n                        ${i.kvStatusChecking}\n                </div>\n                <div id="configContent" style="display: none;">\n                    <form id="regionForm" style="margin-bottom: 20px;">\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.specifyRegion}</label>\n                            <select id="wkRegion" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                    <option value="">${i.autoDetect}</option>\n                                    <option value="US">${i.regionNames.US}</option>\n                                    <option value="SG">${i.regionNames.SG}</option>\n                                    <option value="JP">${i.regionNames.JP}</option>\n                                    <option value="KR">${i.regionNames.KR}</option>\n                                    <option value="DE">${i.regionNames.DE}</option>\n                                    <option value="SE">${i.regionNames.SE}</option>\n                                    <option value="NL">${i.regionNames.NL}</option>\n                                    <option value="FI">${i.regionNames.FI}</option>\n                                    <option value="GB">${i.regionNames.GB}</option>\n                            </select>\n                                <small id="wkRegionHint" style="color: #00aa00; font-size: 0.85rem; display: none;">âš ï¸ ${i.customIPDisabledHint}</small>\n                        </div>\n                            <button type="submit" style="background: rgba(0, 255, 0, 0.15); border: 2px solid #00ff00; padding: 12px 24px; color: #00ff00; font-family: 'Courier New', monospace; font-weight: bold; cursor: pointer; margin-right: 10px; text-shadow: 0 0 8px #00ff00; transition: all 0.4s ease;">${i.saveRegion}</button>\n                    </form>\n                    <form id="otherConfigForm" style="margin-bottom: 20px;">\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.protocolSelection}</label>\n                            <div style="padding: 15px; background: rgba(0, 20, 0, 0.6); border: 1px solid #00ff00; border-radius: 5px;">\n                                <div style="margin-bottom: 10px;">\n                                    <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00;">\n                                        <input type="checkbox" id="ev" checked style="margin-right: 8px; width: 18px; height: 18px; cursor: pointer;">\n                                            <span style="font-size: 1.1rem;">${i.enableVLESS}</span>\n                                    </label>\n                                </div>\n                                <div style="margin-bottom: 10px;">\n                                    <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00;">\n                                        <input type="checkbox" id="et" style="margin-right: 8px; width: 18px; height: 18px; cursor: pointer;">\n                                            <span style="font-size: 1.1rem;">${i.enableTrojan}</span>\n                                    </label>\n                                </div>\n                                <div style="margin-bottom: 10px;">\n                                    <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00;">\n                                        <input type="checkbox" id="ex" style="margin-right: 8px; width: 18px; height: 18px; cursor: pointer;">\n                                            <span style="font-size: 1.1rem;">${i.enableXhttp}</span>\n                                    </label>\n                                </div>\n                                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(0, 255, 0, 0.3);">\n                                    <div style="margin-bottom: 10px;">\n                                        <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00;">\n                                            <input type="checkbox"  id="ech" checked style="margin-right: 8px; width: 18px; height: 18px; cursor: pointer;">\n                                                <span style="font-size: 1.1rem;">${i.enableECH}</span>\n                                        </label>\n                                        <small style="color: #00aa00; font-size: 0.8rem; display: block; margin-top: 5px; margin-left: 26px;">${i.enableECHHint}</small>\n                                    </div>\n                                    <div style="margin-top: 15px; margin-bottom: 10px;">\n                                        <label style="display: block; margin-bottom: 8px; color: #00ff00; font-size: 0.95rem;">${i.customDNS}</label>\n                                        <input type="text" id="customDNS" placeholder="${i.customDNSPlaceholder}" style="width: 100%; padding: 10px; background: rgba(0, 0, 0, 0.8); border: 1px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 13px;">\n                                        <small style="color: #00aa00; font-size: 0.8rem; display: block; margin-top: 5px;">${i.customDNSHint}</small>\n                                    </div>\n                                    <div style="margin-bottom: 10px;">\n                                        <label style="display: block; margin-bottom: 8px; color: #00ff00; font-size: 0.95rem;">${i.customECHDomain}</label>\n                                        <input type="text" id="customECHDomain" placeholder="${i.customECHDomainPlaceholder}" style="width: 100%; padding: 10px; background: rgba(0, 0, 0, 0.8); border: 1px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 13px;">\n                                        <small style="color: #00aa00; font-size: 0.8rem; display: block; margin-top: 5px;">${i.customECHDomainHint}</small>\n                                    </div>\n                                </div>\n                                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(0, 255, 0, 0.3);">\n                                        <label style="display: block; margin-bottom: 8px; color: #00ff00; font-size: 0.95rem;">${i.trojanPassword}</label>\n                                        <input type="text" id="tp" placeholder="${i.trojanPasswordPlaceholder}" style="width: 100%; padding: 10px; background: rgba(0, 0, 0, 0.8); border: 1px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 13px;">\n                                        <small style="color: #00aa00; font-size: 0.8rem; display: block; margin-top: 5px;">${i.trojanPasswordHint}</small>\n                                </div>\n                                    <small style="color: #00aa00; font-size: 0.85rem; display: block; margin-top: 10px;">${i.protocolHint}</small>\n                                    <button type="button" id="saveProtocolBtn" style="margin-top: 15px; background: rgba(0, 255, 0, 0.15); border: 2px solid #00ff00; padding: 10px 20px; color: #00ff00; font-family: 'Courier New', monospace; font-weight: bold; cursor: pointer; text-shadow: 0 0 8px #00ff00; transition: all 0.4s ease; width: 100%;">${i.saveProtocol}</button>\n                            </div>\n                        </div>\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.customHomepage}</label>\n                                <input type="text" id="customHomepage" placeholder="${i.customHomepagePlaceholder}" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                <small style="color: #00aa00; font-size: 0.85rem;">${i.customHomepageHint}</small>\n                        </div>\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.customPath}</label>\n                                <input type="text" id="customPath" placeholder="${a?"Ù…Ø«Ø§Ù„: /mypath ÛŒØ§ Ø®Ø§Ù„ÛŒ Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯ ØªØ§ Ø§Ø² UUID Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´ÙˆØ¯":"ä¾‹å¦‚: /mypath æˆ–ç•™ç©ºä½¿ç”¨ UUID"}" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                <small style="color: #00aa00; font-size: 0.85rem;">${a?"Ù…Ø³ÛŒØ± Ø§Ø´ØªØ±Ø§Ú© Ø³ÙØ§Ø±Ø´ÛŒ. Ø§Ú¯Ø± Ø®Ø§Ù„ÛŒ Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯ Ø§Ø² UUID Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ù…Ø³ÛŒØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.":"è‡ªå®šä¹‰è®¢é˜…è·¯å¾„ã€‚ç•™ç©ºåˆ™ä½¿ç”¨ UUID ä½œä¸ºè·¯å¾„ã€‚"}</small>\n                        </div>\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.customIP}</label>\n                                <input type="text" id="customIP" placeholder="${a?"Ù…Ø«Ø§Ù„: 1.2.3.4:443":"ä¾‹å¦‚: 1.2.3.4:443"}" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                <small style="color: #00aa00; font-size: 0.85rem;">${a?"Ø¢Ø¯Ø±Ø³ Ùˆ Ù¾ÙˆØ±Øª ProxyIP Ø³ÙØ§Ø±Ø´ÛŒ":"è‡ªå®šä¹‰ProxyIPåœ°å€å’Œç«¯å£"}</small>\n                        </div>\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.preferredIPs}</label>\n                                <input type="text" id="yx" placeholder="${a?"Ù…Ø«Ø§Ù„: 1.2.3.4:443#Ú¯Ø±Ù‡ Ù‡Ù†Ú¯â€ŒÚ©Ù†Ú¯,5.6.7.8:80#Ú¯Ø±Ù‡ Ø¢Ù…Ø±ÛŒÚ©Ø§,example.com:8443#Ú¯Ø±Ù‡ Ø³Ù†Ú¯Ø§Ù¾ÙˆØ±":"ä¾‹å¦‚: 1.2.3.4:443#æ—¥æœ¬èŠ‚ç‚¹,5.6.7.8:80#ç¾å›½èŠ‚ç‚¹,example.com:8443#æ–°åŠ å¡èŠ‚ç‚¹"}" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                <small style="color: #00aa00; font-size: 0.85rem;">${a?'ÙØ±Ù…Øª: IP:Ù¾ÙˆØ±Øª#Ù†Ø§Ù… Ú¯Ø±Ù‡ ÛŒØ§ IP:Ù¾ÙˆØ±Øª (Ø¨Ø¯ÙˆÙ† # Ø§Ø² Ù†Ø§Ù… Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯). Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ú†Ù†Ø¯ÛŒÙ† Ù…ÙˆØ±Ø¯ØŒ Ø¨Ø§ Ú©Ø§Ù…Ø§ Ø¬Ø¯Ø§ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯. <span style="color: #ffaa00;">IP Ù‡Ø§ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡ Ø§Ø² Ø·Ø±ÛŒÙ‚ API Ø¨Ù‡ Ø·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.</span>':'æ ¼å¼: IP:ç«¯å£#èŠ‚ç‚¹åç§° æˆ– IP:ç«¯å£ (æ— #åˆ™ä½¿ç”¨é»˜è®¤åç§°)ã€‚æ”¯æŒå¤šä¸ªï¼Œç”¨é€—å·åˆ†éš”ã€‚<span style="color: #ffaa00;">APIæ·»åŠ çš„IPä¼šè‡ªåŠ¨æ˜¾ç¤ºåœ¨è¿™é‡Œã€‚</span>'}</small>\n                        </div>\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.preferredIPsURL}</label>\n                                <input type="text" id="yxURL" placeholder="${a?"Ù¾ÛŒØ´â€ŒÙØ±Ø¶: https://raw.githubusercontent.com/qwer-search/bestip/refs/heads/main/kejilandbestip.txt":"é»˜è®¤: https://raw.githubusercontent.com/qwer-search/bestip/refs/heads/main/kejilandbestip.txt"}" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                <small style="color: #00aa00; font-size: 0.85rem;">${a?"URL Ù…Ù†Ø¨Ø¹ Ù„ÛŒØ³Øª IP ØªØ±Ø¬ÛŒØ­ÛŒ Ø³ÙØ§Ø±Ø´ÛŒØŒ Ø§Ú¯Ø± Ø®Ø§Ù„ÛŒ Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯ Ø§Ø² Ø¢Ø¯Ø±Ø³ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯":"è‡ªå®šä¹‰ä¼˜é€‰IPåˆ—è¡¨æ¥æºURLï¼Œç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤åœ°å€"}</small>\n                        </div>\n                        \n                        <div style="margin-bottom: 20px; padding: 15px; background: rgba(0, 40, 0, 0.6); border: 2px solid #00aa00; border-radius: 8px;">\n                            <h4 style="color: #00ff00; margin: 0 0 15px 0; font-size: 1.1rem; text-shadow: 0 0 5px #00ff00;">âš¡ ${i.latencyTest}</h4>\n                            <div style="display: flex; gap: 10px; margin-bottom: 12px; flex-wrap: wrap; align-items: center;">\n                                <div style="min-width: 120px;">\n                                    <label style="display: block; margin-bottom: 5px; color: #00ff00; font-size: 0.9rem;">${i.ipSource}</label>\n                                    <select id="ipSourceSelect" style="width: 100%; padding: 10px; background: rgba(0, 0, 0, 0.8); border: 1px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 13px; cursor: pointer;">\n                                        <option value="manual">${i.manualInput}</option>\n                                        <option value="cfRandom">${i.cfRandomIP}</option>\n                                        <option value="urlFetch">${i.urlFetch}</option>\n                                    </select>\n                                </div>\n                                <div style="width: 100px;">\n                                    <label style="display: block; margin-bottom: 5px; color: #00ff00; font-size: 0.9rem;">${i.latencyTestPort}</label>\n                                    <input type="number" id="latencyTestPort" value="443" min="1" max="65535" style="width: 100%; padding: 10px; background: rgba(0, 0, 0, 0.8); border: 1px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 13px;">\n                                </div>\n                                <div id="randomCountDiv" style="width: 100px; display: none;">\n                                    <label style="display: block; margin-bottom: 5px; color: #00ff00; font-size: 0.9rem;">${i.randomCount}</label>\n                                    <input type="number" id="randomIPCount" value="20" min="1" max="100" style="width: 100%; padding: 10px; background: rgba(0, 0, 0, 0.8); border: 1px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 13px;">\n                                </div>\n                                <div style="width: 80px;">\n                                    <label style="display: block; margin-bottom: 5px; color: #00ff00; font-size: 0.9rem;">${a?"Ø±Ø´ØªÙ‡â€ŒÙ‡Ø§":"çº¿ç¨‹"}</label>\n                                    <input type="number" id="testThreads" value="5" min="1" max="50" style="width: 100%; padding: 10px; background: rgba(0, 0, 0, 0.8); border: 1px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 13px;">\n                                </div>\n                            </div>\n                            <div id="manualInputDiv" style="margin-bottom: 10px;">\n                                <label style="display: block; margin-bottom: 5px; color: #00ff00; font-size: 0.9rem;">${i.latencyTestIP}</label>\n                                <input type="text" id="latencyTestInput" placeholder="${i.latencyTestIPPlaceholder}" style="width: 100%; padding: 10px; background: rgba(0, 0, 0, 0.8); border: 1px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 13px;">\n                            </div>\n                            <div id="urlFetchDiv" style="margin-bottom: 10px; display: none;">\n                                <label style="display: block; margin-bottom: 5px; color: #00ff00; font-size: 0.9rem;">${i.fetchURL}</label>\n                                <div style="display: flex; gap: 8px;">\n                                    <input type="text" id="fetchURLInput" placeholder="${i.fetchURLPlaceholder}" style="flex: 1; padding: 10px; background: rgba(0, 0, 0, 0.8); border: 1px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 13px;">\n                                    <button type="button" id="fetchIPBtn" style="background: rgba(0, 200, 255, 0.2); border: 1px solid #00aaff; padding: 8px 16px; color: #00aaff; font-family: 'Courier New', monospace; cursor: pointer; white-space: nowrap;">â¬‡ ${i.fetchIP}</button>\n                                </div>\n                            </div>\n                            <div id="cfRandomDiv" style="margin-bottom: 10px; display: none;">\n                                <button type="button" id="generateCFIPBtn" style="background: rgba(0, 255, 0, 0.15); border: 1px solid #00ff00; padding: 10px 20px; color: #00ff00; font-family: 'Courier New', monospace; cursor: pointer; width: 100%; transition: all 0.3s;">ğŸ² ${i.generateIP}</button>\n                            </div>\n                            <div style="display: flex; gap: 10px; margin-bottom: 15px;">\n                                <button type="button" id="startLatencyTest" style="background: rgba(0, 255, 0, 0.2); border: 1px solid #00ff00; padding: 8px 16px; color: #00ff00; font-family: 'Courier New', monospace; cursor: pointer; transition: all 0.3s;">â–¶ ${i.startTest}</button>\n                                <button type="button" id="stopLatencyTest" style="background: rgba(255, 0, 0, 0.2); border: 1px solid #ff4444; padding: 8px 16px; color: #ff4444; font-family: 'Courier New', monospace; cursor: pointer; display: none; transition: all 0.3s;">â¹ ${i.stopTest}</button>\n                            </div>\n                            <div id="latencyTestStatus" style="color: #00aa00; font-size: 0.9rem; margin-bottom: 10px; display: none;"></div>\n                            <div id="latencyTestResults" style="max-height: 250px; overflow-y: auto; display: none;">\n                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">\n                                    <span style="color: #00ff00; font-weight: bold;">${i.testResult}</span>\n                                    <div style="display: flex; gap: 8px;">\n                                        <button type="button" id="selectAllResults" style="background: transparent; border: 1px solid #00aa00; padding: 4px 10px; color: #00aa00; font-size: 0.8rem; cursor: pointer;">${i.selectAll}</button>\n                                        <button type="button" id="deselectAllResults" style="background: transparent; border: 1px solid #00aa00; padding: 4px 10px; color: #00aa00; font-size: 0.8rem; cursor: pointer;">${i.deselectAll}</button>\n                                    </div>\n                                </div>\n                                <div id="cityFilterContainer" style="margin-bottom: 10px; padding: 10px; background: rgba(0, 20, 0, 0.6); border: 1px solid #00aa00; border-radius: 4px; display: none;">\n                                    <div style="margin-bottom: 8px;">\n                                        <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00; font-size: 0.9rem;">\n                                            <input type="radio" name="cityFilterMode" value="all" checked style="margin-right: 6px; width: 16px; height: 16px; cursor: pointer;">\n                                            <span>å…¨éƒ¨åŸå¸‚</span>\n                                        </label>\n                                        <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00; font-size: 0.9rem; margin-left: 15px;">\n                                            <input type="radio" name="cityFilterMode" value="fastest10" style="margin-right: 6px; width: 16px; height: 16px; cursor: pointer;">\n                                            <span>åªé€‰æ‹©æœ€å¿«çš„10ä¸ª</span>\n                                        </label>\n                                    </div>\n                                    <div id="cityCheckboxesContainer" style="display: flex; flex-wrap: wrap; gap: 8px; max-height: 80px; overflow-y: auto; padding: 5px;"></div>\n                                </div>\n                                <div id="latencyResultsList" style="background: rgba(0, 0, 0, 0.5); border: 1px solid #004400; border-radius: 4px; padding: 10px;"></div>\n                                <div style="margin-top: 10px; display: flex; gap: 10px;">\n                                    <button type="button" id="overwriteSelectedToYx" style="flex: 1; background: rgba(0, 200, 0, 0.3); border: 1px solid #00ff00; padding: 10px 20px; color: #00ff00; font-family: 'Courier New', monospace; font-weight: bold; cursor: pointer; transition: all 0.3s;">è¦†ç›–æ·»åŠ </button>\n                                    <button type="button" id="appendSelectedToYx" style="flex: 1; background: rgba(0, 150, 0, 0.3); border: 1px solid #00aa00; padding: 10px 20px; color: #00aa00; font-family: 'Courier New', monospace; font-weight: bold; cursor: pointer; transition: all 0.3s;">è¿½åŠ æ·»åŠ </button>\n                                </div>\n                            </div>\n                        </div>\n                        \n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.socks5Config}</label>\n                                <input type="text" id="socksConfig" placeholder="${a?"Ù…Ø«Ø§Ù„: user:pass@host:port ÛŒØ§ host:port":"ä¾‹å¦‚: user:pass@host:port æˆ– host:port"}" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                <small style="color: #00aa00; font-size: 0.85rem;">${a?"Ø¢Ø¯Ø±Ø³ Ù¾Ø±ÙˆÚ©Ø³ÛŒ SOCKS5ØŒ Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ ØªÙ…Ø§Ù… ØªØ±Ø§ÙÛŒÚ© Ø®Ø±ÙˆØ¬ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯":"SOCKS5ä»£ç†åœ°å€ï¼Œç”¨äºè½¬å‘æ‰€æœ‰å‡ºç«™æµé‡"}</small>\n                        </div>\n                            <button type="submit" style="background: rgba(0, 255, 0, 0.15); border: 2px solid #00ff00; padding: 12px 24px; color: #00ff00; font-family: 'Courier New', monospace; font-weight: bold; cursor: pointer; margin-right: 10px; text-shadow: 0 0 8px #00ff00; transition: all 0.4s ease;">${i.saveConfig}</button>\n                    </form>\n                    \n                        <h3 style="color: #00ff00; margin: 20px 0 15px 0; font-size: 1.2rem;">${i.advancedControl}</h3>\n                    <form id="advancedConfigForm" style="margin-bottom: 20px;">\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.subscriptionConverter}</label>\n                                <input type="text" id="scu" placeholder="${i.subscriptionConverterPlaceholder}" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                <small style="color: #00aa00; font-size: 0.85rem;">${i.subscriptionConverterHint}</small>\n                        </div>\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.builtinPreferred}</label>\n                            <div style="padding: 15px; background: rgba(0, 20, 0, 0.6); border: 1px solid #00ff00; border-radius: 5px;">\n                                <div style="margin-bottom: 10px;">\n                                    <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00;">\n                                        <input type="checkbox" id="epd" style="margin-right: 8px; width: 18px; height: 18px; cursor: pointer;">\n                                            <span style="font-size: 1.1rem;">${i.enablePreferredDomain}</span>\n                                    </label>\n                                </div>\n                                <div style="margin-bottom: 10px;">\n                                    <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00;">\n                                        <input type="checkbox" id="epi" checked style="margin-right: 8px; width: 18px; height: 18px; cursor: pointer;">\n                                            <span style="font-size: 1.1rem;">${i.enablePreferredIP}</span>\n                                    </label>\n                                </div>\n                                <div style="margin-bottom: 10px;">\n                                    <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00;">\n                                        <input type="checkbox" id="egi" checked style="margin-right: 8px; width: 18px; height: 18px; cursor: pointer;">\n                                            <span style="font-size: 1.1rem;">${i.enableGitHubPreferred}</span>\n                                    </label>\n                                </div>\n                                    <small style="color: #00aa00; font-size: 0.85rem; display: block; margin-top: 10px;">${i.builtinPreferredHint}</small>\n                            </div>\n                        </div>\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">ä¼˜é€‰IPç­›é€‰è®¾ç½®</label>\n                            <div style="padding: 15px; background: rgba(0, 20, 0, 0.6); border: 1px solid #00ff00; border-radius: 5px;">\n                                <div style="margin-bottom: 15px;">\n                                    <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">IPç‰ˆæœ¬é€‰æ‹©</label>\n                                    <div style="display: flex; gap: 20px; flex-wrap: wrap;">\n                                        <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00;">\n                                            <input type="checkbox" id="ipv4Enabled" checked style="margin-right: 8px; width: 18px; height: 18px; cursor: pointer;">\n                                            <span style="font-size: 1rem;">IPv4</span>\n                                        </label>\n                                        <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00;">\n                                            <input type="checkbox" id="ipv6Enabled" checked style="margin-right: 8px; width: 18px; height: 18px; cursor: pointer;">\n                                            <span style="font-size: 1rem;">IPv6</span>\n                                        </label>\n                                    </div>\n                                </div>\n                                <div style="margin-bottom: 10px;">\n                                    <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">è¿è¥å•†é€‰æ‹©</label>\n                                    <div style="display: flex; gap: 20px; flex-wrap: wrap;">\n                                        <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00;">\n                                            <input type="checkbox" id="ispMobile" checked style="margin-right: 8px; width: 18px; height: 18px; cursor: pointer;">\n                                            <span style="font-size: 1rem;">ç§»åŠ¨</span>\n                                        </label>\n                                        <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00;">\n                                            <input type="checkbox" id="ispUnicom" checked style="margin-right: 8px; width: 18px; height: 18px; cursor: pointer;">\n                                            <span style="font-size: 1rem;">è”é€š</span>\n                                        </label>\n                                        <label style="display: inline-flex; align-items: center; cursor: pointer; color: #00ff00;">\n                                            <input type="checkbox" id="ispTelecom" checked style="margin-right: 8px; width: 18px; height: 18px; cursor: pointer;">\n                                            <span style="font-size: 1rem;">ç”µä¿¡</span>\n                                        </label>\n                                    </div>\n                                </div>\n                                    <small style="color: #00aa00; font-size: 0.85rem; display: block; margin-top: 10px;">é€‰æ‹©è¦ä½¿ç”¨çš„IPç‰ˆæœ¬å’Œè¿è¥å•†ï¼Œæœªé€‰ä¸­çš„å°†è¢«è¿‡æ»¤</small>\n                            </div>\n                        </div>\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.allowAPIManagement}</label>\n                            <select id="apiEnabled" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                    <option value="">${i.apiEnabledDefault}</option>\n                                    <option value="yes">${i.apiEnabledYes}</option>\n                            </select>\n                                <small style="color: #ffaa00; font-size: 0.85rem;">${i.apiEnabledHint}</small>\n                        </div>\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.regionMatching}</label>\n                            <select id="regionMatching" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                    <option value="">${i.regionMatchingDefault}</option>\n                                    <option value="no">${i.regionMatchingNo}</option>\n                            </select>\n                                <small style="color: #00aa00; font-size: 0.85rem;">${i.regionMatchingHint}</small>\n                        </div>\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.downgradeControl}</label>\n                            <select id="downgradeControl" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                    <option value="">${i.downgradeControlDefault}</option>\n                                    <option value="no">${i.downgradeControlNo}</option>\n                            </select>\n                                <small style="color: #00aa00; font-size: 0.85rem;">${i.downgradeControlHint}</small>\n                        </div>\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.tlsControl}</label>\n                            <select id="portControl" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                    <option value="">${i.tlsControlDefault}</option>\n                                    <option value="yes">${i.tlsControlYes}</option>\n                            </select>\n                                <small style="color: #00aa00; font-size: 0.85rem;">${i.tlsControlHint}</small>\n                        </div>\n                        <div style="margin-bottom: 15px;">\n                                <label style="display: block; margin-bottom: 8px; color: #00ff00; font-weight: bold; text-shadow: 0 0 3px #00ff00;">${i.preferredControl}</label>\n                            <select id="preferredControl" style="width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff00; color: #00ff00; font-family: 'Courier New', monospace; font-size: 14px;">\n                                    <option value="">${i.preferredControlDefault}</option>\n                                    <option value="yes">${i.preferredControlYes}</option>\n                            </select>\n                                <small style="color: #00aa00; font-size: 0.85rem;">${i.preferredControlHint}</small>\n                        </div>\n                            <button type="submit" style="background: rgba(0, 255, 0, 0.15); border: 2px solid #00ff00; padding: 12px 24px; color: #00ff00; font-family: 'Courier New', monospace; font-weight: bold; cursor: pointer; margin-right: 10px; text-shadow: 0 0 8px #00ff00; transition: all 0.4s ease;">${i.saveAdvanced}</button>\n                    </form>\n                    <div id="currentConfig" style="background: rgba(0, 0, 0, 0.9); border: 1px solid #00ff00; padding: 15px; margin: 10px 0; font-family: 'Courier New', monospace; color: #00ff00;">\n                            ${i.loading}\n                    </div>\n                    <div id="pathTypeInfo" style="background: rgba(0, 20, 0, 0.7); border: 1px solid #00ff00; padding: 15px; margin: 10px 0; font-family: 'Courier New', monospace; color: #00ff00;">\n                            <div style="font-weight: bold; margin-bottom: 8px; color: #44ff44; text-shadow: 0 0 5px #44ff44;">${i.currentConfig}</div>\n                            <div id="pathTypeStatus">${i.checking}</div>\n                    </div>\n                        <button onclick="loadCurrentConfig()" style="background: rgba(0, 255, 0, 0.15); border: 2px solid #00ff00; padding: 12px 24px; color: #00ff00; font-family: 'Courier New', monospace; font-weight: bold; cursor: pointer; margin-right: 10px; text-shadow: 0 0 8px #00ff00; transition: all 0.4s ease;">${i.refreshConfig}</button>\n                        <button onclick="resetAllConfig()" style="background: rgba(255, 0, 0, 0.15); border: 2px solid #ff0000; padding: 12px 24px; color: #ff0000; font-family: 'Courier New', monospace; font-weight: bold; cursor: pointer; text-shadow: 0 0 8px #ff0000; transition: all 0.4s ease;">${i.resetConfig}</button>\n                </div>\n                <div id="statusMessage" style="display: none; padding: 10px; margin: 10px 0; border: 1px solid #00ff00; background: rgba(0, 20, 0, 0.8); color: #00ff00; text-shadow: 0 0 5px #00ff00;"></div>\n            </div>\n            \n            <div class="card">\n                    <h2 class="card-title">${i.relatedLinks}</h2>\n                <div style="text-align: center; margin: 20px 0;">\n                        <a href="https://github.com/byJoey/cfnew" target="_blank" style="color: #00ff00; text-decoration: none; margin: 0 20px; font-size: 1.2rem; text-shadow: 0 0 5px #00ff00;">${i.githubProject}</a>\n                    <a href="https://www.youtube.com/@joeyblog" target="_blank" style="color: #00ff00; text-decoration: none; margin: 0 20px; font-size: 1.2rem; text-shadow: 0 0 5px #00ff00;">YouTube @codinggorilla</a>\n                </div>\n            </div>\n        </div>\n        <script>\n            // è®¢é˜…è½¬æ¢åœ°å€ï¼ˆä»æœåŠ¡å™¨é…ç½®æ³¨å…¥ï¼‰\n            var SUB_CONVERTER_URL = "${scu}";\n            // è¿œç¨‹é…ç½®URLï¼ˆç¡¬ç¼–ç ï¼‰\n            var REMOTE_CONFIG_URL = "${remoteConfigUrl}";\n                \n                // ç¿»è¯‘å¯¹è±¡\n                const translations = {\n                    zh: {\n                        subscriptionCopied: 'è®¢é˜…é“¾æ¥å·²å¤åˆ¶',\n                        autoSubscriptionCopied: 'è‡ªåŠ¨è¯†åˆ«è®¢é˜…é“¾æ¥å·²å¤åˆ¶ï¼Œå®¢æˆ·ç«¯è®¿é—®æ—¶ä¼šæ ¹æ®User-Agentè‡ªåŠ¨è¯†åˆ«å¹¶è¿”å›å¯¹åº”æ ¼å¼'\n                    },\n                    fa: {\n                        subscriptionCopied: 'Ù„ÛŒÙ†Ú© Ø§Ø´ØªØ±Ø§Ú© Ú©Ù¾ÛŒ Ø´Ø¯',\n                        autoSubscriptionCopied: 'Ù„ÛŒÙ†Ú© Ø§Ø´ØªØ±Ø§Ú© ØªØ´Ø®ÛŒØµ Ø®ÙˆØ¯Ú©Ø§Ø± Ú©Ù¾ÛŒ Ø´Ø¯ØŒ Ú©Ù„Ø§ÛŒÙ†Øª Ù‡Ù†Ú¯Ø§Ù… Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ User-Agent Ø¨Ù‡ Ø·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø¯Ù‡ Ùˆ Ù‚Ø§Ù„Ø¨ Ù…Ø±Ø¨ÙˆØ·Ù‡ Ø±Ø§ Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯'\n                    }\n                };\n                \n                function getCookie(name) {\n                    const value = '; ' + document.cookie;\n                    const parts = value.split('; ' + name + '=');\n                    if (parts.length === 2) return parts.pop().split(';').shift();\n                    return null;\n                }\n                \n                const browserLang = navigator.language || navigator.userLanguage || '';\n                const savedLang = localStorage.getItem('preferredLanguage') || getCookie('preferredLanguage');\n                let isFarsi = false;\n                \n                if (savedLang === 'fa' || savedLang === 'fa-IR') {\n                    isFarsi = true;\n                } else if (savedLang === 'zh' || savedLang === 'zh-CN') {\n                    isFarsi = false;\n                } else {\n                    isFarsi = browserLang.includes('fa') || browserLang.includes('fa-IR');\n                }\n                \n                const t = translations[isFarsi ? 'fa' : 'zh'];\n                \n                function changeLanguage(lang) {\n                    localStorage.setItem('preferredLanguage', lang);\n                    // è®¾ç½®Cookieï¼ˆæœ‰æ•ˆæœŸ1å¹´ï¼‰\n                    const expiryDate = new Date();\n                    expiryDate.setFullYear(expiryDate.getFullYear() + 1);\n                    document.cookie = 'preferredLanguage=' + lang + '; path=/; expires=' + expiryDate.toUTCString() + '; SameSite=Lax';\n                    // åˆ·æ–°é¡µé¢ï¼Œä¸ä½¿ç”¨URLå‚æ•°\n                    window.location.reload();\n                }\n                \n                // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ localStorage å’Œ Cookieï¼Œå¹¶æ¸…ç†URLå‚æ•°\n                window.addEventListener('DOMContentLoaded', function() {\n                    const savedLang = localStorage.getItem('preferredLanguage') || getCookie('preferredLanguage');\n                    const urlParams = new URLSearchParams(window.location.search);\n                    const urlLang = urlParams.get('lang');\n                    \n                    // å¦‚æœURLä¸­æœ‰è¯­è¨€å‚æ•°ï¼Œç§»é™¤å®ƒå¹¶è®¾ç½®Cookie\n                    if (urlLang) {\n                        const currentUrl = new URL(window.location.href);\n                        currentUrl.searchParams.delete('lang');\n                        const newUrl = currentUrl.toString();\n                        \n                        // è®¾ç½®Cookie\n                        const expiryDate = new Date();\n                        expiryDate.setFullYear(expiryDate.getFullYear() + 1);\n                        document.cookie = 'preferredLanguage=' + urlLang + '; path=/; expires=' + expiryDate.toUTCString() + '; SameSite=Lax';\n                        localStorage.setItem('preferredLanguage', urlLang);\n                        \n                        // ä½¿ç”¨history APIç§»é™¤URLå‚æ•°ï¼Œä¸åˆ·æ–°é¡µé¢\n                        window.history.replaceState({}, '', newUrl);\n                    } else if (savedLang) {\n                        // å¦‚æœlocalStorageä¸­æœ‰ä½†Cookieä¸­æ²¡æœ‰ï¼ŒåŒæ­¥åˆ°Cookie\n                        const expiryDate = new Date();\n                        expiryDate.setFullYear(expiryDate.getFullYear() + 1);\n                        document.cookie = 'preferredLanguage=' + savedLang + '; path=/; expires=' + expiryDate.toUTCString() + '; SameSite=Lax';\n                    }\n                });\n            \n            function tryOpenApp(schemeUrl, fallbackCallback, timeout) {\n                timeout = timeout || 2500;\n                var appOpened = false;\n                var callbackExecuted = false;\n                var startTime = Date.now();\n                \n                var blurHandler = function() {\n                    var elapsed = Date.now() - startTime;\n                    if (elapsed < 3000 && !callbackExecuted) {\n                        appOpened = true;\n                    }\n                };\n                \n                window.addEventListener('blur', blurHandler);\n                \n                var hiddenHandler = function() {\n                    var elapsed = Date.now() - startTime;\n                    if (elapsed < 3000 && !callbackExecuted) {\n                        appOpened = true;\n                    }\n                };\n                \n                document.addEventListener('visibilitychange', hiddenHandler);\n                \n                var iframe = document.createElement('iframe');\n                iframe.style.display = 'none';\n                iframe.style.width = '1px';\n                iframe.style.height = '1px';\n                iframe.src = schemeUrl;\n                document.body.appendChild(iframe);\n                \n                setTimeout(function() {\n                    iframe.parentNode && iframe.parentNode.removeChild(iframe);\n                    window.removeEventListener('blur', blurHandler);\n                    document.removeEventListener('visibilitychange', hiddenHandler);\n                    \n                    if (!callbackExecuted) {\n                        callbackExecuted = true;\n                        if (!appOpened && fallbackCallback) {\n                            fallbackCallback();\n                        }\n                    }\n                }, timeout);\n            }\n            \n            function generateClientLink(clientType, clientName) {\n                var currentUrl = window.location.href;\n                var subscriptionUrl = currentUrl + "/sub";\n                var schemeUrl = '';\n                var displayName = clientName || '';\n                var finalUrl = subscriptionUrl;\n                \n                if (clientType === atob('djJyYXk=')) {\n                    finalUrl = subscriptionUrl;\n                    var urlElement = document.getElementById("clientSubscriptionUrl");\n                    urlElement.textContent = finalUrl;\n                    urlElement.style.display = "block";\n                    urlElement.style.overflowWrap = "break-word";\n                    urlElement.style.wordBreak = "break-all";\n                    urlElement.style.overflowX = "auto";\n                    urlElement.style.maxWidth = "100%";\n                    urlElement.style.boxSizing = "border-box";\n                    \n                    if (clientName === 'V2RAY') {\n                        navigator.clipboard.writeText(finalUrl).then(function() {\n                                alert(displayName + " " + t.subscriptionCopied);\n                        });\n                    } else if (clientName === 'Shadowrocket') {\n                        schemeUrl = 'shadowrocket://add/' + encodeURIComponent(finalUrl);\n                        tryOpenApp(schemeUrl, function() {\n                            navigator.clipboard.writeText(finalUrl).then(function() {\n                                    alert(displayName + " " + t.subscriptionCopied);\n                            });\n                        });\n                    } else if (clientName === 'V2RAYNG') {\n                        schemeUrl = 'v2rayng://install?url=' + encodeURIComponent(finalUrl);\n                        tryOpenApp(schemeUrl, function() {\n                            navigator.clipboard.writeText(finalUrl).then(function() {\n                                    alert(displayName + " " + t.subscriptionCopied);\n                            });\n                        });\n                    } else if (clientName === 'NEKORAY') {\n                        schemeUrl = 'nekoray://install-config?url=' + encodeURIComponent(finalUrl);\n                        tryOpenApp(schemeUrl, function() {\n                            navigator.clipboard.writeText(finalUrl).then(function() {\n                                    alert(displayName + " " + t.subscriptionCopied);\n                            });\n                        });\n                    }\n                } else {\n                    // æ£€æŸ¥ ECH æ˜¯å¦å¼€å¯\n                    var echEnabled = document.getElementById('ech') && document.getElementById('ech').checked;\n                    \n                    // å¦‚æœ ECH å¼€å¯ä¸”æ˜¯ Clashï¼Œç›´æ¥ä½¿ç”¨åç«¯æ¥å£\n                    if (echEnabled && clientType === atob('Y2xhc2g=')) {\n                        finalUrl = subscriptionUrl + "?target=" + clientType;\n                        var urlElement = document.getElementById("clientSubscriptionUrl");\n                        urlElement.textContent = finalUrl;\n                        urlElement.style.display = "block";\n                        urlElement.style.overflowWrap = "break-word";\n                        urlElement.style.wordBreak = "break-all";\n                        urlElement.style.overflowX = "auto";\n                        urlElement.style.maxWidth = "100%";\n                        urlElement.style.boxSizing = "border-box";\n                        \n                        if (clientName === 'STASH') {\n                            schemeUrl = 'stash://install?url=' + encodeURIComponent(finalUrl);\n                            displayName = 'STASH';\n                        } else {\n                            schemeUrl = 'clash://install-config?url=' + encodeURIComponent(finalUrl);\n                            displayName = 'CLASH';\n                        }\n                        \n                        if (schemeUrl) {\n                            tryOpenApp(schemeUrl, function() {\n                                navigator.clipboard.writeText(finalUrl).then(function() {\n                                        alert(displayName + " " + t.subscriptionCopied);\n                                });\n                            });\n                        } else {\n                            navigator.clipboard.writeText(finalUrl).then(function() {\n                                    alert(displayName + " " + t.subscriptionCopied);\n                            });\n                        }\n                    } else {\n                        // å…¶ä»–æƒ…å†µä½¿ç”¨è®¢é˜…è½¬æ¢æœåŠ¡\n                        var encodedUrl = encodeURIComponent(subscriptionUrl);\n                        finalUrl = SUB_CONVERTER_URL + "?target=" + clientType + "&url=" + encodedUrl + "&insert=false&config=" + encodeURIComponent(REMOTE_CONFIG_URL) + "&emoji=true&list=false&xudp=false&udp=false&tfo=false&expand=true&scv=false&fdn=false&new_name=true";\n                        var urlElement = document.getElementById("clientSubscriptionUrl");\n                        urlElement.textContent = finalUrl;\n                        urlElement.style.display = "block";\n                        urlElement.style.overflowWrap = "break-word";\n                        urlElement.style.wordBreak = "break-all";\n                        urlElement.style.overflowX = "auto";\n                        urlElement.style.maxWidth = "100%";\n                        urlElement.style.boxSizing = "border-box";\n                        \n                        if (clientType === atob('Y2xhc2g=')) {\n                            if (clientName === 'STASH') {\n                                schemeUrl = 'stash://install?url=' + encodeURIComponent(finalUrl);\n                                displayName = 'STASH';\n                            } else {\n                                schemeUrl = 'clash://install-config?url=' + encodeURIComponent(finalUrl);\n                                displayName = 'CLASH';\n                            }\n                        } else if (clientType === atob('c3VyZ2U=')) {\n                            schemeUrl = 'surge:///install-config?url=' + encodeURIComponent(finalUrl);\n                            displayName = 'SURGE';\n                        } else if (clientType === atob('c2luZ2JveA==')) {\n                            schemeUrl = 'sing-box://install-config?url=' + encodeURIComponent(finalUrl);\n                            displayName = 'SING-BOX';\n                        } else if (clientType === atob('bG9vbg==')) {\n                            schemeUrl = 'loon://install?url=' + encodeURIComponent(finalUrl);\n                            displayName = 'LOON';\n                        } else if (clientType === atob('cXVhbng=')) {\n                            schemeUrl = 'quantumult-x://install-config?url=' + encodeURIComponent(finalUrl);\n                            displayName = 'QUANTUMULT X';\n                        }\n                        \n                        if (schemeUrl) {\n                            tryOpenApp(schemeUrl, function() {\n                                navigator.clipboard.writeText(finalUrl).then(function() {\n                                        alert(displayName + " " + t.subscriptionCopied);\n                                });\n                            });\n                        } else {\n                            navigator.clipboard.writeText(finalUrl).then(function() {\n                                    alert(displayName + " " + t.subscriptionCopied);\n                            });\n                        }\n                    }\n                }\n            }\n            \n            function createMatrixRain() {\n                const matrixContainer = document.getElementById('matrixCodeRain');\n                const matrixChars = '01ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';\n                const columns = Math.floor(window.innerWidth / 18);\n                \n                for (let i = 0; i < columns; i++) {\n                    const column = document.createElement('div');\n                    column.className = 'matrix-column';\n                    column.style.left = (i * 18) + 'px';\n                    column.style.animationDelay = Math.random() * 15 + 's';\n                    column.style.animationDuration = (Math.random() * 15 + 8) + 's';\n                    column.style.fontSize = (Math.random() * 4 + 12) + 'px';\n                    column.style.opacity = Math.random() * 0.8 + 0.2;\n                    \n                    let text = '';\n                    const charCount = Math.floor(Math.random() * 30 + 20);\n                    for (let j = 0; j < charCount; j++) {\n                        const char = matrixChars[Math.floor(Math.random() * matrixChars.length)];\n                        const brightness = Math.random() > 0.1 ? '#00ff00' : '#00aa00';\n                        text += '<span style="color: ' + brightness + ';">' + char + '</span><br>';\n                    }\n                    column.innerHTML = text;\n                    matrixContainer.appendChild(column);\n                }\n                \n                setInterval(function() {\n                    const columns = matrixContainer.querySelectorAll('.matrix-column');\n                    columns.forEach(function(column) {\n                        if (Math.random() > 0.95) {\n                            const chars = column.querySelectorAll('span');\n                            if (chars.length > 0) {\n                                const randomChar = chars[Math.floor(Math.random() * chars.length)];\n                                randomChar.style.color = '#ffffff';\n                                setTimeout(function() {\n                                    randomChar.style.color = '#00ff00';\n                                }, 200);\n                            }\n                        }\n                    });\n                }, 100);\n            }\n            \n            async function checkSystemStatus() {\n                try {\n                    const cfStatus = document.getElementById('cfStatus');\n                    const regionStatus = document.getElementById('regionStatus');\n                    const geoInfo = document.getElementById('geoInfo');\n                    const backupStatus = document.getElementById('backupStatus');\n                    const currentIP = document.getElementById('currentIP');\n                    const regionMatch = document.getElementById('regionMatch');\n                    \n                        // è·å–å½“å‰è¯­è¨€è®¾ç½®ï¼ˆä¼˜å…ˆä»Cookie/localStorageè¯»å–ï¼‰\n                        function getCookie(name) {\n                            const value = '; ' + document.cookie;\n                            const parts = value.split('; ' + name + '=');\n                            if (parts.length === 2) return parts.pop().split(';').shift();\n                            return null;\n                        }\n                        \n                        const browserLang = navigator.language || navigator.userLanguage || '';\n                        const savedLang = localStorage.getItem('preferredLanguage') || getCookie('preferredLanguage');\n                        let isFarsi = false;\n                        \n                        if (savedLang === 'fa' || savedLang === 'fa-IR') {\n                            isFarsi = true;\n                        } else if (savedLang === 'zh' || savedLang === 'zh-CN') {\n                            isFarsi = false;\n                        } else {\n                            isFarsi = browserLang.includes('fa') || browserLang.includes('fa-IR');\n                        }\n                        \n                        const translations = {\n                            zh: {\n                                workerRegion: 'Workeråœ°åŒº: ',\n                                detectionMethod: 'æ£€æµ‹æ–¹å¼: ',\n                                proxyIPStatus: 'ProxyIPçŠ¶æ€: ',\n                                currentIP: 'å½“å‰ä½¿ç”¨IP: ',\n                                regionMatch: 'åœ°åŒºåŒ¹é…: ',\n                                regionNames: {\n                        'US': 'ğŸ‡ºğŸ‡¸ ç¾å›½', 'SG': 'ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡', 'JP': 'ğŸ‡¯ğŸ‡µ æ—¥æœ¬',\n                        'KR': 'ğŸ‡°ğŸ‡· éŸ©å›½', 'DE': 'ğŸ‡©ğŸ‡ª å¾·å›½', 'SE': 'ğŸ‡¸ğŸ‡ª ç‘å…¸', 'NL': 'ğŸ‡³ğŸ‡± è·å…°',\n                        'FI': 'ğŸ‡«ğŸ‡® èŠ¬å…°', 'GB': 'ğŸ‡¬ğŸ‡§ è‹±å›½'\n                                },\n                                customIPMode: 'è‡ªå®šä¹‰ProxyIPæ¨¡å¼ (på˜é‡å¯ç”¨)',\n                                customIPModeDesc: 'è‡ªå®šä¹‰IPæ¨¡å¼ (å·²ç¦ç”¨åœ°åŒºåŒ¹é…)',\n                                usingCustomProxyIP: 'ä½¿ç”¨è‡ªå®šä¹‰ProxyIP: ',\n                                customIPConfig: ' (på˜é‡é…ç½®)',\n                                customIPModeDisabled: 'è‡ªå®šä¹‰IPæ¨¡å¼ï¼Œåœ°åŒºé€‰æ‹©å·²ç¦ç”¨',\n                                manualRegion: 'æ‰‹åŠ¨æŒ‡å®šåœ°åŒº',\n                                manualRegionDesc: ' (æ‰‹åŠ¨æŒ‡å®š)',\n                                proxyIPAvailable: '10/10 å¯ç”¨ (ProxyIPåŸŸåé¢„è®¾å¯ç”¨)',\n                                smartSelection: 'æ™ºèƒ½å°±è¿‘é€‰æ‹©ä¸­',\n                                sameRegionIP: 'åŒåœ°åŒºIPå¯ç”¨ (1ä¸ª)',\n                                cloudflareDetection: 'Cloudflareå†…ç½®æ£€æµ‹',\n                                detectionFailed: 'æ£€æµ‹å¤±è´¥',\n                                unknown: 'æœªçŸ¥'\n                            },\n                            fa: {\n                                workerRegion: 'Ù…Ù†Ø·Ù‚Ù‡ Worker: ',\n                                detectionMethod: 'Ø±ÙˆØ´ ØªØ´Ø®ÛŒØµ: ',\n                                proxyIPStatus: 'ÙˆØ¶Ø¹ÛŒØª ProxyIP: ',\n                                currentIP: 'IP ÙØ¹Ù„ÛŒ: ',\n                                regionMatch: 'ØªØ·Ø¨ÛŒÙ‚ Ù…Ù†Ø·Ù‚Ù‡: ',\n                                regionNames: {\n                                    'US': 'ğŸ‡ºğŸ‡¸ Ø¢Ù…Ø±ÛŒÚ©Ø§', 'SG': 'ğŸ‡¸ğŸ‡¬ Ø³Ù†Ú¯Ø§Ù¾ÙˆØ±', 'JP': 'ğŸ‡¯ğŸ‡µ Ú˜Ø§Ù¾Ù†',\n                                    'KR': 'ğŸ‡°ğŸ‡· Ú©Ø±Ù‡ Ø¬Ù†ÙˆØ¨ÛŒ', 'DE': 'ğŸ‡©ğŸ‡ª Ø¢Ù„Ù…Ø§Ù†', 'SE': 'ğŸ‡¸ğŸ‡ª Ø³ÙˆØ¦Ø¯', 'NL': 'ğŸ‡³ğŸ‡± Ù‡Ù„Ù†Ø¯',\n                                    'FI': 'ğŸ‡«ğŸ‡® ÙÙ†Ù„Ø§Ù†Ø¯', 'GB': 'ğŸ‡¬ğŸ‡§ Ø¨Ø±ÛŒØªØ§Ù†ÛŒØ§'\n                                },\n                                customIPMode: 'Ø­Ø§Ù„Øª ProxyIP Ø³ÙØ§Ø±Ø´ÛŒ (Ù…ØªØºÛŒØ± p ÙØ¹Ø§Ù„ Ø§Ø³Øª)',\n                                customIPModeDesc: 'Ø­Ø§Ù„Øª IP Ø³ÙØ§Ø±Ø´ÛŒ (ØªØ·Ø¨ÛŒÙ‚ Ù…Ù†Ø·Ù‚Ù‡ ØºÛŒØ±ÙØ¹Ø§Ù„ Ø§Ø³Øª)',\n                                usingCustomProxyIP: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ProxyIP Ø³ÙØ§Ø±Ø´ÛŒ: ',\n                                customIPConfig: ' (Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ù…ØªØºÛŒØ± p)',\n                                customIPModeDisabled: 'Ø­Ø§Ù„Øª IP Ø³ÙØ§Ø±Ø´ÛŒØŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ù†Ø·Ù‚Ù‡ ØºÛŒØ±ÙØ¹Ø§Ù„ Ø§Ø³Øª',\n                                manualRegion: 'ØªØ¹ÛŒÛŒÙ† Ù…Ù†Ø·Ù‚Ù‡ Ø¯Ø³ØªÛŒ',\n                                manualRegionDesc: ' (ØªØ¹ÛŒÛŒÙ† Ø¯Ø³ØªÛŒ)',\n                                proxyIPAvailable: '10/10 Ø¯Ø± Ø¯Ø³ØªØ±Ø³ (Ø¯Ø§Ù…Ù†Ù‡ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ ProxyIP Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ø§Ø³Øª)',\n                                smartSelection: 'Ø§Ù†ØªØ®Ø§Ø¨ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù†Ø²Ø¯ÛŒÚ© Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù… Ø§Ø³Øª',\n                                sameRegionIP: 'IP Ù‡Ù…â€ŒÙ…Ù†Ø·Ù‚Ù‡ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ø§Ø³Øª (1)',\n                                cloudflareDetection: 'ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø®Ù„ÛŒ Cloudflare',\n                                detectionFailed: 'ØªØ´Ø®ÛŒØµ Ù†Ø§Ù…ÙˆÙÙ‚',\n                                unknown: 'Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡'\n                            }\n                        };\n                        \n                        const t = translations[isFarsi ? 'fa' : 'zh'];\n                    \n                    let detectedRegion = 'US'; // é»˜è®¤å€¼\n                    let isCustomIPMode = false;\n                    let isManualRegionMode = false;\n                    try {\n                        const response = await fetch(window.location.pathname + '/region');\n                        const data = await response.json();\n                        \n                        if (data.region === 'CUSTOM') {\n                            isCustomIPMode = true;\n                            detectedRegion = 'CUSTOM';\n                            \n                            // è·å–è‡ªå®šä¹‰IPçš„è¯¦ç»†ä¿¡æ¯\n                                const customIPInfo = data.ci || t.unknown;\n                            \n                                geoInfo.innerHTML = t.detectionMethod + '<span style="color: #ffaa00;">âš™ï¸ ' + t.customIPMode + '</span>';\n                                regionStatus.innerHTML = t.workerRegion + '<span style="color: #ffaa00;">ğŸ”§ ' + t.customIPModeDesc + '</span>';\n                            \n                            // æ˜¾ç¤ºè‡ªå®šä¹‰IPé…ç½®çŠ¶æ€ï¼ŒåŒ…å«å…·ä½“IP\n                                if (backupStatus) backupStatus.innerHTML = t.proxyIPStatus + '<span style="color: #ffaa00;">ğŸ”§ ' + t.usingCustomProxyIP + customIPInfo + '</span>';\n                                if (currentIP) currentIP.innerHTML = t.currentIP + '<span style="color: #ffaa00;">âœ… ' + customIPInfo + t.customIPConfig + '</span>';\n                                if (regionMatch) regionMatch.innerHTML = t.regionMatch + '<span style="color: #ffaa00;">âš ï¸ ' + t.customIPModeDisabled + '</span>';\n                            \n                            return; // æå‰è¿”å›ï¼Œä¸æ‰§è¡Œåç»­çš„åœ°åŒºåŒ¹é…é€»è¾‘\n                            } else if (data.detectionMethod === 'æ‰‹åŠ¨æŒ‡å®šåœ°åŒº' || data.detectionMethod === 'ØªØ¹ÛŒÛŒÙ† Ù…Ù†Ø·Ù‚Ù‡ Ø¯Ø³ØªÛŒ') {\n                            isManualRegionMode = true;\n                            detectedRegion = data.region;\n                            \n                                geoInfo.innerHTML = t.detectionMethod + '<span style="color: #44aa44;">' + t.manualRegion + '</span>';\n                                regionStatus.innerHTML = t.workerRegion + '<span style="color: #44ff44;">ğŸ¯ ' + t.regionNames[detectedRegion] + t.manualRegionDesc + '</span>';\n                            \n                            // æ˜¾ç¤ºé…ç½®çŠ¶æ€è€Œä¸æ˜¯æ£€æµ‹çŠ¶æ€\n                                if (backupStatus) backupStatus.innerHTML = t.proxyIPStatus + '<span style="color: #44ff44;">âœ… ' + t.proxyIPAvailable + '</span>';\n                                if (currentIP) currentIP.innerHTML = t.currentIP + '<span style="color: #44ff44;">âœ… ' + t.smartSelection + '</span>';\n                                if (regionMatch) regionMatch.innerHTML = t.regionMatch + '<span style="color: #44ff44;">âœ… ' + t.sameRegionIP + '</span>';\n                            \n                            return; // æå‰è¿”å›ï¼Œä¸æ‰§è¡Œåç»­çš„åœ°åŒºåŒ¹é…é€»è¾‘\n                            } else if (data.region && t.regionNames[data.region]) {\n                            detectedRegion = data.region;\n                        }\n                        \n                            geoInfo.innerHTML = t.detectionMethod + '<span style="color: #44ff44;">' + t.cloudflareDetection + '</span>';\n                        \n                    } catch (e) {\n                            geoInfo.innerHTML = t.detectionMethod + '<span style="color: #ff4444;">' + t.detectionFailed + '</span>';\n                    }\n                    \n                        regionStatus.innerHTML = t.workerRegion + '<span style="color: #44ff44;">âœ… ' + t.regionNames[detectedRegion] + '</span>';\n                    \n                    // ç›´æ¥æ˜¾ç¤ºé…ç½®çŠ¶æ€ï¼Œä¸å†è¿›è¡Œæ£€æµ‹\n                    if (backupStatus) {\n                            backupStatus.innerHTML = t.proxyIPStatus + '<span style="color: #44ff44;">âœ… ' + t.proxyIPAvailable + '</span>';\n                    }\n                    \n                    if (currentIP) {\n                            currentIP.innerHTML = t.currentIP + '<span style="color: #44ff44;">âœ… ' + t.smartSelection + '</span>';\n                    }\n                    \n                    if (regionMatch) {\n                            regionMatch.innerHTML = t.regionMatch + '<span style="color: #44ff44;">âœ… ' + t.sameRegionIP + '</span>';\n                    }\n                    \n                } catch (error) {\n                        function getCookie(name) {\n                            const value = '; ' + document.cookie;\n                            const parts = value.split('; ' + name + '=');\n                            if (parts.length === 2) return parts.pop().split(';').shift();\n                            return null;\n                        }\n                        \n                        const browserLang = navigator.language || navigator.userLanguage || '';\n                        const savedLang = localStorage.getItem('preferredLanguage') || getCookie('preferredLanguage');\n                        let isFarsi = false;\n                        \n                        if (savedLang === 'fa' || savedLang === 'fa-IR') {\n                            isFarsi = true;\n                        } else {\n                            isFarsi = browserLang.includes('fa') || browserLang.includes('fa-IR');\n                        }\n                        \n                        const translations = {\n                            zh: {\n                                workerRegion: 'Workeråœ°åŒº: ',\n                                detectionMethod: 'æ£€æµ‹æ–¹å¼: ',\n                                proxyIPStatus: 'ProxyIPçŠ¶æ€: ',\n                                currentIP: 'å½“å‰ä½¿ç”¨IP: ',\n                                regionMatch: 'åœ°åŒºåŒ¹é…: ',\n                                detectionFailed: 'æ£€æµ‹å¤±è´¥'\n                            },\n                            fa: {\n                                workerRegion: 'Ù…Ù†Ø·Ù‚Ù‡ Worker: ',\n                                detectionMethod: 'Ø±ÙˆØ´ ØªØ´Ø®ÛŒØµ: ',\n                                proxyIPStatus: 'ÙˆØ¶Ø¹ÛŒØª ProxyIP: ',\n                                currentIP: 'IP ÙØ¹Ù„ÛŒ: ',\n                                regionMatch: 'ØªØ·Ø¨ÛŒÙ‚ Ù…Ù†Ø·Ù‚Ù‡: ',\n                                detectionFailed: 'ØªØ´Ø®ÛŒØµ Ù†Ø§Ù…ÙˆÙÙ‚'\n                            }\n                        };\n                        \n                        const t = translations[isFarsi ? 'fa' : 'zh'];\n                        \n                        document.getElementById('regionStatus').innerHTML = t.workerRegion + '<span style="color: #ff4444;">âŒ ' + t.detectionFailed + '</span>';\n                        document.getElementById('geoInfo').innerHTML = t.detectionMethod + '<span style="color: #ff4444;">âŒ ' + t.detectionFailed + '</span>';\n                        document.getElementById('backupStatus').innerHTML = t.proxyIPStatus + '<span style="color: #ff4444;">âŒ ' + t.detectionFailed + '</span>';\n                        document.getElementById('currentIP').innerHTML = t.currentIP + '<span style="color: #ff4444;">âŒ ' + t.detectionFailed + '</span>';\n                        document.getElementById('regionMatch').innerHTML = t.regionMatch + '<span style="color: #ff4444;">âŒ ' + t.detectionFailed + '</span>';\n                }\n            }\n            \n                async function testAPI() {\n                    try {\n                        function getCookie(name) {\n                            const value = '; ' + document.cookie;\n                            const parts = value.split('; ' + name + '=');\n                            if (parts.length === 2) return parts.pop().split(';').shift();\n                            return null;\n                        }\n                        \n                        const browserLang = navigator.language || navigator.userLanguage || '';\n                        const savedLang = localStorage.getItem('preferredLanguage') || getCookie('preferredLanguage');\n                        let isFarsi = false;\n                        \n                        if (savedLang === 'fa' || savedLang === 'fa-IR') {\n                            isFarsi = true;\n                        } else {\n                            isFarsi = browserLang.includes('fa') || browserLang.includes('fa-IR');\n                        }\n                        \n                        const translations = {\n                            zh: {\n                                apiTestResult: 'APIæ£€æµ‹ç»“æœ: ',\n                                apiTestTime: 'æ£€æµ‹æ—¶é—´: ',\n                                apiTestFailed: 'APIæ£€æµ‹å¤±è´¥: ',\n                                unknownError: 'æœªçŸ¥é”™è¯¯',\n                                apiTestError: 'APIæµ‹è¯•å¤±è´¥: '\n                            },\n                            fa: {\n                                apiTestResult: 'Ù†ØªÛŒØ¬Ù‡ ØªØ´Ø®ÛŒØµ API: ',\n                                apiTestTime: 'Ø²Ù…Ø§Ù† ØªØ´Ø®ÛŒØµ: ',\n                                apiTestFailed: 'ØªØ´Ø®ÛŒØµ API Ù†Ø§Ù…ÙˆÙÙ‚: ',\n                                unknownError: 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡',\n                                apiTestError: 'ØªØ³Øª API Ù†Ø§Ù…ÙˆÙÙ‚: '\n                            }\n                        };\n                        \n                        const t = translations[isFarsi ? 'fa' : 'zh'];\n                        \n                    const response = await fetch(window.location.pathname + '/test-api');\n                    const data = await response.json();\n                    \n                    if (data.detectedRegion) {\n                            alert(t.apiTestResult + data.detectedRegion + '\\n' + t.apiTestTime + data.timestamp);\n                    } else {\n                            alert(t.apiTestFailed + (data.error || t.unknownError));\n                    }\n                } catch (error) {\n                        function getCookie(name) {\n                            const value = '; ' + document.cookie;\n                            const parts = value.split('; ' + name + '=');\n                            if (parts.length === 2) return parts.pop().split(';').shift();\n                            return null;\n                        }\n                        \n                        const browserLang = navigator.language || navigator.userLanguage || '';\n                        const savedLang = localStorage.getItem('preferredLanguage') || getCookie('preferredLanguage');\n                        let isFarsi = false;\n                        \n                        if (savedLang === 'fa' || savedLang === 'fa-IR') {\n                            isFarsi = true;\n                        } else {\n                            isFarsi = browserLang.includes('fa') || browserLang.includes('fa-IR');\n                        }\n                        \n                        const translations = {\n                            zh: { apiTestError: 'APIæµ‹è¯•å¤±è´¥: ' },\n                            fa: { apiTestError: 'ØªØ³Øª API Ù†Ø§Ù…ÙˆÙÙ‚: ' }\n                        };\n                        \n                        const t = translations[isFarsi ? 'fa' : 'zh'];\n                        alert(t.apiTestError + error.message);\n                }\n            }\n            \n            // é…ç½®ç®¡ç†ç›¸å…³å‡½æ•°\n            async function checkKVStatus() {\n                const apiUrl = window.location.pathname + '/api/config';\n                \n                try {\n                    const response = await fetch(apiUrl);\n                    \n                        function getCookie(name) {\n                            const value = '; ' + document.cookie;\n                            const parts = value.split('; ' + name + '=');\n                            if (parts.length === 2) return parts.pop().split(';').shift();\n                            return null;\n                        }\n                        \n                        const browserLang = navigator.language || navigator.userLanguage || '';\n                        const savedLang = localStorage.getItem('preferredLanguage') || getCookie('preferredLanguage');\n                        let isFarsi = false;\n                        \n                        if (savedLang === 'fa' || savedLang === 'fa-IR') {\n                            isFarsi = true;\n                        } else {\n                            isFarsi = browserLang.includes('fa') || browserLang.includes('fa-IR');\n                        }\n                        \n                        const translations = {\n                            zh: {\n                                kvDisabled: 'âš ï¸ KVå­˜å‚¨æœªå¯ç”¨æˆ–æœªé…ç½®',\n                                kvNotConfigured: 'KVå­˜å‚¨æœªé…ç½®ï¼Œæ— æ³•ä½¿ç”¨é…ç½®ç®¡ç†åŠŸèƒ½ã€‚\\n\\nè¯·åœ¨Cloudflare Workersä¸­:\\n1. åˆ›å»ºKVå‘½åç©ºé—´\\n2. ç»‘å®šç¯å¢ƒå˜é‡ C\\n3. é‡æ–°éƒ¨ç½²ä»£ç ',\n                                kvNotEnabled: 'KVå­˜å‚¨æœªé…ç½®',\n                                kvEnabled: 'âœ… KVå­˜å‚¨å·²å¯ç”¨ï¼Œå¯ä»¥ä½¿ç”¨é…ç½®ç®¡ç†åŠŸèƒ½',\n                                kvCheckFailed: 'âš ï¸ KVå­˜å‚¨æ£€æµ‹å¤±è´¥',\n                                kvCheckFailedFormat: 'KVå­˜å‚¨æ£€æµ‹å¤±è´¥: å“åº”æ ¼å¼é”™è¯¯',\n                                kvCheckFailedStatus: 'KVå­˜å‚¨æ£€æµ‹å¤±è´¥ - çŠ¶æ€ç : ',\n                                kvCheckFailedError: 'KVå­˜å‚¨æ£€æµ‹å¤±è´¥ - é”™è¯¯: '\n                            },\n                            fa: {\n                                kvDisabled: 'âš ï¸ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV ÙØ¹Ø§Ù„ Ù†ÛŒØ³Øª ÛŒØ§ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª',\n                                kvNotConfigured: 'Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³ØªØŒ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù…Ø¯ÛŒØ±ÛŒØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.\\n\\nÙ„Ø·ÙØ§ Ø¯Ø± Cloudflare Workers:\\n1. ÙØ¶Ø§ÛŒ Ù†Ø§Ù… KV Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†ÛŒØ¯\\n2. Ù…ØªØºÛŒØ± Ù…Ø­ÛŒØ·ÛŒ C Ø±Ø§ Ù¾ÛŒÙˆÙ†Ø¯ Ø¯Ù‡ÛŒØ¯\\n3. Ú©Ø¯ Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù…Ø³ØªÙ‚Ø± Ú©Ù†ÛŒØ¯',\n                                kvNotEnabled: 'Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª',\n                                kvEnabled: 'âœ… Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV ÙØ¹Ø§Ù„ Ø§Ø³ØªØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ù…Ø¯ÛŒØ±ÛŒØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯',\n                                kvCheckFailed: 'âš ï¸ Ø¨Ø±Ø±Ø³ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV Ù†Ø§Ù…ÙˆÙÙ‚',\n                                kvCheckFailedFormat: 'Ø¨Ø±Ø±Ø³ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV Ù†Ø§Ù…ÙˆÙÙ‚: Ø®Ø·Ø§ÛŒ ÙØ±Ù…Øª Ù¾Ø§Ø³Ø®',\n                                kvCheckFailedStatus: 'Ø¨Ø±Ø±Ø³ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV Ù†Ø§Ù…ÙˆÙÙ‚ - Ú©Ø¯ ÙˆØ¶Ø¹ÛŒØª: ',\n                                kvCheckFailedError: 'Ø¨Ø±Ø±Ø³ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV Ù†Ø§Ù…ÙˆÙÙ‚ - Ø®Ø·Ø§: '\n                            }\n                        };\n                        \n                        const t = translations[isFarsi ? 'fa' : 'zh'];\n                        \n                        if (response.status === 503) {\n                            // KVæœªé…ç½®\n                            document.getElementById('kvStatus').innerHTML = '<span style="color: #ffaa00;">' + t.kvDisabled + '</span>';\n                            document.getElementById('configCard').style.display = 'block';\n                            document.getElementById('currentConfig').textContent = t.kvNotConfigured;\n                    } else if (response.ok) {\n                        try {\n                        const data = await response.json();\n                        \n                            // æ£€æŸ¥å“åº”æ˜¯å¦åŒ…å«KVé…ç½®ä¿¡æ¯\n                            if (data && data.kvEnabled === true) {\n                                document.getElementById('kvStatus').innerHTML = '<span style="color: #44ff44;">' + t.kvEnabled + '</span>';\n                                document.getElementById('configContent').style.display = 'block';\n                                document.getElementById('configCard').style.display = 'block';\n                                await loadCurrentConfig();\n                            } else {\n                                document.getElementById('kvStatus').innerHTML = '<span style="color: #ffaa00;">' + t.kvDisabled + '</span>';\n                                document.getElementById('configCard').style.display = 'block';\n                                document.getElementById('currentConfig').textContent = t.kvNotEnabled;\n                                }\n                        } catch (jsonError) {\n                            document.getElementById('kvStatus').innerHTML = '<span style="color: #ffaa00;">' + t.kvCheckFailed + '</span>';\n                            document.getElementById('configCard').style.display = 'block';\n                            document.getElementById('currentConfig').textContent = t.kvCheckFailedFormat;\n                        }\n                    } else {\n                        document.getElementById('kvStatus').innerHTML = '<span style="color: #ffaa00;">' + t.kvDisabled + '</span>';\n                        document.getElementById('configCard').style.display = 'block';\n                        document.getElementById('currentConfig').textContent = t.kvCheckFailedStatus + response.status;\n                    }\n                } catch (error) {\n                    function getCookie(name) {\n                        const value = '; ' + document.cookie;\n                        const parts = value.split('; ' + name + '=');\n                        if (parts.length === 2) return parts.pop().split(';').shift();\n                        return null;\n                    }\n                    \n                    const browserLang = navigator.language || navigator.userLanguage || '';\n                    const savedLang = localStorage.getItem('preferredLanguage') || getCookie('preferredLanguage');\n                    let isFarsi = false;\n                    \n                    if (savedLang === 'fa' || savedLang === 'fa-IR') {\n                        isFarsi = true;\n                    } else {\n                        isFarsi = browserLang.includes('fa') || browserLang.includes('fa-IR');\n                    }\n                    \n                    const translations = {\n                        zh: {\n                            kvDisabled: 'âš ï¸ KVå­˜å‚¨æœªå¯ç”¨æˆ–æœªé…ç½®',\n                            kvCheckFailedError: 'KVå­˜å‚¨æ£€æµ‹å¤±è´¥ - é”™è¯¯: '\n                        },\n                        fa: {\n                            kvDisabled: 'âš ï¸ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV ÙØ¹Ø§Ù„ Ù†ÛŒØ³Øª ÛŒØ§ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª',\n                            kvCheckFailedError: 'Ø¨Ø±Ø±Ø³ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ KV Ù†Ø§Ù…ÙˆÙÙ‚ - Ø®Ø·Ø§: '\n                        }\n                    };\n                    \n                    const t = translations[isFarsi ? 'fa' : 'zh'];\n                    \n                    document.getElementById('kvStatus').innerHTML = '<span style="color: #ffaa00;">' + t.kvDisabled + '</span>';\n                    document.getElementById('configCard').style.display = 'block';\n                    document.getElementById('currentConfig').textContent = t.kvCheckFailedError + error.message;\n                }\n            }\n            \n            async function loadCurrentConfig() {\n                const apiUrl = window.location.pathname + '/api/config';\n                \n                try {\n                    const response = await fetch(apiUrl);\n                    \n                    if (response.status === 503) {\n                        document.getElementById('currentConfig').textContent = 'KVå­˜å‚¨æœªé…ç½®ï¼Œæ— æ³•åŠ è½½é…ç½®';\n                        return;\n                    }\n                    if (!response.ok) {\n                        const errorText = await response.text();\n                        document.getElementById('currentConfig').textContent = 'åŠ è½½é…ç½®å¤±è´¥: ' + errorText;\n                        return;\n                    }\n                    const config = await response.json();\n                    \n                    // è¿‡æ»¤æ‰å†…éƒ¨å­—æ®µ kvEnabled\n                    const displayConfig = {};\n                    for (const [key, value] of Object.entries(config)) {\n                        if (key !== 'kvEnabled') {\n                            displayConfig[key] = value;\n                        }\n                    }\n                    \n                    let configText = 'å½“å‰é…ç½®:\\n';\n                    if (Object.keys(displayConfig).length === 0) {\n                        configText += '(æš‚æ— é…ç½®)';\n                    } else {\n                        for (const [key, value] of Object.entries(displayConfig)) {\n                            configText += key + ': ' + (value || '(æœªè®¾ç½®)') + '\\n';\n                        }\n                    }\n                    \n                    document.getElementById('currentConfig').textContent = configText;\n                    \n                    // æ›´æ–°è¡¨å•å€¼\n                    document.getElementById('wkRegion').value = config.wk || '';\n                    document.getElementById('ev').checked = config.ev !== 'no';\n                    document.getElementById('et').checked = config.et === 'yes';\n                    document.getElementById('ex').checked = config.ex === 'yes';\n                    document.getElementById('ech').checked = config.ech === 'yes';\n                    document.getElementById('tp').value = config.tp || '';\n                    if (document.getElementById('customDNS')) {\n                        document.getElementById('customDNS').value = config.customDNS || '';\n                    }\n                    if (document.getElementById('customECHDomain')) {\n                        document.getElementById('customECHDomain').value = config.customECHDomain || '';\n                    }\n                    document.getElementById('scu').value = config.scu || '';\n                    document.getElementById('epd').checked = config.epd !== 'no';\n                    document.getElementById('epi').checked = config.epi !== 'no';\n                    document.getElementById('egi').checked = config.egi !== 'no';\n                    if (document.getElementById('ipv4Enabled')) document.getElementById('ipv4Enabled').checked = config.ipv4 !== 'no';\n                    if (document.getElementById('ipv6Enabled')) document.getElementById('ipv6Enabled').checked = config.ipv6 !== 'no';\n                    if (document.getElementById('ispMobile')) document.getElementById('ispMobile').checked = config.ispMobile !== 'no';\n                    if (document.getElementById('ispUnicom')) document.getElementById('ispUnicom').checked = config.ispUnicom !== 'no';\n                    if (document.getElementById('ispTelecom')) document.getElementById('ispTelecom').checked = config.ispTelecom !== 'no';\n                    document.getElementById('customPath').value = config.d || '';\n                    document.getElementById('customIP').value = config.p || '';\n                    document.getElementById('yx').value = config.yx || '';\n                    document.getElementById('yxURL').value = config.yxURL || '';\n                    document.getElementById('socksConfig').value = config.s || '';\n                    document.getElementById('customHomepage').value = config.homepage || '';\n                    document.getElementById('apiEnabled').value = config.ae || '';\n                    document.getElementById('regionMatching').value = config.rm || '';\n                    document.getElementById('downgradeControl').value = config.qj || '';\n                    document.getElementById('portControl').value = config.dkby || '';\n                    document.getElementById('preferredControl').value = config.yxby || '';\n                    \n                    // æ›´æ–°è·¯å¾„ç±»å‹æ˜¾ç¤º\n                    updatePathTypeStatus(config.d);\n                    \n                    // æ£€æŸ¥på˜é‡ï¼Œå¦‚æœæœ‰å€¼åˆ™ç¦ç”¨wkåœ°åŒºé€‰æ‹©\n                    updateWkRegionState();\n                    \n                } catch (error) {\n                    document.getElementById('currentConfig').textContent = 'åŠ è½½é…ç½®å¤±è´¥: ' + error.message;\n                }\n            }\n            \n            // æ›´æ–°è·¯å¾„ç±»å‹æ˜¾ç¤º\n            function updatePathTypeStatus(cp) {\n                const pathTypeStatus = document.getElementById('pathTypeStatus');\n                const currentUrl = window.location.href;\n                const pathParts = window.location.pathname.split('/').filter(p => p);\n                const currentPath = pathParts.length > 0 ? pathParts[0] : '';\n                \n                if (cp && cp.trim()) {\n                    // ä½¿ç”¨è‡ªå®šä¹‰è·¯å¾„ (d)\n                    pathTypeStatus.innerHTML = '<div style="color: #44ff44;">ä½¿ç”¨ç±»å‹: <strong>è‡ªå®šä¹‰è·¯å¾„ (d)</strong></div>' +\n                        '<div style="margin-top: 5px; color: #00ff00;">å½“å‰è·¯å¾„: <span style="color: #ffaa00;">' + cp + '</span></div>' +\n                        '<div style="margin-top: 5px; font-size: 0.9rem; color: #00aa00;">è®¿é—®åœ°å€: ' + \n                        (currentUrl.split('/')[0] + '//' + currentUrl.split('/')[2]) + cp + '/sub</div>';\n                } else {\n                    // ä½¿ç”¨ UUID (u)\n                    pathTypeStatus.innerHTML = '<div style="color: #44ff44;">ä½¿ç”¨ç±»å‹: <strong>UUID è·¯å¾„ (u)</strong></div>' +\n                        '<div style="margin-top: 5px; color: #00ff00;">å½“å‰è·¯å¾„: <span style="color: #ffaa00;">' + (currentPath || '(UUID)') + '</span></div>' +\n                        '<div style="margin-top: 5px; font-size: 0.9rem; color: #00aa00;">è®¿é—®åœ°å€: ' + currentUrl.split('/sub')[0] + '/sub</div>';\n                }\n            }\n            \n            // æ›´æ–°wkåœ°åŒºé€‰æ‹©çš„å¯ç”¨/ç¦ç”¨çŠ¶æ€\n            function updateWkRegionState() {\n                const customIPInput = document.getElementById('customIP');\n                const wkRegion = document.getElementById('wkRegion');\n                const wkRegionHint = document.getElementById('wkRegionHint');\n                \n                if (customIPInput && wkRegion) {\n                    const hasCustomIP = customIPInput.value.trim() !== '';\n                    wkRegion.disabled = hasCustomIP;\n                    \n                    // æ·»åŠ è§†è§‰åé¦ˆ\n                    if (hasCustomIP) {\n                        wkRegion.style.opacity = '0.5';\n                        wkRegion.style.cursor = 'not-allowed';\n                        wkRegion.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';\n                        // æ˜¾ç¤ºæç¤ºä¿¡æ¯\n                        if (wkRegionHint) {\n                            wkRegionHint.style.display = 'block';\n                            wkRegionHint.style.color = '#ffaa00';\n                        }\n                    } else {\n                        wkRegion.style.opacity = '1';\n                        wkRegion.style.cursor = 'pointer';\n                        wkRegion.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';\n                        // éšè—æç¤ºä¿¡æ¯\n                        if (wkRegionHint) {\n                            wkRegionHint.style.display = 'none';\n                        }\n                    }\n                }\n            }\n            \n            async function saveConfig(configData) {\n                const apiUrl = window.location.pathname + '/api/config';\n                \n                try {\n                    const response = await fetch(apiUrl, {\n                        method: 'POST',\n                        headers: { 'Content-Type': 'application/json' },\n                        body: JSON.stringify(configData)\n                    });\n                    \n                    \n                    if (response.status === 503) {\n                        showStatus('KVå­˜å‚¨æœªé…ç½®ï¼Œæ— æ³•ä¿å­˜é…ç½®ã€‚è¯·å…ˆåœ¨Cloudflare Workersä¸­é…ç½®KVå­˜å‚¨ã€‚', 'error');\n                        return;\n                    }\n                    \n                    if (!response.ok) {\n                        const errorText = await response.text();\n                        \n                        // å°è¯•è§£æ JSON é”™è¯¯ä¿¡æ¯\n                        try {\n                            const errorData = JSON.parse(errorText);\n                            showStatus(errorData.message || 'ä¿å­˜å¤±è´¥', 'error');\n                        } catch (parseError) {\n                            // å¦‚æœä¸æ˜¯ JSONï¼Œç›´æ¥æ˜¾ç¤ºæ–‡æœ¬\n                            showStatus('ä¿å­˜å¤±è´¥: ' + errorText, 'error');\n                        }\n                        return;\n                    }\n                    \n                    const result = await response.json();\n                    \n                    showStatus(result.message, result.success ? 'success' : 'error');\n                    \n                    if (result.success) {\n                        await loadCurrentConfig();\n                        // æ›´æ–°wkåœ°åŒºé€‰æ‹©çŠ¶æ€\n                        updateWkRegionState();\n                        // ä¿å­˜æˆåŠŸååˆ·æ–°é¡µé¢ä»¥æ›´æ–°ç³»ç»ŸçŠ¶æ€\n                        setTimeout(function() {\n                            window.location.reload();\n                        }, 1500);\n                    } else {\n                    }\n                } catch (error) {\n                    showStatus('ä¿å­˜å¤±è´¥: ' + error.message, 'error');\n                }\n            }\n            \n            function showStatus(message, type) {\n                const statusDiv = document.getElementById('statusMessage');\n                statusDiv.textContent = message;\n                statusDiv.style.display = 'block';\n                statusDiv.style.color = type === 'success' ? '#00ff00' : '#ff0000';\n                statusDiv.style.borderColor = type === 'success' ? '#00ff00' : '#ff0000';\n                \n                setTimeout(function() {\n                    statusDiv.style.display = 'none';\n                }, 3000);\n            }\n            \n            async function resetAllConfig() {\n                if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰é…ç½®å—ï¼Ÿè¿™å°†æ¸…ç©ºæ‰€æœ‰KVé…ç½®ï¼Œæ¢å¤ä¸ºç¯å¢ƒå˜é‡è®¾ç½®ã€‚')) {\n                    try {\n                        const response = await fetch(window.location.pathname + '/api/config', {\n                            method: 'POST',\n                            headers: { 'Content-Type': 'application/json' },\n                            body: JSON.stringify({ \n                                wk: '',\n                                d: '',\n                                p: '',\n                                yx: '',\n                                yxURL: '',\n                                s: '', ae: '',\n                                rm: '',\n                                qj: '',\n                                dkby: '',\n                                yxby: '', ev: '', et: '', ex: '', tp: '', scu: '', epd: '', epi: '', egi: '',\n                                ipv4: '', ipv6: '', ispMobile: '', ispUnicom: '', ispTelecom: '',\n                                homepage: ''\n                            })\n                        });\n                        \n                        if (response.status === 503) {\n                            showStatus('KVå­˜å‚¨æœªé…ç½®ï¼Œæ— æ³•é‡ç½®é…ç½®ã€‚', 'error');\n                            return;\n                        }\n                        \n                        if (!response.ok) {\n                            const errorText = await response.text();\n                            \n                            // å°è¯•è§£æ JSON é”™è¯¯ä¿¡æ¯\n                            try {\n                                const errorData = JSON.parse(errorText);\n                                showStatus(errorData.message || 'é‡ç½®å¤±è´¥', 'error');\n                            } catch (parseError) {\n                                // å¦‚æœä¸æ˜¯ JSONï¼Œç›´æ¥æ˜¾ç¤ºæ–‡æœ¬\n                                showStatus('é‡ç½®å¤±è´¥: ' + errorText, 'error');\n                            }\n                            return;\n                        }\n                        \n                        const result = await response.json();\n                        showStatus(result.message || 'é…ç½®å·²é‡ç½®', result.success ? 'success' : 'error');\n                        \n                        if (result.success) {\n                            await loadCurrentConfig();\n                            // æ›´æ–°wkåœ°åŒºé€‰æ‹©çŠ¶æ€\n                            updateWkRegionState();\n                            // åˆ·æ–°é¡µé¢ä»¥æ›´æ–°ç³»ç»ŸçŠ¶æ€\n                            setTimeout(function() {\n                                window.location.reload();\n                            }, 1500);\n                        }\n                    } catch (error) {\n                        showStatus('é‡ç½®å¤±è´¥: ' + error.message, 'error');\n                    }\n                }\n            }\n            \n            async function checkECHStatus() {\n                const echStatusEl = document.getElementById('echStatus');\n                \n                if (!echStatusEl) return;\n                \n                try {\n                    const currentUrl = window.location.href;\n                    const subscriptionUrl = currentUrl + '/sub';\n                    \n                    echStatusEl.innerHTML = 'ECHçŠ¶æ€: <span style="color: #ffaa00;">æ£€æµ‹ä¸­...</span>';\n                    \n                    const response = await fetch(subscriptionUrl, {\n                        method: 'GET',\n                        headers: {\n                            'Accept': 'text/plain'\n                        }\n                    });\n                    \n                    const echStatusHeader = response.headers.get('X-ECH-Status');\n                    const echConfigLength = response.headers.get('X-ECH-Config-Length');\n                    \n                    if (echStatusHeader === 'ENABLED') {\n                        echStatusEl.innerHTML = 'ECHçŠ¶æ€: <span style="color: #44ff44;">âœ… å·²å¯ç”¨' + (echConfigLength ? ' (é…ç½®é•¿åº¦: ' + echConfigLength + ')' : '') + '</span>';\n                    } else {\n                        echStatusEl.innerHTML = 'ECHçŠ¶æ€: <span style="color: #ffaa00;">âš ï¸ æœªå¯ç”¨</span>';\n                    }\n                } catch (error) {\n                    echStatusEl.innerHTML = 'ECHçŠ¶æ€: <span style="color: #ff4444;">âŒ æ£€æµ‹å¤±è´¥: ' + error.message + '</span>';\n                }\n            }\n            \n            document.addEventListener('DOMContentLoaded', function() {\n                createMatrixRain();\n                checkSystemStatus();\n                checkKVStatus();\n                checkECHStatus();\n                \n                // ECH å¼€å¯æ—¶è‡ªåŠ¨è”åŠ¨å¼€å¯ä»…TLS\n                const echCheckbox = document.getElementById('ech');\n                const portControl = document.getElementById('portControl');\n                if (echCheckbox && portControl) {\n                    echCheckbox.addEventListener('change', function() {\n                        if (this.checked) {\n                            // ECH å¼€å¯æ—¶ï¼Œè‡ªåŠ¨è®¾ç½®ä»…TLSä¸º yes\n                            portControl.value = 'yes';\n                        }\n                    });\n                    \n                    // é¡µé¢åŠ è½½æ—¶ï¼Œå¦‚æœ ECH å·²å‹¾é€‰ï¼Œä¹Ÿè‡ªåŠ¨è®¾ç½®ä»…TLS\n                    if (echCheckbox.checked) {\n                        portControl.value = 'yes';\n                    }\n                }\n                \n                // ç›‘å¬customIPè¾“å…¥æ¡†å˜åŒ–ï¼Œå®æ—¶æ›´æ–°wkåœ°åŒºé€‰æ‹©çŠ¶æ€\n                const customIPInput = document.getElementById('customIP');\n                if (customIPInput) {\n                    customIPInput.addEventListener('input', function() {\n                        updateWkRegionState();\n                    });\n                }\n                \n                // ç»‘å®šè¡¨å•äº‹ä»¶\n                const regionForm = document.getElementById('regionForm');\n                if (regionForm) {\n                    regionForm.addEventListener('submit', async function(e) {\n                        e.preventDefault();\n                        const wkRegion = document.getElementById('wkRegion').value;\n                        await saveConfig({ wk: wkRegion });\n                    });\n                }\n                \n                const saveProtocolBtn = document.getElementById('saveProtocolBtn');\n                if (saveProtocolBtn) {\n                    saveProtocolBtn.addEventListener('click', async function(e) {\n                        e.preventDefault();\n                        const configData = { \n                            ev: document.getElementById('ev').checked ? 'yes' : 'no', \n                            et: document.getElementById('et').checked ? 'yes' : 'no', \n                            ex: document.getElementById('ex').checked ? 'yes' : 'no', \n                            ech: document.getElementById('ech').checked ? 'yes' : 'no',\n                            tp: document.getElementById('tp').value,\n                            customDNS: document.getElementById('customDNS').value,\n                            customECHDomain: document.getElementById('customECHDomain').value\n                        };\n                        \n                        if (!document.getElementById('ev').checked && \n                            !document.getElementById('et').checked && \n                            !document.getElementById('ex').checked) {\n                            alert('è‡³å°‘éœ€è¦å¯ç”¨ä¸€ä¸ªåè®®ï¼');\n                            return;\n                        }\n                        \n                        await saveConfig(configData);\n                    });\n                }\n                \n                const otherConfigForm = document.getElementById('otherConfigForm');\n                if (otherConfigForm) {\n                    otherConfigForm.addEventListener('submit', async function(e) {\n                        e.preventDefault();\n                        const configData = { ev: document.getElementById('ev').checked ? 'yes' : 'no', et: document.getElementById('et').checked ? 'yes' : 'no', ex: document.getElementById('ex').checked ? 'yes' : 'no', ech: document.getElementById('ech').checked ? 'yes' : 'no', tp: document.getElementById('tp').value,\n                            d: document.getElementById('customPath').value,\n                            p: document.getElementById('customIP').value,\n                            yx: document.getElementById('yx').value,\n                            yxURL: document.getElementById('yxURL').value,\n                            s: document.getElementById('socksConfig').value,\n                            homepage: document.getElementById('customHomepage').value,\n                            customDNS: document.getElementById('customDNS').value,\n                            customECHDomain: document.getElementById('customECHDomain').value\n                        };\n                        \n                        // ç¡®ä¿è‡³å°‘é€‰æ‹©ä¸€ä¸ªåè®®\n                        if (!document.getElementById('ev').checked && \n                            !document.getElementById('et').checked && \n                            !document.getElementById('ex').checked) {\n                            alert('è‡³å°‘éœ€è¦å¯ç”¨ä¸€ä¸ªåè®®ï¼');\n                            return;\n                        }\n                        \n                        await saveConfig(configData);\n                    });\n                }\n                \n                const advancedConfigForm = document.getElementById('advancedConfigForm');\n                if (advancedConfigForm) {\n                    advancedConfigForm.addEventListener('submit', async function(e) {\n                        e.preventDefault();\n                        const configData = { scu: document.getElementById('scu').value, epd: document.getElementById('epd').checked ? 'yes' : 'no', epi: document.getElementById('epi').checked ? 'yes' : 'no', egi: document.getElementById('egi').checked ? 'yes' : 'no', ae: document.getElementById('apiEnabled').value,\n                            rm: document.getElementById('regionMatching').value,\n                            qj: document.getElementById('downgradeControl').value,\n                            dkby: document.getElementById('portControl').value,\n                            yxby: document.getElementById('preferredControl').value,\n                            ipv4: document.getElementById('ipv4Enabled').checked ? 'yes' : 'no',\n                            ipv6: document.getElementById('ipv6Enabled').checked ? 'yes' : 'no',\n                            ispMobile: document.getElementById('ispMobile').checked ? 'yes' : 'no',\n                            ispUnicom: document.getElementById('ispUnicom').checked ? 'yes' : 'no',\n                            ispTelecom: document.getElementById('ispTelecom').checked ? 'yes' : 'no'\n                        };\n                        await saveConfig(configData);\n                    });\n                }\n                \n                let testAbortController = null;\n                let testResults = [];\n                \n                const startTestBtn = document.getElementById('startLatencyTest');\n                const stopTestBtn = document.getElementById('stopLatencyTest');\n                const testStatus = document.getElementById('latencyTestStatus');\n                const testResultsDiv = document.getElementById('latencyTestResults');\n                const resultsList = document.getElementById('latencyResultsList');\n                const overwriteSelectedBtn = document.getElementById('overwriteSelectedToYx');\n                const appendSelectedBtn = document.getElementById('appendSelectedToYx');\n                const selectAllBtn = document.getElementById('selectAllResults');\n                const deselectAllBtn = document.getElementById('deselectAllResults');\n                const ipSourceSelect = document.getElementById('ipSourceSelect');\n                const manualInputDiv = document.getElementById('manualInputDiv');\n                const urlFetchDiv = document.getElementById('urlFetchDiv');\n                const latencyTestInput = document.getElementById('latencyTestInput');\n                const fetchURLInput = document.getElementById('fetchURLInput');\n                const latencyTestPort = document.getElementById('latencyTestPort');\n                const randomIPCount = document.getElementById('randomIPCount');\n                const cfRandomDiv = document.getElementById('cfRandomDiv');\n                const randomCountDiv = document.getElementById('randomCountDiv');\n                const generateCFIPBtn = document.getElementById('generateCFIPBtn');\n                const fetchIPBtn = document.getElementById('fetchIPBtn');\n                \n                if (latencyTestInput) {\n                    const savedTestInput = localStorage.getItem('latencyTestInput');\n                    if (savedTestInput) latencyTestInput.value = savedTestInput;\n                    latencyTestInput.addEventListener('input', function() {\n                        localStorage.setItem('latencyTestInput', this.value);\n                    });\n                }\n                if (fetchURLInput) {\n                    const savedFetchURL = localStorage.getItem('fetchURLInput');\n                    if (savedFetchURL) fetchURLInput.value = savedFetchURL;\n                    fetchURLInput.addEventListener('input', function() {\n                        localStorage.setItem('fetchURLInput', this.value);\n                    });\n                }\n                if (latencyTestPort) {\n                    const savedPort = localStorage.getItem('latencyTestPort');\n                    if (savedPort) latencyTestPort.value = savedPort;\n                    latencyTestPort.addEventListener('input', function() {\n                        localStorage.setItem('latencyTestPort', this.value);\n                    });\n                }\n                if (randomIPCount) {\n                    const savedCount = localStorage.getItem('randomIPCount');\n                    if (savedCount) randomIPCount.value = savedCount;\n                    randomIPCount.addEventListener('input', function() {\n                        localStorage.setItem('randomIPCount', this.value);\n                    });\n                    // åˆå§‹åŒ–æ—¶ï¼Œå¦‚æœé»˜è®¤æ˜¯éšè—çš„ï¼Œåˆ™ç¦ç”¨è¾“å…¥æ¡†\n                    if (randomCountDiv && randomCountDiv.style.display === 'none') {\n                        randomIPCount.disabled = true;\n                    }\n                }\n                const testThreadsInput = document.getElementById('testThreads');\n                if (testThreadsInput) {\n                    const savedThreads = localStorage.getItem('testThreads');\n                    if (savedThreads) testThreadsInput.value = savedThreads;\n                    testThreadsInput.addEventListener('input', function() {\n                        localStorage.setItem('testThreads', this.value);\n                    });\n                }\n                if (ipSourceSelect) {\n                    const savedSource = localStorage.getItem('ipSourceSelect');\n                    const currentSource = savedSource || ipSourceSelect.value || 'manual';\n                    if (savedSource) {\n                        ipSourceSelect.value = savedSource;\n                    }\n                    manualInputDiv.style.display = currentSource === 'manual' ? 'block' : 'none';\n                    urlFetchDiv.style.display = currentSource === 'urlFetch' ? 'block' : 'none';\n                    cfRandomDiv.style.display = currentSource === 'cfRandom' ? 'block' : 'none';\n                    randomCountDiv.style.display = currentSource === 'cfRandom' ? 'block' : 'none';\n                    // å½“éšè—æ—¶ç¦ç”¨è¾“å…¥æ¡†ï¼Œé¿å…è¡¨å•éªŒè¯é”™è¯¯\n                    if (randomIPCount) {\n                        randomIPCount.disabled = currentSource !== 'cfRandom';\n                    }\n                }\n                \n                const CF_CIDR_LIST = [\n                    '173.245.48.0/20', '103.21.244.0/22', '103.22.200.0/22', '103.31.4.0/22',\n                    '141.101.64.0/18', '108.162.192.0/18', '190.93.240.0/20', '188.114.96.0/20',\n                    '197.234.240.0/22', '198.41.128.0/17', '162.158.0.0/15', '104.16.0.0/13',\n                    '104.24.0.0/14', '172.64.0.0/13', '131.0.72.0/22'\n                ];\n                \n                function generateRandomIPFromCIDR(cidr) {\n                    const [baseIP, prefixLength] = cidr.split('/');\n                    const prefix = parseInt(prefixLength);\n                    const hostBits = 32 - prefix;\n                    const ipParts = baseIP.split('.').map(p => parseInt(p));\n                    const ipInt = (ipParts[0] << 24) | (ipParts[1] << 16) | (ipParts[2] << 8) | ipParts[3];\n                    const randomOffset = Math.floor(Math.random() * Math.pow(2, hostBits));\n                    const mask = (0xFFFFFFFF << hostBits) >>> 0;\n                    const randomIP = (((ipInt & mask) >>> 0) + randomOffset) >>> 0;\n                    return [(randomIP >>> 24) & 0xFF, (randomIP >>> 16) & 0xFF, (randomIP >>> 8) & 0xFF, randomIP & 0xFF].join('.');\n                }\n                \n                function generateCFRandomIPs(count, port) {\n                    const ips = [];\n                    for (let i = 0; i < count; i++) {\n                        const cidr = CF_CIDR_LIST[Math.floor(Math.random() * CF_CIDR_LIST.length)];\n                        const ip = generateRandomIPFromCIDR(cidr);\n                        ips.push(ip + ':' + port);\n                    }\n                    return ips;\n                }\n                \n                if (ipSourceSelect) {\n                    ipSourceSelect.addEventListener('change', function() {\n                        const value = this.value;\n                        localStorage.setItem('ipSourceSelect', value);\n                        manualInputDiv.style.display = value === 'manual' ? 'block' : 'none';\n                        urlFetchDiv.style.display = value === 'urlFetch' ? 'block' : 'none';\n                        cfRandomDiv.style.display = value === 'cfRandom' ? 'block' : 'none';\n                        randomCountDiv.style.display = value === 'cfRandom' ? 'block' : 'none';\n                        // å½“éšè—æ—¶ç¦ç”¨è¾“å…¥æ¡†ï¼Œé¿å…è¡¨å•éªŒè¯é”™è¯¯\n                        if (randomIPCount) {\n                            randomIPCount.disabled = value !== 'cfRandom';\n                        }\n                    });\n                }\n                \n                if (generateCFIPBtn) {\n                    generateCFIPBtn.addEventListener('click', function() {\n                        const count = parseInt(document.getElementById('randomIPCount').value) || 20;\n                        const port = document.getElementById('latencyTestPort').value || '443';\n                        const ips = generateCFRandomIPs(count, port);\n                        document.getElementById('latencyTestInput').value = ips.join(',');\n                        manualInputDiv.style.display = 'block';\n                        showStatus('${a?"ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯":"å·²ç”Ÿæˆ"} ' + count + ' ${a?"IP ØªØµØ§Ø¯ÙÛŒ CF":"ä¸ªCFéšæœºIP"}', 'success');\n                    });\n                }\n                \n                if (fetchIPBtn) {\n                    fetchIPBtn.addEventListener('click', async function() {\n                        const urlInput = document.getElementById('fetchURLInput');\n                        const fetchUrl = urlInput.value.trim();\n                        if (!fetchUrl) {\n                            alert('${a?"Ù„Ø·ÙØ§ URL Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯":"è¯·è¾“å…¥URL"}');\n                            return;\n                        }\n                        \n                        fetchIPBtn.disabled = true;\n                        fetchIPBtn.textContent = '${a?"Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª...":"è·å–ä¸­..."}';\n                        \n                        try {\n                            // æ”¯æŒå¤šä¸ª URLï¼ˆé€—å·åˆ†éš”ï¼‰ä»¥åŠè¿”å›å†…å®¹ä¸­é€—å·åˆ†éš”çš„å¤šä¸ª IP/èŠ‚ç‚¹\n                            const urlList = Array.from(new Set(\n                                fetchUrl.split(',').map(u => u.trim()).filter(u => u)\n                            ));\n                            \n                            const allItems = [];\n                            \n                            for (const u of urlList) {\n                                const response = await fetch(u);\n                                if (!response.ok) {\n                                    throw new Error('HTTP ' + response.status + ' @ ' + u);\n                                }\n                                const text = await response.text();\n                                \n                                // å…ˆæŒ‰è¡Œåˆ†å‰²ï¼Œå†åœ¨æ¯è¡Œå†…æŒ‰é€—å·åˆ†å‰²ï¼Œå…¼å®¹â€œå¤šè¡Œ + é€—å·åˆ†éš”â€ä¸¤ç§æ ¼å¼\n                                const perUrlItems = text\n                                    .split(/\\r?\\n/)\n                                    .map(l => l.trim())\n                                    .filter(l => l && !l.startsWith('#'))\n                                    .flatMap(l => l.split(',').map(p => p.trim()).filter(p => p));\n                                \n                                allItems.push(...perUrlItems);\n                            }\n                            \n                            if (allItems.length > 0) {\n                                document.getElementById('latencyTestInput').value = allItems.join(',');\n                                manualInputDiv.style.display = 'block';\n                                showStatus('${a?"Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯":"å·²è·å–"} ' + allItems.length + ' ${a?"IP":"ä¸ªIP"}', 'success');\n                            } else {\n                                showStatus('${a?"Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯":"æœªè·å–åˆ°æ•°æ®"}', 'error');\n                            }\n                        } catch (err) {\n                            showStatus('${a?"Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª":"è·å–å¤±è´¥"}: ' + err.message, 'error');\n                        } finally {\n                            fetchIPBtn.disabled = false;\n                            fetchIPBtn.textContent = 'â¬‡ ${a?"Ø¯Ø±ÛŒØ§ÙØª IP":"è·å–IP"}';\n                        }\n                    });\n                }\n                \n                if (startTestBtn) {\n                    startTestBtn.addEventListener('click', async function() {\n                        const inputField = document.getElementById('latencyTestInput');\n                        const portField = document.getElementById('latencyTestPort');\n                        const threadsField = document.getElementById('testThreads');\n                        const inputValue = inputField.value.trim();\n                        const defaultPort = portField.value || '443';\n                        const threads = parseInt(threadsField.value) || 5;\n                        \n                        if (!inputValue) {\n                            showStatus('${a?"Ù„Ø·ÙØ§ IP ÛŒØ§ Ø¯Ø§Ù…Ù†Ù‡ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯":"è¯·è¾“å…¥IPæˆ–åŸŸå"}', 'error');\n                            return;\n                        }\n                        \n                        const targets = inputValue.split(',').map(t => t.trim()).filter(t => t);\n                        if (targets.length === 0) return;\n                        \n                        startTestBtn.style.display = 'none';\n                        stopTestBtn.style.display = 'inline-block';\n                        testStatus.style.display = 'block';\n                        testResultsDiv.style.display = 'block';\n                        resultsList.innerHTML = '';\n                        testResults = [];\n                        if (cityFilterContainer) {\n                            cityFilterContainer.style.display = 'none';\n                        }\n                        \n                        testAbortController = new AbortController();\n                        \n                        let completed = 0;\n                        const total = targets.length;\n                        \n                        function parseTarget(target) {\n                            let host = target;\n                            let port = defaultPort;\n                            let nodeName = '';\n                            \n                            if (target.includes('#')) {\n                                const parts = target.split('#');\n                                nodeName = parts[1] || '';\n                                host = parts[0];\n                            }\n                            \n                            if (host.includes(':') && !host.startsWith('[')) {\n                                const lastColon = host.lastIndexOf(':');\n                                const possiblePort = host.substring(lastColon + 1);\n                                if (/^[0-9]+$/.test(possiblePort)) {\n                                    port = possiblePort;\n                                    host = host.substring(0, lastColon);\n                                }\n                            } else if (host.includes(']:')) {\n                                const parts = host.split(']:');\n                                host = parts[0] + ']';\n                                port = parts[1];\n                            }\n                            return { host, port, nodeName };\n                        }\n                        \n                        function renderResult(result, index, shouldShow = true) {\n                            // åªå±•ç¤ºåœ¨çº¿ä¼˜é€‰æˆåŠŸçš„ç»“æœï¼Œå¤±è´¥/è¶…æ—¶çš„ä¸å†æ˜¾ç¤º\n                            if (!result.success) {\n                                return null;\n                            }\n                            \n                            const resultItem = document.createElement('div');\n                            resultItem.style.cssText = 'display: flex; align-items: center; padding: 8px; border-bottom: 1px solid #003300; gap: 10px;';\n                            resultItem.dataset.index = index;\n                            resultItem.dataset.colo = result.colo || '';\n                            if (!shouldShow) {\n                                resultItem.style.display = 'none';\n                            }\n                            \n                            const checkbox = document.createElement('input');\n                            checkbox.type = 'checkbox';\n                            checkbox.checked = true;\n                            checkbox.disabled = false;\n                            checkbox.dataset.index = index;\n                            checkbox.style.cssText = 'width: 18px; height: 18px; cursor: pointer;';\n                            \n                            const info = document.createElement('div');\n                            info.style.cssText = 'flex: 1; font-family: monospace; font-size: 13px;';\n                            \n                            const coloName = result.colo ? getColoName(result.colo) : '';\n                            const coloDisplay = coloName ? ' <span style="color: #00aaff;">[' + coloName + ']</span>' : '';\n                            info.innerHTML = '<span style="color: #00ff00;">' + result.host + ':' + result.port + '</span>' + coloDisplay + ' <span style="color: #ffff00;">' + result.latency + 'ms</span>';\n                            \n                            resultItem.appendChild(checkbox);\n                            resultItem.appendChild(info);\n                            resultsList.appendChild(resultItem);\n                            return resultItem;\n                        }\n                        \n                        async function testOne(target) {\n                            if (testAbortController.signal.aborted) return null;\n                            const { host, port, nodeName } = parseTarget(target);\n                            const result = await testLatency(host, port, testAbortController.signal);\n                            result.host = host;\n                            result.port = port;\n                            result.nodeName = (result.success && result.colo) ? (nodeName || ('CF-' + result.colo)) : (nodeName || host);\n                            return result;\n                        }\n                        \n                        for (let i = 0; i < total; i += threads) {\n                            if (testAbortController.signal.aborted) break;\n                            \n                            const batch = targets.slice(i, Math.min(i + threads, total));\n                            testStatus.textContent = '${a?"Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª":"æµ‹è¯•ä¸­"}: ' + (i + 1) + '-' + Math.min(i + threads, total) + '/' + total + ' (${a?"Ø±Ø´ØªÙ‡â€ŒÙ‡Ø§":"çº¿ç¨‹"}: ' + threads + ')';\n                            \n                            const results = await Promise.all(batch.map(t => testOne(t)));\n                            \n                            for (const result of results) {\n                                if (result) {\n                                    const idx = testResults.length;\n                                    testResults.push(result);\n                                    renderResult(result, idx);\n                                    completed++;\n                                }\n                            }\n                        }\n                        \n                        testStatus.textContent = '${a?"ØªØ³Øª Ú©Ø§Ù…Ù„ Ø´Ø¯":"æµ‹è¯•å®Œæˆ"}: ' + completed + '/' + total;\n                        startTestBtn.style.display = 'inline-block';\n                        stopTestBtn.style.display = 'none';\n                        \n                        // æ›´æ–°åŸå¸‚é€‰æ‹©å™¨\n                        updateCityFilter();\n                    });\n                }\n                \n                if (stopTestBtn) {\n                    stopTestBtn.addEventListener('click', function() {\n                        if (testAbortController) {\n                            testAbortController.abort();\n                        }\n                        startTestBtn.style.display = 'inline-block';\n                        stopTestBtn.style.display = 'none';\n                        testStatus.textContent = '${a?"ØªØ³Øª Ù…ØªÙˆÙ‚Ù Ø´Ø¯":"æµ‹è¯•å·²åœæ­¢"}';\n                    });\n                }\n                \n                if (selectAllBtn) {\n                    selectAllBtn.addEventListener('click', function() {\n                        const checkboxes = resultsList.querySelectorAll('input[type="checkbox"]:not(:disabled)');\n                        checkboxes.forEach(cb => cb.checked = true);\n                    });\n                }\n                \n                if (deselectAllBtn) {\n                    deselectAllBtn.addEventListener('click', function() {\n                        const checkboxes = resultsList.querySelectorAll('input[type="checkbox"]');\n                        checkboxes.forEach(cb => cb.checked = false);\n                    });\n                }\n                \n                // è·å–é€‰ä¸­é¡¹çš„é€šç”¨å‡½æ•°\n                function getSelectedItems() {\n                    const checkboxes = resultsList.querySelectorAll('input[type="checkbox"]:checked');\n                    if (checkboxes.length === 0) {\n                        showStatus('${a?"Ù„Ø·ÙØ§ Ø­Ø¯Ø§Ù‚Ù„ ÛŒÚ© Ù…ÙˆØ±Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯":"è¯·è‡³å°‘é€‰æ‹©ä¸€é¡¹"}', 'error');\n                        return null;\n                    }\n                    \n                    const selectedItems = [];\n                    checkboxes.forEach(cb => {\n                        const idx = parseInt(cb.dataset.index);\n                        const result = testResults[idx];\n                        if (result && result.success) {\n                            const coloName = result.colo ? getColoName(result.colo) : result.nodeName;\n                            const itemStr = result.host + ':' + result.port + '#' + coloName;\n                            selectedItems.push(itemStr);\n                        }\n                    });\n                    \n                    return selectedItems;\n                }\n                \n                // è¦†ç›–æ·»åŠ \n                if (overwriteSelectedBtn) {\n                    overwriteSelectedBtn.addEventListener('click', async function() {\n                        const selectedItems = getSelectedItems();\n                        if (!selectedItems || selectedItems.length === 0) return;\n                        \n                        const yxInput = document.getElementById('yx');\n                        const newValue = selectedItems.join(',');\n                        yxInput.value = newValue;\n                        \n                        overwriteSelectedBtn.disabled = true;\n                        appendSelectedBtn.disabled = true;\n                        overwriteSelectedBtn.textContent = '${a?"Ø¯Ø± Ø­Ø§Ù„ Ø°Ø®ÛŒØ±Ù‡...":"ä¿å­˜ä¸­..."}';\n                        \n                        try {\n                            const configData = {\n                                customIP: document.getElementById('customIP').value,\n                                yx: newValue,\n                                yxURL: document.getElementById('yxURL').value,\n                                socksConfig: document.getElementById('socksConfig').value\n                            };\n                            await saveConfig(configData);\n                            showStatus('${a?"Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø¨ÙˆØ¯":"å·²è¦†ç›–"} ' + selectedItems.length + ' ${a?"Ù…ÙˆØ±Ø¯ Ùˆ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯":"é¡¹å¹¶å·²ä¿å­˜"}', 'success');\n                        } catch (err) {\n                            showStatus('${a?"Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡":"ä¿å­˜å¤±è´¥"}: ' + err.message, 'error');\n                        } finally {\n                            overwriteSelectedBtn.disabled = false;\n                            appendSelectedBtn.disabled = false;\n                            overwriteSelectedBtn.textContent = 'è¦†ç›–æ·»åŠ ';\n                        }\n                    });\n                }\n                \n                // è¿½åŠ æ·»åŠ \n                if (appendSelectedBtn) {\n                    appendSelectedBtn.addEventListener('click', async function() {\n                        const selectedItems = getSelectedItems();\n                        if (!selectedItems || selectedItems.length === 0) return;\n                        \n                        const yxInput = document.getElementById('yx');\n                        const currentValue = yxInput.value.trim();\n                        const newItems = selectedItems.join(',');\n                        const newValue = currentValue ? (currentValue + ',' + newItems) : newItems;\n                        yxInput.value = newValue;\n                        \n                        overwriteSelectedBtn.disabled = true;\n                        appendSelectedBtn.disabled = true;\n                        appendSelectedBtn.textContent = '${a?"Ø¯Ø± Ø­Ø§Ù„ Ø°Ø®ÛŒØ±Ù‡...":"ä¿å­˜ä¸­..."}';\n                        \n                        try {\n                            const configData = {\n                                customIP: document.getElementById('customIP').value,\n                                yx: newValue,\n                                yxURL: document.getElementById('yxURL').value,\n                                socksConfig: document.getElementById('socksConfig').value\n                            };\n                            await saveConfig(configData);\n                            showStatus('${a?"Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø¨ÙˆØ¯":"å·²è¿½åŠ "} ' + selectedItems.length + ' ${a?"Ù…ÙˆØ±Ø¯ Ùˆ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯":"é¡¹å¹¶å·²ä¿å­˜"}', 'success');\n                        } catch (err) {\n                            showStatus('${a?"Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡":"ä¿å­˜å¤±è´¥"}: ' + err.message, 'error');\n                        } finally {\n                            overwriteSelectedBtn.disabled = false;\n                            appendSelectedBtn.disabled = false;\n                            appendSelectedBtn.textContent = 'è¿½åŠ æ·»åŠ ';\n                        }\n                    });\n                }\n                \n                function ipToHex(ip) {\n                    const parts = ip.split('.');\n                    if (parts.length !== 4) return null;\n                    let hex = '';\n                    for (let i = 0; i < 4; i++) {\n                        const num = parseInt(parts[i]);\n                        if (isNaN(num) || num < 0 || num > 255) return null;\n                        hex += num.toString(16).padStart(2, '0');\n                    }\n                    return hex;\n                }\n                \n                const coloMap = {\n                    'SJC': 'ğŸ‡ºğŸ‡¸ åœ£ä½•å¡', 'LAX': 'ğŸ‡ºğŸ‡¸ æ´›æ‰çŸ¶', 'SEA': 'ğŸ‡ºğŸ‡¸ è¥¿é›…å›¾', 'SFO': 'ğŸ‡ºğŸ‡¸ æ—§é‡‘å±±', 'DFW': 'ğŸ‡ºğŸ‡¸ è¾¾æ‹‰æ–¯',\n                    'ORD': 'ğŸ‡ºğŸ‡¸ èŠåŠ å“¥', 'IAD': 'ğŸ‡ºğŸ‡¸ åç››é¡¿', 'ATL': 'ğŸ‡ºğŸ‡¸ äºšç‰¹å…°å¤§', 'MIA': 'ğŸ‡ºğŸ‡¸ è¿ˆé˜¿å¯†', 'DEN': 'ğŸ‡ºğŸ‡¸ ä¸¹ä½›',\n                    'PHX': 'ğŸ‡ºğŸ‡¸ å‡¤å‡°åŸ', 'BOS': 'ğŸ‡ºğŸ‡¸ æ³¢å£«é¡¿', 'EWR': 'ğŸ‡ºğŸ‡¸ çº½ç“¦å…‹', 'JFK': 'ğŸ‡ºğŸ‡¸ çº½çº¦', 'LAS': 'ğŸ‡ºğŸ‡¸ æ‹‰æ–¯ç»´åŠ æ–¯',\n                    'MSP': 'ğŸ‡ºğŸ‡¸ æ˜å°¼é˜¿æ³¢åˆ©æ–¯', 'DTW': 'ğŸ‡ºğŸ‡¸ åº•ç‰¹å¾‹', 'PHL': 'ğŸ‡ºğŸ‡¸ è´¹åŸ', 'CLT': 'ğŸ‡ºğŸ‡¸ å¤æ´›ç‰¹', 'SLC': 'ğŸ‡ºğŸ‡¸ ç›æ¹–åŸ',\n                    'PDX': 'ğŸ‡ºğŸ‡¸ æ³¢ç‰¹å…°', 'SAN': 'ğŸ‡ºğŸ‡¸ åœ£åœ°äºšå“¥', 'TPA': 'ğŸ‡ºğŸ‡¸ å¦å¸•', 'IAH': 'ğŸ‡ºğŸ‡¸ ä¼‘æ–¯é¡¿', 'MCO': 'ğŸ‡ºğŸ‡¸ å¥¥å…°å¤š',\n                    'AUS': 'ğŸ‡ºğŸ‡¸ å¥¥æ–¯æ±€', 'BNA': 'ğŸ‡ºğŸ‡¸ çº³ä»€ç»´å°”', 'RDU': 'ğŸ‡ºğŸ‡¸ ç½—åˆ©', 'IND': 'ğŸ‡ºğŸ‡¸ å°ç¬¬å®‰çº³æ³¢åˆ©æ–¯', 'CMH': 'ğŸ‡ºğŸ‡¸ å“¥ä¼¦å¸ƒ',\n                    'MCI': 'ğŸ‡ºğŸ‡¸ å ªè¨æ–¯åŸ', 'OMA': 'ğŸ‡ºğŸ‡¸ å¥¥é©¬å“ˆ', 'ABQ': 'ğŸ‡ºğŸ‡¸ é˜¿å°”ä¼¯å…‹åŸº', 'OKC': 'ğŸ‡ºğŸ‡¸ ä¿„å…‹æ‹‰è·é©¬åŸ', 'MEM': 'ğŸ‡ºğŸ‡¸ å­Ÿè²æ–¯',\n                    'JAX': 'ğŸ‡ºğŸ‡¸ æ°å…‹é€Šç»´å°”', 'RIC': 'ğŸ‡ºğŸ‡¸ é‡Œå£«æ»¡', 'BUF': 'ğŸ‡ºğŸ‡¸ å¸ƒæ³•ç½—', 'PIT': 'ğŸ‡ºğŸ‡¸ åŒ¹å…¹å ¡', 'CLE': 'ğŸ‡ºğŸ‡¸ å…‹åˆ©å¤«å…°',\n                    'CVG': 'ğŸ‡ºğŸ‡¸ è¾›è¾›é‚£æ', 'MKE': 'ğŸ‡ºğŸ‡¸ å¯†å°”æ²ƒåŸº', 'STL': 'ğŸ‡ºğŸ‡¸ åœ£è·¯æ˜“æ–¯', 'SAT': 'ğŸ‡ºğŸ‡¸ åœ£å®‰ä¸œå°¼å¥¥', 'HNL': 'ğŸ‡ºğŸ‡¸ æª€é¦™å±±',\n                    'ANC': 'ğŸ‡ºğŸ‡¸ å®‰å…‹é›·å¥‡', 'SMF': 'ğŸ‡ºğŸ‡¸ è¨å…‹æ‹‰é—¨æ‰˜', 'ONT': 'ğŸ‡ºğŸ‡¸ å®‰å¤§ç•¥', 'OAK': 'ğŸ‡ºğŸ‡¸ å¥¥å…‹å…°',\n                    'HKG': 'ğŸ‡­ğŸ‡° é¦™æ¸¯', 'TPE': 'ğŸ‡¹ğŸ‡¼ å°åŒ—', 'TSA': 'ğŸ‡¹ğŸ‡¼ å°åŒ—æ¾å±±', 'KHH': 'ğŸ‡¹ğŸ‡¼ é«˜é›„',\n                    'NRT': 'ğŸ‡¯ğŸ‡µ ä¸œäº¬æˆç”°', 'HND': 'ğŸ‡¯ğŸ‡µ ä¸œäº¬ç¾½ç”°', 'KIX': 'ğŸ‡¯ğŸ‡µ å¤§é˜ªå…³è¥¿', 'ITM': 'ğŸ‡¯ğŸ‡µ å¤§é˜ªä¼Šä¸¹', 'NGO': 'ğŸ‡¯ğŸ‡µ åå¤å±‹',\n                    'FUK': 'ğŸ‡¯ğŸ‡µ ç¦å†ˆ', 'CTS': 'ğŸ‡¯ğŸ‡µ æœ­å¹Œ', 'OKA': 'ğŸ‡¯ğŸ‡µ å†²ç»³',\n                    'ICN': 'ğŸ‡°ğŸ‡· é¦–å°”ä»å·', 'GMP': 'ğŸ‡°ğŸ‡· é¦–å°”é‡‘æµ¦', 'PUS': 'ğŸ‡°ğŸ‡· é‡œå±±',\n                    'SIN': 'ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡', 'BKK': 'ğŸ‡¹ğŸ‡­ æ›¼è°·', 'DMK': 'ğŸ‡¹ğŸ‡­ æ›¼è°·å»Šæ›¼', 'KUL': 'ğŸ‡²ğŸ‡¾ å‰éš†å¡', 'CGK': 'ğŸ‡®ğŸ‡© é›…åŠ è¾¾',\n                    'MNL': 'ğŸ‡µğŸ‡­ é©¬å°¼æ‹‰', 'CEB': 'ğŸ‡µğŸ‡­ å®¿åŠ¡', 'HAN': 'ğŸ‡»ğŸ‡³ æ²³å†…', 'SGN': 'ğŸ‡»ğŸ‡³ èƒ¡å¿—æ˜', 'DAD': 'ğŸ‡»ğŸ‡³ å²˜æ¸¯',\n                    'RGN': 'ğŸ‡²ğŸ‡² ä»°å…‰', 'PNH': 'ğŸ‡°ğŸ‡­ é‡‘è¾¹', 'REP': 'ğŸ‡°ğŸ‡­ æš¹ç²’', 'VTE': 'ğŸ‡±ğŸ‡¦ ä¸‡è±¡',\n                    'BOM': 'ğŸ‡®ğŸ‡³ å­Ÿä¹°', 'DEL': 'ğŸ‡®ğŸ‡³ æ–°å¾·é‡Œ', 'MAA': 'ğŸ‡®ğŸ‡³ é‡‘å¥ˆ', 'BLR': 'ğŸ‡®ğŸ‡³ ç­åŠ ç½—å°”', 'CCU': 'ğŸ‡®ğŸ‡³ åŠ å°”å„ç­”',\n                    'HYD': 'ğŸ‡®ğŸ‡³ æµ·å¾—æ‹‰å·´', 'AMD': 'ğŸ‡®ğŸ‡³ è‰¾å“ˆè¿ˆè¾¾å·´å¾·', 'COK': 'ğŸ‡®ğŸ‡³ ç§‘é’¦', 'PNQ': 'ğŸ‡®ğŸ‡³ æµ¦é‚£', 'GOI': 'ğŸ‡®ğŸ‡³ æœé˜¿',\n                    'CMB': 'ğŸ‡±ğŸ‡° ç§‘ä¼¦å¡', 'DAC': 'ğŸ‡§ğŸ‡© è¾¾å¡', 'KTM': 'ğŸ‡³ğŸ‡µ åŠ å¾·æ»¡éƒ½', 'ISB': 'ğŸ‡µğŸ‡° ä¼Šæ–¯å…°å ¡', 'KHI': 'ğŸ‡µğŸ‡° å¡æ‹‰å¥‡', 'LHE': 'ğŸ‡µğŸ‡° æ‹‰åˆå°”',\n                    'LHR': 'ğŸ‡¬ğŸ‡§ ä¼¦æ•¦å¸Œæ€ç½—', 'LGW': 'ğŸ‡¬ğŸ‡§ ä¼¦æ•¦ç›–ç‰¹å¨å…‹', 'STN': 'ğŸ‡¬ğŸ‡§ ä¼¦æ•¦æ–¯å¦æ–¯ç‰¹å¾·', 'LTN': 'ğŸ‡¬ğŸ‡§ ä¼¦æ•¦å¢é¡¿', 'MAN': 'ğŸ‡¬ğŸ‡§ æ›¼å½»æ–¯ç‰¹', 'EDI': 'ğŸ‡¬ğŸ‡§ çˆ±ä¸å ¡', 'BHX': 'ğŸ‡¬ğŸ‡§ ä¼¯æ˜ç¿°',\n                    'CDG': 'ğŸ‡«ğŸ‡· å·´é»æˆ´é«˜ä¹', 'ORY': 'ğŸ‡«ğŸ‡· å·´é»å¥¥åˆ©', 'MRS': 'ğŸ‡«ğŸ‡· é©¬èµ›', 'LYS': 'ğŸ‡«ğŸ‡· é‡Œæ˜‚', 'NCE': 'ğŸ‡«ğŸ‡· å°¼æ–¯',\n                    'FRA': 'ğŸ‡©ğŸ‡ª æ³•å…°å…‹ç¦', 'MUC': 'ğŸ‡©ğŸ‡ª æ…•å°¼é»‘', 'TXL': 'ğŸ‡©ğŸ‡ª æŸæ—', 'BER': 'ğŸ‡©ğŸ‡ª æŸæ—å‹ƒå…°ç™»å ¡', 'HAM': 'ğŸ‡©ğŸ‡ª æ±‰å ¡', 'DUS': 'ğŸ‡©ğŸ‡ª æœå¡å°”å¤šå¤«', 'CGN': 'ğŸ‡©ğŸ‡ª ç§‘éš†', 'STR': 'ğŸ‡©ğŸ‡ª æ–¯å›¾åŠ ç‰¹',\n                    'AMS': 'ğŸ‡³ğŸ‡± é˜¿å§†æ–¯ç‰¹ä¸¹', 'BRU': 'ğŸ‡§ğŸ‡ª å¸ƒé²å¡å°”', 'LUX': 'ğŸ‡±ğŸ‡º å¢æ£®å ¡',\n                    'ZRH': 'ğŸ‡¨ğŸ‡­ è‹é»ä¸–', 'GVA': 'ğŸ‡¨ğŸ‡­ æ—¥å†…ç“¦', 'BSL': 'ğŸ‡¨ğŸ‡­ å·´å¡å°”',\n                    'VIE': 'ğŸ‡¦ğŸ‡¹ ç»´ä¹Ÿçº³', 'PRG': 'ğŸ‡¨ğŸ‡¿ å¸ƒæ‹‰æ ¼', 'BUD': 'ğŸ‡­ğŸ‡º å¸ƒè¾¾ä½©æ–¯', 'WAW': 'ğŸ‡µğŸ‡± åæ²™', 'KRK': 'ğŸ‡µğŸ‡± å…‹æ‹‰ç§‘å¤«',\n                    'MXP': 'ğŸ‡®ğŸ‡¹ ç±³å…°é©¬å°”å½­è¨', 'LIN': 'ğŸ‡®ğŸ‡¹ ç±³å…°åˆ©çº³ç‰¹', 'FCO': 'ğŸ‡®ğŸ‡¹ ç½—é©¬', 'VCE': 'ğŸ‡®ğŸ‡¹ å¨å°¼æ–¯', 'NAP': 'ğŸ‡®ğŸ‡¹ é‚£ä¸å‹’æ–¯', 'FLR': 'ğŸ‡®ğŸ‡¹ ä½›ç½—ä¼¦è¨', 'BGY': 'ğŸ‡®ğŸ‡¹ è´åŠ è«',\n                    'MAD': 'ğŸ‡ªğŸ‡¸ é©¬å¾·é‡Œ', 'BCN': 'ğŸ‡ªğŸ‡¸ å·´å¡ç½—é‚£', 'PMI': 'ğŸ‡ªğŸ‡¸ å¸•å°”é©¬', 'AGP': 'ğŸ‡ªğŸ‡¸ é©¬æ‹‰åŠ ', 'VLC': 'ğŸ‡ªğŸ‡¸ ç“¦ä¼¦è¥¿äºš', 'SVQ': 'ğŸ‡ªğŸ‡¸ å¡ç»´åˆ©äºš', 'BIO': 'ğŸ‡ªğŸ‡¸ æ¯•å°”å·´é„‚',\n                    'LIS': 'ğŸ‡µğŸ‡¹ é‡Œæ–¯æœ¬', 'OPO': 'ğŸ‡µğŸ‡¹ æ³¢å°”å›¾', 'FAO': 'ğŸ‡µğŸ‡¹ æ³•é²',\n                    'DUB': 'ğŸ‡®ğŸ‡ª éƒ½æŸæ—', 'CPH': 'ğŸ‡©ğŸ‡° å“¥æœ¬å“ˆæ ¹', 'ARN': 'ğŸ‡¸ğŸ‡ª æ–¯å¾·å“¥å°”æ‘©', 'GOT': 'ğŸ‡¸ğŸ‡ª å“¥å¾·å ¡',\n                    'OSL': 'ğŸ‡³ğŸ‡´ å¥¥æ–¯é™†', 'BGO': 'ğŸ‡³ğŸ‡´ å‘å°”æ ¹', 'HEL': 'ğŸ‡«ğŸ‡® èµ«å°”è¾›åŸº', 'RIX': 'ğŸ‡±ğŸ‡» é‡ŒåŠ ', 'TLL': 'ğŸ‡ªğŸ‡ª å¡”æ—', 'VNO': 'ğŸ‡±ğŸ‡¹ ç»´å°”çº½æ–¯',\n                    'ATH': 'ğŸ‡¬ğŸ‡· é›…å…¸', 'SKG': 'ğŸ‡¬ğŸ‡· å¡è¨æ´›å°¼åŸº', 'SOF': 'ğŸ‡§ğŸ‡¬ ç´¢éäºš', 'OTP': 'ğŸ‡·ğŸ‡´ å¸ƒåŠ å‹’æ–¯ç‰¹', 'BEG': 'ğŸ‡·ğŸ‡¸ è´å°”æ ¼è±å¾·', 'ZAG': 'ğŸ‡­ğŸ‡· è¨æ ¼å‹’å¸ƒ', 'LJU': 'ğŸ‡¸ğŸ‡® å¢å¸ƒå°”é›…é‚£',\n                    'KBP': 'ğŸ‡ºğŸ‡¦ åŸºè¾…', 'IEV': 'ğŸ‡ºğŸ‡¦ åŸºè¾…èŒ¹è‰¯å°¼', 'ODS': 'ğŸ‡ºğŸ‡¦ æ•–å¾·è¨',\n                    'SVO': 'ğŸ‡·ğŸ‡º è«æ–¯ç§‘è°¢åˆ—æ¢…æ·æ²ƒ', 'DME': 'ğŸ‡·ğŸ‡º è«æ–¯ç§‘å¤šè«æ°å¤šæ²ƒ', 'VKO': 'ğŸ‡·ğŸ‡º è«æ–¯ç§‘ä¼åŠªç§‘æ²ƒ', 'LED': 'ğŸ‡·ğŸ‡º åœ£å½¼å¾—å ¡',\n                    'IST': 'ğŸ‡¹ğŸ‡· ä¼Šæ–¯å¦å¸ƒå°”', 'SAW': 'ğŸ‡¹ğŸ‡· ä¼Šæ–¯å¦å¸ƒå°”è¨æ¯”å“ˆ', 'ESB': 'ğŸ‡¹ğŸ‡· å®‰å¡æ‹‰', 'AYT': 'ğŸ‡¹ğŸ‡· å®‰å¡”åˆ©äºš', 'ADB': 'ğŸ‡¹ğŸ‡· ä¼Šå…¹å¯†å°”',\n                    'TLV': 'ğŸ‡®ğŸ‡± ç‰¹æ‹‰ç»´å¤«', 'AMM': 'ğŸ‡¯ğŸ‡´ å®‰æ›¼', 'BEY': 'ğŸ‡±ğŸ‡§ è´é²ç‰¹', 'BAH': 'ğŸ‡§ğŸ‡­ å·´æ—', 'KWI': 'ğŸ‡°ğŸ‡¼ ç§‘å¨ç‰¹',\n                    'DXB': 'ğŸ‡¦ğŸ‡ª è¿ªæ‹œ', 'AUH': 'ğŸ‡¦ğŸ‡ª é˜¿å¸ƒæ‰æ¯”', 'SHJ': 'ğŸ‡¦ğŸ‡ª æ²™è¿¦', 'DOH': 'ğŸ‡¶ğŸ‡¦ å¤šå“ˆ', 'MCT': 'ğŸ‡´ğŸ‡² é©¬æ–¯å–€ç‰¹',\n                    'RUH': 'ğŸ‡¸ğŸ‡¦ åˆ©é›…å¾—', 'JED': 'ğŸ‡¸ğŸ‡¦ å‰è¾¾', 'DMM': 'ğŸ‡¸ğŸ‡¦ è¾¾æ›¼',\n                    'CAI': 'ğŸ‡ªğŸ‡¬ å¼€ç½—', 'HBE': 'ğŸ‡ªğŸ‡¬ äºšå†å±±å¤§', 'SSH': 'ğŸ‡ªğŸ‡¬ æ²™å§†æ²™ä¼Šèµ«',\n                    'CMN': 'ğŸ‡²ğŸ‡¦ å¡è¨å¸ƒå…°å¡', 'RAK': 'ğŸ‡²ğŸ‡¦ é©¬æ‹‰å–€ä»€', 'TUN': 'ğŸ‡¹ğŸ‡³ çªå°¼æ–¯', 'ALG': 'ğŸ‡©ğŸ‡¿ é˜¿å°”åŠå°”',\n                    'LOS': 'ğŸ‡³ğŸ‡¬ æ‹‰å„æ–¯', 'ABV': 'ğŸ‡³ğŸ‡¬ é˜¿å¸ƒè´¾', 'ACC': 'ğŸ‡¬ğŸ‡­ é˜¿å…‹æ‹‰', 'NBO': 'ğŸ‡°ğŸ‡ª å†…ç½—æ¯•', 'MBA': 'ğŸ‡°ğŸ‡ª è’™å·´è¨', 'ADD': 'ğŸ‡ªğŸ‡¹ äºšçš„æ–¯äºšè´å·´', 'DAR': 'ğŸ‡¹ğŸ‡¿ è¾¾ç´¯æ–¯è¨æ‹‰å§†',\n                    'JNB': 'ğŸ‡¿ğŸ‡¦ çº¦ç¿°å†…æ–¯å ¡', 'CPT': 'ğŸ‡¿ğŸ‡¦ å¼€æ™®æ•¦', 'DUR': 'ğŸ‡¿ğŸ‡¦ å¾·ç­', 'HRE': 'ğŸ‡¿ğŸ‡¼ å“ˆæ‹‰é›·', 'LUN': 'ğŸ‡¿ğŸ‡² å¢è¨å¡',\n                    'MRU': 'ğŸ‡²ğŸ‡º æ¯›é‡Œæ±‚æ–¯', 'SEZ': 'ğŸ‡¸ğŸ‡¨ å¡èˆŒå°”',\n                    'SYD': 'ğŸ‡¦ğŸ‡º æ‚‰å°¼', 'MEL': 'ğŸ‡¦ğŸ‡º å¢¨å°”æœ¬', 'BNE': 'ğŸ‡¦ğŸ‡º å¸ƒé‡Œæ–¯ç­', 'PER': 'ğŸ‡¦ğŸ‡º ç€æ–¯', 'ADL': 'ğŸ‡¦ğŸ‡º é˜¿å¾·è±å¾·', 'CBR': 'ğŸ‡¦ğŸ‡º å ªåŸ¹æ‹‰', 'OOL': 'ğŸ‡¦ğŸ‡º é»„é‡‘æµ·å²¸', 'CNS': 'ğŸ‡¦ğŸ‡º å‡¯æ©æ–¯',\n                    'AKL': 'ğŸ‡³ğŸ‡¿ å¥¥å…‹å…°', 'WLG': 'ğŸ‡³ğŸ‡¿ æƒ çµé¡¿', 'CHC': 'ğŸ‡³ğŸ‡¿ åŸºç£åŸ', 'ZQN': 'ğŸ‡³ğŸ‡¿ çš‡åé•‡',\n                    'NAN': 'ğŸ‡«ğŸ‡¯ æ¥ è¿ª', 'PPT': 'ğŸ‡µğŸ‡« å¸•çš®æ', 'GUM': 'ğŸ‡¬ğŸ‡º å…³å²›',\n                    'GRU': 'ğŸ‡§ğŸ‡· åœ£ä¿ç½—ç“œé²æŸ³æ–¯', 'CGH': 'ğŸ‡§ğŸ‡· åœ£ä¿ç½—å­”æˆˆå°¼äºšæ–¯', 'GIG': 'ğŸ‡§ğŸ‡· é‡Œçº¦çƒ­å†…å¢', 'BSB': 'ğŸ‡§ğŸ‡· å·´è¥¿åˆ©äºš', 'CNF': 'ğŸ‡§ğŸ‡· è´æ´›å¥¥é‡Œè—ç‰¹', 'POA': 'ğŸ‡§ğŸ‡· é˜¿é›·æ ¼é‡Œæ¸¯', 'CWB': 'ğŸ‡§ğŸ‡· åº“é‡Œè’‚å·´', 'FOR': 'ğŸ‡§ğŸ‡· ç¦å¡”è±è¨', 'REC': 'ğŸ‡§ğŸ‡· ç´¯è¥¿è…“', 'SSA': 'ğŸ‡§ğŸ‡· è¨å°”ç“¦å¤š',\n                    'EZE': 'ğŸ‡¦ğŸ‡· å¸ƒå®œè¯ºæ–¯è‰¾åˆ©æ–¯', 'AEP': 'ğŸ‡¦ğŸ‡· å¸ƒå®œè¯ºæ–¯è‰¾åˆ©æ–¯åŸ', 'COR': 'ğŸ‡¦ğŸ‡· ç§‘å°”å¤šç“¦', 'MDZ': 'ğŸ‡¦ğŸ‡· é—¨å¤šè¨',\n                    'SCL': 'ğŸ‡¨ğŸ‡± åœ£åœ°äºšå“¥', 'LIM': 'ğŸ‡µğŸ‡ª åˆ©é©¬', 'BOG': 'ğŸ‡¨ğŸ‡´ æ³¢å“¥å¤§', 'MDE': 'ğŸ‡¨ğŸ‡´ éº¦å¾·æ—', 'CLO': 'ğŸ‡¨ğŸ‡´ å¡åˆ©',\n                    'UIO': 'ğŸ‡ªğŸ‡¨ åŸºå¤š', 'GYE': 'ğŸ‡ªğŸ‡¨ ç“œäºšåŸºå°”', 'CCS': 'ğŸ‡»ğŸ‡ª åŠ æ‹‰åŠ æ–¯', 'MVD': 'ğŸ‡ºğŸ‡¾ è’™å¾—ç»´çš„äºš', 'ASU': 'ğŸ‡µğŸ‡¾ äºšæ¾æ£®',\n                    'PTY': 'ğŸ‡µğŸ‡¦ å·´æ‹¿é©¬åŸ', 'SJO': 'ğŸ‡¨ğŸ‡· åœ£ä½•å¡', 'GUA': 'ğŸ‡¬ğŸ‡¹ å±åœ°é©¬æ‹‰åŸ', 'SAL': 'ğŸ‡¸ğŸ‡» åœ£è¨å°”ç“¦å¤š', 'TGU': 'ğŸ‡­ğŸ‡³ ç‰¹å¤è¥¿åŠ å°”å·´', 'MGA': 'ğŸ‡³ğŸ‡® é©¬é‚£ç“œ', 'BZE': 'ğŸ‡§ğŸ‡¿ ä¼¯åˆ©å…¹åŸ',\n                    'MEX': 'ğŸ‡²ğŸ‡½ å¢¨è¥¿å“¥åŸ', 'GDL': 'ğŸ‡²ğŸ‡½ ç“œè¾¾æ‹‰å“ˆæ‹‰', 'MTY': 'ğŸ‡²ğŸ‡½ è’™ç‰¹é›·', 'CUN': 'ğŸ‡²ğŸ‡½ åæ˜†', 'TIJ': 'ğŸ‡²ğŸ‡½ è’‚åçº³', 'SJD': 'ğŸ‡²ğŸ‡½ åœ£ä½•å¡å¾·å°”å¡æ²ƒ',\n                    'YYZ': 'ğŸ‡¨ğŸ‡¦ å¤šä¼¦å¤š', 'YVR': 'ğŸ‡¨ğŸ‡¦ æ¸©å“¥å', 'YUL': 'ğŸ‡¨ğŸ‡¦ è’™ç‰¹åˆ©å°”', 'YYC': 'ğŸ‡¨ğŸ‡¦ å¡å°”åŠ é‡Œ', 'YEG': 'ğŸ‡¨ğŸ‡¦ åŸƒå¾·è’™é¡¿', 'YOW': 'ğŸ‡¨ğŸ‡¦ æ¸¥å¤ªå', 'YWG': 'ğŸ‡¨ğŸ‡¦ æ¸©å°¼ä¼¯', 'YHZ': 'ğŸ‡¨ğŸ‡¦ å“ˆåˆ©æ³•å…‹æ–¯',\n                    'HAV': 'ğŸ‡¨ğŸ‡º å“ˆç“¦é‚£', 'SJU': 'ğŸ‡µğŸ‡· åœ£èƒ¡å®‰', 'SDQ': 'ğŸ‡©ğŸ‡´ åœ£å¤šæ˜å„', 'PAP': 'ğŸ‡­ğŸ‡¹ å¤ªå­æ¸¯', 'KIN': 'ğŸ‡¯ğŸ‡² é‡‘æ–¯é¡¿', 'NAS': 'ğŸ‡§ğŸ‡¸ æ‹¿éªš', 'MBJ': 'ğŸ‡¯ğŸ‡² è’™ç‰¹å“¥è´'\n                };\n                \n                function getColoName(colo) {\n                    return coloMap[colo] || colo;\n                }\n                \n                // åŸå¸‚ç­›é€‰ç›¸å…³å‡½æ•°\n                const cityFilterContainer = document.getElementById('cityFilterContainer');\n                const cityCheckboxesContainer = document.getElementById('cityCheckboxesContainer');\n                \n                function updateCityFilter() {\n                    if (!cityFilterContainer || !cityCheckboxesContainer) return;\n                    \n                    // ä»æµ‹è¯•ç»“æœä¸­æå–æ‰€æœ‰å¯ç”¨çš„åŸå¸‚\n                    const cityMap = new Map();\n                    testResults.forEach((result, index) => {\n                        if (result.success && result.colo) {\n                            const colo = result.colo;\n                            if (!cityMap.has(colo)) {\n                                cityMap.set(colo, {\n                                    colo: colo,\n                                    name: getColoName(colo),\n                                    count: 0\n                                });\n                            }\n                            cityMap.get(colo).count++;\n                        }\n                    });\n                    \n                    if (cityMap.size === 0) {\n                        cityFilterContainer.style.display = 'none';\n                        return;\n                    }\n                    \n                    cityFilterContainer.style.display = 'block';\n                    cityCheckboxesContainer.innerHTML = '';\n                    \n                    // æŒ‰åŸå¸‚åç§°æ’åº\n                    const cities = Array.from(cityMap.values()).sort((a, b) => a.name.localeCompare(b.name));\n                    \n                    cities.forEach(city => {\n                        const label = document.createElement('label');\n                        label.style.cssText = 'display: inline-flex; align-items: center; cursor: pointer; color: #00ff00; font-size: 0.85rem; padding: 4px 8px; background: rgba(0, 40, 0, 0.4); border: 1px solid #00aa00; border-radius: 4px;';\n                        \n                        const checkbox = document.createElement('input');\n                        checkbox.type = 'checkbox';\n                        checkbox.value = city.colo;\n                        checkbox.checked = true;\n                        checkbox.dataset.colo = city.colo;\n                        checkbox.style.cssText = 'margin-right: 6px; width: 16px; height: 16px; cursor: pointer;';\n                        \n                        const span = document.createElement('span');\n                        span.textContent = city.name + ' (' + city.count + ')';\n                        \n                        label.appendChild(checkbox);\n                        label.appendChild(span);\n                        cityCheckboxesContainer.appendChild(label);\n                        \n                        checkbox.addEventListener('change', filterResultsByCity);\n                    });\n                    \n                    // ç›‘å¬ç­›é€‰æ¨¡å¼å˜åŒ–\n                    const filterModeRadios = document.querySelectorAll('input[name="cityFilterMode"]');\n                    filterModeRadios.forEach(radio => {\n                        radio.addEventListener('change', function() {\n                            if (this.value === 'all') {\n                                // åˆ‡æ¢åˆ°"å…¨éƒ¨åŸå¸‚"æ¨¡å¼æ—¶ï¼Œè‡ªåŠ¨é€‰ä¸­æ‰€æœ‰åŸå¸‚å¤é€‰æ¡†\n                                const cityCheckboxes = cityCheckboxesContainer.querySelectorAll('input[type="checkbox"]');\n                                cityCheckboxes.forEach(cb => {\n                                    cb.checked = true;\n                                    cb.disabled = false;\n                                });\n                            }\n                            filterResultsByCity();\n                        });\n                    });\n                }\n                \n                function filterResultsByCity() {\n                    if (!resultsList || !cityCheckboxesContainer) return;\n                    \n                    const filterMode = document.querySelector('input[name="cityFilterMode"]:checked')?.value || 'all';\n                    const resultItems = resultsList.querySelectorAll('[data-index]');\n                    const cityCheckboxes = cityCheckboxesContainer.querySelectorAll('input[type="checkbox"]');\n                    \n                    if (filterMode === 'fastest10') {\n                        // åªé€‰æ‹©æœ€å¿«çš„10ä¸ª\n                        const sortedResults = testResults\n                            .map((result, index) => ({ result, index }))\n                            .filter(item => item.result.success)\n                            .sort((a, b) => a.result.latency - b.result.latency)\n                            .slice(0, 10);\n                        \n                        const fastestIndices = new Set(sortedResults.map(item => item.index));\n                        \n                        resultItems.forEach(item => {\n                            const index = parseInt(item.dataset.index);\n                            const checkbox = item.querySelector('input[type="checkbox"]');\n                            if (fastestIndices.has(index)) {\n                                item.style.display = 'flex';\n                                if (checkbox) checkbox.checked = true;\n                            } else {\n                                item.style.display = 'none';\n                                if (checkbox) checkbox.checked = false;\n                            }\n                        });\n                        \n                        // ç¦ç”¨åŸå¸‚å¤é€‰æ¡†\n                        cityCheckboxes.forEach(cb => cb.disabled = true);\n                    } else {\n                        // æ ¹æ®é€‰ä¸­çš„åŸå¸‚ç­›é€‰\n                        const selectedCities = new Set();\n                        cityCheckboxes.forEach(cb => {\n                            if (cb.checked) {\n                                selectedCities.add(cb.value);\n                            }\n                        });\n                        \n                        // å¦‚æœæ‰€æœ‰åŸå¸‚éƒ½è¢«é€‰ä¸­ï¼ˆæˆ–æ²¡æœ‰é€‰ä¸­ä»»ä½•åŸå¸‚ï¼‰ï¼Œæ˜¾ç¤ºæ‰€æœ‰ç»“æœ\n                        const allChecked = cityCheckboxes.length > 0 && selectedCities.size === cityCheckboxes.length;\n                        const noneChecked = selectedCities.size === 0;\n                        \n                        resultItems.forEach(item => {\n                            const colo = item.dataset.colo || '';\n                            if (allChecked || noneChecked || selectedCities.has(colo)) {\n                                item.style.display = 'flex';\n                            } else {\n                                item.style.display = 'none';\n                            }\n                        });\n                        \n                        // å¯ç”¨åŸå¸‚å¤é€‰æ¡†\n                        cityCheckboxes.forEach(cb => cb.disabled = false);\n                    }\n                }\n                \n                async function testLatency(host, port, signal) {\n                    const timeout = 8000;\n                    let colo = '';\n                    let testUrl = '';\n                    \n                    try {\n                        const controller = new AbortController();\n                        const timeoutId = setTimeout(() => controller.abort(), timeout);\n                        \n                        if (signal) {\n                            signal.addEventListener('abort', () => controller.abort());\n                        }\n                        \n                        const cleanHost = host.replace(/^\\[|\\]$/g, '');\n                        const hexIP = ipToHex(cleanHost);\n                        const testDomain = hexIP ? (hexIP + '.nip.lfree.org') : (cleanHost + '.nip.lfree.org');\n                        testUrl = 'https://' + testDomain + ':' + port + '/';\n                        \n                        console.log('[LatencyTest] Testing:', testUrl, 'Original:', host + ':' + port, 'HexIP:', hexIP);\n                        \n                        const firstStart = Date.now();\n                        const response1 = await fetch(testUrl, { \n                            signal: controller.signal\n                        });\n                        const firstTime = Date.now() - firstStart;\n                        \n                        if (!response1.ok) {\n                            clearTimeout(timeoutId);\n                            return { success: false, latency: firstTime, error: 'HTTP ' + response1.status + ' ' + response1.statusText, colo: '', testUrl: testUrl };\n                        }\n                        \n                        try {\n                            const text = await response1.text();\n                            console.log('[LatencyTest] Response body:', text.substring(0, 200));\n                            const data = JSON.parse(text);\n                            if (data.colo) {\n                                colo = data.colo;\n                            }\n                        } catch (e) {\n                            console.log('[LatencyTest] Parse error:', e.message);\n                        }\n                        \n                        const secondStart = Date.now();\n                        const response2 = await fetch(testUrl, { \n                            signal: controller.signal\n                        });\n                        await response2.text();\n                        const latency = Date.now() - secondStart;\n                        \n                        clearTimeout(timeoutId);\n                        \n                        console.log('[LatencyTest] First:', firstTime + 'ms (DNS+TLS+RTT)', 'Second:', latency + 'ms (RTT only)');\n                        \n                        return { success: true, latency: latency, colo: colo, testUrl: testUrl };\n                    } catch (error) {\n                        const errorMsg = error.name === 'AbortError' ? '${a?"Ø²Ù…Ø§Ù† ØªÙ…Ø§Ù… Ø´Ø¯":"è¶…æ—¶"}' : error.message;\n                        console.log('[LatencyTest] Error:', errorMsg, 'URL:', testUrl);\n                        return { success: false, latency: -1, error: errorMsg, colo: '', testUrl: testUrl };\n                    }\n                }\n            });\n        </script>\n    </body>\n    </html>`
;return new Response(l,{status:200,headers:{"Content-Type":"text/html; charset=utf-8"}})}async function parseTrojanHeader(e,n){const t=tp||n,o=await sha224Hash(t);if(e.byteLength<56)return{hasError:!0,message:"invalid "+atob("dHJvamFu")+" data - too short"};let a=56;if(13!==new Uint8Array(e.slice(56,57))[0]||10!==new Uint8Array(e.slice(57,58))[0])return{hasError:!0,message:"invalid "+atob("dHJvamFu")+" header format (missing CR LF)"};const r=(new TextDecoder).decode(e.slice(0,a));if(r!==o)return{hasError:!0,message:"invalid "+atob("dHJvamFu")+" password"};const s=e.slice(a+2);if(s.byteLength<6)return{hasError:!0,message:atob("aW52YWxpZCBTT0NLUzUgcmVxdWVzdCBkYXRh")};const i=new DataView(s),l=i.getUint8(0);if(1!==l)return{hasError:!0,message:"unsupported command, only TCP (CONNECT) is allowed"};const c=i.getUint8(1);let d=0,p=2,u="";switch(c){case 1:d=4,u=new Uint8Array(s.slice(p,p+d)).join(".");break;case 3:d=new Uint8Array(s.slice(p,p+1))[0],p+=1,u=(new TextDecoder).decode(s.slice(p,p+d));break;case 4:d=16;const e=new DataView(s.slice(p,p+d)),n=[];for(let t=0;t<8;t++)n.push(e.getUint16(2*t).toString(16));u=n.join(":");break;default:return{hasError:!0,message:`invalid addressType is ${c}`}}if(!u)return{hasError:!0,message:`address is empty, addressType is ${c}`};const f=p+d,m=s.slice(f,f+2),g=new DataView(m).getUint16(0);return{hasError:!1,addressRemote:u,addressType:c,port:g,hostname:u,rawClientData:s.slice(f+4)}}async function sha224Hash(e){const n=new TextEncoder,t=n.encode(e),o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];let a=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428];const r=t.length,s=8*r,i=64*Math.ceil((r+9)/64),l=new Uint8Array(i);l.set(t),l[r]=128;const c=new DataView(l.buffer);c.setUint32(i-4,s,!1);for(let e=0;e<i;e+=64){const n=new Uint32Array(64);for(let t=0;t<16;t++)n[t]=c.getUint32(e+4*t,!1);for(let e=16;e<64;e++){const t=rightRotate(n[e-15],7)^rightRotate(n[e-15],18)^n[e-15]>>>3,o=rightRotate(n[e-2],17)^rightRotate(n[e-2],19)^n[e-2]>>>10;n[e]=n[e-16]+t+n[e-7]+o>>>0}let[t,r,s,i,l,d,p,u]=a;for(let e=0;e<64;e++){const a=rightRotate(l,6)^rightRotate(l,11)^rightRotate(l,25),c=l&d^~l&p,f=u+a+c+o[e]+n[e]>>>0,m=rightRotate(t,2)^rightRotate(t,13)^rightRotate(t,22),g=t&r^t&s^r&s,h=m+g>>>0;u=p,p=d,d=l,l=i+f>>>0,i=s,s=r,r=t,t=f+h>>>0}a[0]=a[0]+t>>>0,a[1]=a[1]+r>>>0,a[2]=a[2]+s>>>0,a[3]=a[3]+i>>>0,a[4]=a[4]+l>>>0,a[5]=a[5]+d>>>0,a[6]=a[6]+p>>>0,a[7]=a[7]+u>>>0}const d=[];for(let e=0;e<7;e++)d.push((a[e]>>>24&255).toString(16).padStart(2,"0"),(a[e]>>>16&255).toString(16).padStart(2,"0"),(a[e]>>>8&255).toString(16).padStart(2,"0"),(255&a[e]).toString(16).padStart(2,"0"));return d.join("")}function rightRotate(e,n){return e>>>n|e<<32-n}function xhttp_sleep(e){return new Promise(n=>setTimeout(n,e))}function validate_uuid_xhttp(e,n){for(let t=0;t<16;t++)if(e[t]!==n[t])return!1;return!0}function concat_typed_arrays(e,...n){let t=e.length;for(let e of n)t+=e.length;const o=new e.constructor(t);o.set(e,0),t=e.length;for(let e of n)o.set(e,t),t+=e.length;return o}function parse_uuid_xhttp(e){e=e.replaceAll("-","");const n=[];for(let t=0;t<16;t++){const o=parseInt(e.substr(2*t,2),16);n.push(o)}return n}function get_xhttp_buffer(e){return new Uint8Array(new ArrayBuffer(e||XHTTP_BUFFER_SIZE))}async function read_xhttp_header(e,n){const t=e.getReader({mode:"byob"});try{let e=await t.readAtLeast(18,get_xhttp_buffer()),o=0,a=0,r=e.value;o+=e.value.length;const s=r[0],i=r.slice(1,17),l=parse_uuid_xhttp(n);if(!validate_uuid_xhttp(i,l))return"invalid UUID";const c=r[17],d=18+c+1+2+1;if(d+1>o){if(e.done)return"header too short";a=d+1-o,e=await t.readAtLeast(a,get_xhttp_buffer()),o+=e.value.length,r=concat_typed_arrays(r,e.value)}const p=r[18+c];if(1!==p)return`unsupported command: ${p}`;const u=(r[d-1-2]<<8)+r[d-1-1],f=r[d-1];let m=-1;if(f===ADDRESS_TYPE_IPV4?m=d+4:f===ADDRESS_TYPE_IPV6?m=d+16:f===ADDRESS_TYPE_URL&&(m=d+1+r[d]),m<0)return"read address type failed";if(a=m-o,a>0){if(e.done)return"read address failed";e=await t.readAtLeast(a,get_xhttp_buffer()),o+=e.value.length,r=concat_typed_arrays(r,e.value)}let g="";switch(a=d,f){case ADDRESS_TYPE_IPV4:g=r.slice(a,a+4).join(".");break;case ADDRESS_TYPE_URL:g=(new TextDecoder).decode(r.slice(a+1,a+1+r[a]));break;case ADDRESS_TYPE_IPV6:g=r.slice(a,a+16).reduce((e,n,t,o)=>t%2?e.concat(((o[t-1]<<8)+n).toString(16)):e,[]).join(":")}if(g.length<1)return"failed to parse hostname";const h=r.slice(m);return{hostname:g,port:u,data:h,resp:new Uint8Array([s,0]),reader:t,done:e.done}}catch(e){try{t.releaseLock()}catch(e){}throw e}}async function upload_to_remote_xhttp(e,n,t){async function o(t){if(t&&0!==t.length){e.add(t.length);try{await n.write(t)}catch(e){throw e}}}try{await o(t.data);let e=0;for(;!t.done;){const n=await t.reader.read(get_xhttp_buffer());if(n.done)break;await o(n.value),t.done=n.done,e++,e%10==0&&await xhttp_sleep(0),n.value&&0!==n.value.length||await xhttp_sleep(2)}}catch(e){throw e}}function create_xhttp_uploader(e,n){const t=new XhttpCounter,o=n.getWriter(),a=(async()=>{try{await upload_to_remote_xhttp(t,o,e)}catch(e){throw e}finally{try{await o.close()}catch(e){}}})();return{counter:t,done:a,abort:()=>{try{o.abort()}catch(e){}}}}function create_xhttp_downloader(e,n){const t=new XhttpCounter;let o;const a=new Promise((a,r)=>{o=new TransformStream({start(n){t.add(e.length),n.enqueue(e)},transform(e,n){t.add(e.length),n.enqueue(e)},cancel(e){r(`download cancelled: ${e}`)}},null,new ByteLengthQueuingStrategy({highWaterMark:XHTTP_BUFFER_SIZE}));let s=Date.now();const i=setInterval(()=>{if(Date.now()-s>IDLE_TIMEOUT_MS){try{o.writable.abort?.("idle timeout")}catch(e){}clearInterval(i),r("idle timeout")}},5e3),l=n.getReader(),c=o.writable.getWriter();(async()=>{try{let e=0;for(;;){const n=await l.read();if(n.done)break;s=Date.now(),await c.write(n.value),e++,e%5==0&&await xhttp_sleep(0)}await c.close(),a()}catch(e){r(e)}finally{try{l.releaseLock()}catch(e){}try{c.releaseLock()}catch(e){}clearInterval(i)}})()});return{readable:o.readable,counter:t,done:a,abort:()=>{try{o.readable.cancel()}catch(e){}try{o.writable.abort()}catch(e){}}}}async function connect_to_remote_xhttp(e,...n){let t,o=0;const a=[e.hostname,...n.filter(n=>n&&n!==e.hostname)];for(const n of a)if(n)for(o=0;o<MAX_RETRIES;){o++;try{const t=connect({hostname:n,port:e.port}),o=xhttp_sleep(CONNECT_TIMEOUT_MS).then(()=>{throw new Error(atob("Y29ubmVjdCB0aW1lb3V0"))});await Promise.race([t.opened,o]);const a=create_xhttp_uploader(e,t.writable),r=create_xhttp_downloader(e.resp,t.readable);return{downloader:r,uploader:a,close:()=>{try{t.close()}catch(e){}}}}catch(e){t=e,o<MAX_RETRIES&&await xhttp_sleep(500*o)}}return null}async function handle_xhttp_client(e,n){if(ACTIVE_CONNECTIONS>=MAX_CONCURRENT)return new Response("Too many connections",{status:429});ACTIVE_CONNECTIONS++;let t=!1;const o=()=>{t||(ACTIVE_CONNECTIONS=Math.max(0,ACTIVE_CONNECTIONS-1),t=!0)};try{const t=await read_xhttp_header(e,n);if("object"!=typeof t||!t)return null;const a=await connect_to_remote_xhttp(t,fallbackAddress,"13.230.34.30");if(null===a)return null;const r=Promise.race([(async()=>{try{await a.downloader.done}catch(e){}})(),(async()=>{try{await a.uploader.done}catch(e){}})(),xhttp_sleep(IDLE_TIMEOUT_MS).then(()=>{})]).finally(()=>{try{a.close()}catch(e){}try{a.downloader.abort()}catch(e){}try{a.uploader.abort()}catch(e){}o()});return{readable:a.downloader.readable,closed:r}}catch(e){return o(),null}}async function handleXhttpPost(e){try{return await handle_xhttp_client(e.body,at)}catch(e){return null}}function base64ToArray(e){if(!e)return{error:null};try{return e=e.replace(/-/g,"+").replace(/_/g,"/"),{earlyData:Uint8Array.from(atob(e),e=>e.charCodeAt(0)).buffer,error:null}}catch(e){return{error:e}}}function closeSocketQuietly(e){try{1!==e.readyState&&2!==e.readyState||e.close()}catch(e){}}function formatIdentifier(e,n=0){const t=(hexTable[e[n]]+hexTable[e[n+1]]+hexTable[e[n+2]]+hexTable[e[n+3]]+"-"+hexTable[e[n+4]]+hexTable[e[n+5]]+"-"+hexTable[e[n+6]]+hexTable[e[n+7]]+"-"+hexTable[e[n+8]]+hexTable[e[n+9]]+"-"+hexTable[e[n+10]]+hexTable[e[n+11]]+hexTable[e[n+12]]+hexTable[e[n+13]]+hexTable[e[n+14]]+hexTable[e[n+15]]).toLowerCase();if(!isValidFormat(t))throw new TypeError(E_INVALID_ID_STR);return t}async function fetchAndParseNewIPs(){const e=piu||"https://raw.githubusercontent.com/qwer-search/bestip/refs/heads/main/kejilandbestip.txt";try{const n=e.includes(",")?e.split(",").map(e=>e.trim()).filter(e=>e):[e],t=await fetchPreferredAPI(n,"443",5e3);if(t.length>0){const e=[],n=/^(\[[\da-fA-F:]+\]|[\d.]+|[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?)*)(?::(\d+))?(?:#(.+))?$/;for(const o of t){const t=o.match(n);t&&e.push({ip:t[1],port:parseInt(t[2]||"443",10),name:t[3]?.trim()||t[1]})}return e}const o=await fetch(e);if(!o.ok)return[];const a=await o.text(),r=[],s=a.trim().replace(/\r/g,"").split("\n"),i=/^([^:]+):(\d+)#(.*)$/;for(const e of s){const n=e.trim();if(!n)continue;const t=n.match(i);t&&r.push({ip:t[1],port:parseInt(t[2],10),name:t[3].trim()||t[1]})}return r}catch(e){return[]}}function generateLinksFromNewIPs(e,n,t,o=null){const a=[80,8080,8880,2052,2082,2086,2095],r=[443,2053,2083,2087,2096,8443],s=[],i="/?ed=2048",l=atob("dmxlc3M=");return e.forEach(e=>{const o=e.name.replace(/\s/g,"_"),c=e.port;if(r.includes(c)){const a=`${o}-${c}-WS-TLS`;let r=`${l}://${n}@${e.ip}:${c}?encryption=none&security=tls&sni=${t}&fp=${enableECH?"chrome":"randomized"}&type=ws&host=${t}&path=${i}`;if(enableECH){const e=customDNS||"https://dns.aliyuncs.com/dns-query",n=customECHDomain||"cloudflare-ech.com";r+=`&alpn=h3%2Ch2%2Chttp%2F1.1&ech=${encodeURIComponent(`${n}+${e}`)}`}r+=`#${encodeURIComponent(a)}`,s.push(r)}else if(a.includes(c)){if(!disableNonTLS){const a=`${o}-${c}-WS`,r=`${l}://${n}@${e.ip}:${c}?encryption=none&security=none&type=ws&host=${t}&path=${i}#${encodeURIComponent(a)}`;s.push(r)}}else{const a=`${o}-${c}-WS-TLS`;let r=`${l}://${n}@${e.ip}:${c}?encryption=none&security=tls&sni=${t}&fp=${enableECH?"chrome":"randomized"}&type=ws&host=${t}&path=${i}`;if(enableECH){const e=customDNS||"https://dns.aliyuncs.com/dns-query",n=customECHDomain||"cloudflare-ech.com";r+=`&alpn=h3%2Ch2%2Chttp%2F1.1&ech=${encodeURIComponent(`${n}+${e}`)}`}r+=`#${encodeURIComponent(a)}`,s.push(r)}}),s}function generateXhttpLinksFromSource(e,n,t,o=null){const a=[],r=n.substring(0,8);return e.forEach(e=>{let o=e.isp.replace(/\s/g,"_");e.colo&&e.colo.trim()&&(o=`${o}-${e.colo.trim()}`);const s=e.ip.includes(":")?`[${e.ip}]`:e.ip,i=e.port||443,l=`${o}-${i}-xhttp`,c=new URLSearchParams({encryption:"none",security:"tls",sni:t,fp:"chrome",type:"xhttp",host:t,path:`/${r}`,mode:"stream-one"});if(enableECH){const e=customDNS||"https://dns.aliyuncs.com/dns-query",n=customECHDomain||"cloudflare-ech.com";c.set("alpn","h3,h2,http/1.1"),c.set("ech",`${n}+${e}`)}a.push(`vless://${n}@${s}:${i}?${c.toString()}#${encodeURIComponent(l)}`)}),a}async function generateTrojanLinksFromNewIPs(e,n,t,o=null){const a=[80,8080,8880,2052,2082,2086,2095],r=[443,2053,2083,2087,2096,8443],s=[],i="/?ed=2048",l=tp||n;return e.forEach(e=>{const n=e.name.replace(/\s/g,"_"),o=e.port;if(r.includes(o)){const a=`${n}-${o}-${atob("VHJvamFu")}-WS-TLS`;let r=`${atob("dHJvamFuOi8v")}${l}@${e.ip}:${o}?security=tls&sni=${t}&fp=chrome&type=ws&host=${t}&path=${i}`;if(enableECH){const e=customDNS||"https://dns.aliyuncs.com/dns-query",n=customECHDomain||"cloudflare-ech.com";r+=`&alpn=h3%2Ch2%2Chttp%2F1.1&ech=${encodeURIComponent(`${n}+${e}`)}`}r+=`#${encodeURIComponent(a)}`,s.push(r)}else if(a.includes(o)){if(!disableNonTLS){const a=`${n}-${o}-${atob("VHJvamFu")}-WS`,r=`${atob("dHJvamFuOi8v")}${l}@${e.ip}:${o}?security=none&type=ws&host=${t}&path=${i}#${encodeURIComponent(a)}`;s.push(r)}}else{const a=`${n}-${o}-${atob("VHJvamFu")}-WS-TLS`;let r=`${atob("dHJvamFuOi8v")}${l}@${e.ip}:${o}?security=tls&sni=${t}&fp=chrome&type=ws&host=${t}&path=${i}`;if(enableECH){const e=customDNS||"https://dns.aliyuncs.com/dns-query",n=customECHDomain||"cloudflare-ech.com";r+=`&alpn=h3%2Ch2%2Chttp%2F1.1&ech=${encodeURIComponent(`${n}+${e}`)}`}r+=`#${encodeURIComponent(a)}`,s.push(r)}}),s}async function handleConfigAPI(e){if("GET"===e.method)return kvStore?new Response(JSON.stringify({...kvConfig,kvEnabled:!0}),{headers:{"Content-Type":"application/json"}}):new Response(JSON.stringify({error:"KVå­˜å‚¨æœªé…ç½®",kvEnabled:!1}),{status:503,headers:{"Content-Type":"application/json"}});if("POST"===e.method){if(!kvStore)return new Response(JSON.stringify({success:!1,message:"KVå­˜å‚¨æœªé…ç½®ï¼Œæ— æ³•ä¿å­˜é…ç½®"}),{status:503,headers:{"Content-Type":"application/json"}});try{const n=await e.json();for(const[e,t]of Object.entries(n))""===t||null==t?delete kvConfig[e]:kvConfig[e]=t;await saveKVConfig(),updateConfigVariables(),void 0!==n.yx&&updateCustomPreferredFromYx();const t=getConfigValue("yxURL","")||"https://raw.githubusercontent.com/qwer-search/bestip/refs/heads/main/kejilandbestip.txt",o="https://raw.githubusercontent.com/qwer-search/bestip/refs/heads/main/kejilandbestip.txt";return t!==o?(directDomains.length=0,customPreferredIPs=[],customPreferredDomains=[]):(backupIPs=[{domain:"ProxyIP.US.CMLiussss.net",region:"US",regionCode:"US",port:443},{domain:"ProxyIP.SG.CMLiussss.net",region:"SG",regionCode:"SG",port:443},{domain:"ProxyIP.JP.CMLiussss.net",region:"JP",regionCode:"JP",port:443},{domain:"ProxyIP.KR.CMLiussss.net",region:"KR",regionCode:"KR",port:443},{domain:"ProxyIP.DE.CMLiussss.net",region:"DE",regionCode:"DE",port:443},{domain:"ProxyIP.SE.CMLiussss.net",region:"SE",regionCode:"SE",port:443},{domain:"ProxyIP.NL.CMLiussss.net",region:"NL",regionCode:"NL",port:443},{domain:"ProxyIP.FI.CMLiussss.net",region:"FI",regionCode:"FI",port:443},{domain:"ProxyIP.GB.CMLiussss.net",region:"GB",regionCode:"GB",port:443},{domain:"ProxyIP.Oracle.cmliussss.net",region:"Oracle",regionCode:"Oracle",port:443},{domain:"ProxyIP.DigitalOcean.CMLiussss.net",region:"DigitalOcean",regionCode:"DigitalOcean",port:443},{domain:"ProxyIP.Vultr.CMLiussss.net",region:"Vultr",regionCode:"Vultr",port:443},{domain:"ProxyIP.Multacom.CMLiussss.net",region:"Multacom",regionCode:"Multacom",port:443}],directDomains.length=0,directDomains.push({name:"cloudflare.182682.xyz",domain:"cloudflare.182682.xyz"},{name:"speed.marisalnc.com",domain:"speed.marisalnc.com"},{domain:"freeyx.cloudflare88.eu.org"},{domain:"bestcf.top"},{domain:"cdn.2020111.xyz"},{domain:"cfip.cfcdn.vip"},{domain:"cf.0sm.com"},{domain:"cf.090227.xyz"},{domain:"cf.zhetengsha.eu.org"},{domain:"cloudflare.9jy.cc"},{domain:"cf.zerone-cdn.pp.ua"},{domain:"cfip.1323123.xyz"},{domain:"cnamefuckxxs.yuchen.icu"},{domain:"cloudflare-ip.mofashi.ltd"},{domain:"115155.xyz"},{domain:"cname.xirancdn.us"},{domain:"f3058171cad.002404.xyz"},{domain:"8.889288.xyz"},{domain:"cdn.tzpro.xyz"},{domain:"cf.877771.xyz"},{domain:"xn--b6gac.eu.org"})),new Response(JSON.stringify({success:!0,message:"é…ç½®å·²ä¿å­˜",config:kvConfig}),{headers:{"Content-Type":"application/json"}})}catch(e){return new Response(JSON.stringify({success:!1,message:"ä¿å­˜é…ç½®å¤±è´¥: "+e.message}),{status:500,headers:{"Content-Type":"application/json"}})}}return new Response(JSON.stringify({error:"Method not allowed"}),{status:405,headers:{"Content-Type":"application/json"}})}async function handlePreferredIPsAPI(e){if(!kvStore)return new Response(JSON.stringify({success:!1,error:"KVå­˜å‚¨æœªé…ç½®",message:"éœ€è¦é…ç½®KVå­˜å‚¨æ‰èƒ½ä½¿ç”¨æ­¤åŠŸèƒ½"}),{status:503,headers:{"Content-Type":"application/json"}});const n="yes"===getConfigValue("ae","");if(!n)return new Response(JSON.stringify({success:!1,error:"APIåŠŸèƒ½æœªå¯ç”¨",message:'å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä¼˜é€‰IP APIåŠŸèƒ½é»˜è®¤å…³é—­ã€‚è¯·åœ¨é…ç½®ç®¡ç†é¡µé¢å¼€å¯"å…è®¸APIç®¡ç†"é€‰é¡¹åä½¿ç”¨ã€‚'}),{status:403,headers:{"Content-Type":"application/json"}});try{if("GET"===e.method){const e=getConfigValue("yx",""),n=parseYxToArray(e);return new Response(JSON.stringify({success:!0,count:n.length,data:n}),{headers:{"Content-Type":"application/json"}})}if("POST"===e.method){const n=await e.json(),t=Array.isArray(n)?n:[n];if(0===t.length)return new Response(JSON.stringify({success:!1,error:"è¯·æ±‚æ•°æ®ä¸ºç©º",message:"è¯·æä¾›IPæ•°æ®"}),{status:400,headers:{"Content-Type":"application/json"}});const o=getConfigValue("yx","");let a=parseYxToArray(o);const r=[],s=[],i=[];for(const e of t){if(!e.ip){i.push({ip:"æœªçŸ¥",reason:"IPåœ°å€æ˜¯å¿…éœ€çš„"});continue}const n=e.port||443,t=e.name||`APIä¼˜é€‰-${e.ip}:${n}`;if(!isValidIP(e.ip)&&!isValidDomain(e.ip)){i.push({ip:e.ip,reason:"æ— æ•ˆçš„IPæˆ–åŸŸåæ ¼å¼"});continue}const o=a.some(t=>t.ip===e.ip&&t.port===n);if(o){s.push({ip:e.ip,port:n,reason:"å·²å­˜åœ¨"});continue}const l={ip:e.ip,port:n,name:t,addedAt:(new Date).toISOString()};a.push(l),r.push(l)}if(r.length>0){const e=arrayToYx(a);await setConfigValue("yx",e),updateCustomPreferredFromYx()}return new Response(JSON.stringify({success:r.length>0,message:`æˆåŠŸæ·»åŠ  ${r.length} ä¸ªIP`,added:r.length,skipped:s.length,errors:i.length,data:{addedIPs:r,skippedIPs:s.length>0?s:void 0,errors:i.length>0?i:void 0}}),{headers:{"Content-Type":"application/json"}})}if("DELETE"===e.method){const n=await e.json();if(!0===n.all){const e=getConfigValue("yx",""),n=parseYxToArray(e),t=n.length;return await setConfigValue("yx",""),updateCustomPreferredFromYx(),new Response(JSON.stringify({success:!0,message:`å·²æ¸…ç©ºæ‰€æœ‰ä¼˜é€‰IPï¼Œå…±åˆ é™¤ ${t} ä¸ª`,deletedCount:t}),{headers:{"Content-Type":"application/json"}})}if(!n.ip)return new Response(JSON.stringify({success:!1,error:"IPåœ°å€æ˜¯å¿…éœ€çš„",message:'è¯·æä¾›è¦åˆ é™¤çš„ipå­—æ®µï¼Œæˆ–ä½¿ç”¨ {"all": true} æ¸…ç©ºæ‰€æœ‰'}),{status:400,headers:{"Content-Type":"application/json"}});const t=n.port||443,o=getConfigValue("yx","");let a=parseYxToArray(o);const r=a.length,s=a.filter(e=>!(e.ip===n.ip&&e.port===t));if(s.length===r)return new Response(JSON.stringify({success:!1,error:"ä¼˜é€‰IPä¸å­˜åœ¨",message:`${n.ip}:${t} æœªæ‰¾åˆ°`}),{status:404,headers:{"Content-Type":"application/json"}});const i=arrayToYx(s);return await setConfigValue("yx",i),updateCustomPreferredFromYx(),new Response(JSON.stringify({success:!0,message:"ä¼˜é€‰IPå·²åˆ é™¤",deleted:{ip:n.ip,port:t}}),{headers:{"Content-Type":"application/json"}})}return new Response(JSON.stringify({success:!1,error:"ä¸æ”¯æŒçš„è¯·æ±‚æ–¹æ³•",message:"æ”¯æŒçš„æ–¹æ³•: GET, POST, DELETE"}),{status:405,headers:{"Content-Type":"application/json"}})}catch(e){return new Response(JSON.stringify({success:!1,error:"å¤„ç†è¯·æ±‚å¤±è´¥",message:e.message}),{status:500,headers:{"Content-Type":"application/json"}})}}function updateConfigVariables(){const e=getConfigValue("wk","");if(e&&e.trim())manualWorkerRegion=e.trim().toUpperCase(),currentWorkerRegion=manualWorkerRegion;else{const e=getConfigValue("p","");e&&e.trim()?currentWorkerRegion="CUSTOM":manualWorkerRegion=""}const n=getConfigValue("rm","");enableRegionMatching=!n||"no"!==n.toLowerCase();const t=getConfigValue("ev","");void 0!==t&&""!==t&&(ev="yes"===t||!0===t||"true"===t);const o=getConfigValue("et","");void 0!==o&&""!==o&&(et="yes"===o||!0===o||"true"===o),tp=getConfigValue("tp","")||"";const a=getConfigValue("ex","");void 0!==a&&""!==a&&(ex="yes"===a||!0===a||"true"===a),ev||et||ex||(ev=!0),scu=getConfigValue("scu","")||"https://url.v1.mk/sub";const r=getConfigValue("epd","no");void 0!==r&&""!==r&&(epd="no"!==r&&!1!==r&&"false"!==r);const s=getConfigValue("epi","");void 0!==s&&""!==s&&(epi="no"!==s&&!1!==s&&"false"!==s);const i=getConfigValue("egi","");void 0!==i&&""!==i&&(egi="no"!==i&&!1!==i&&"false"!==i);const l=getConfigValue("ech","");void 0!==l&&""!==l&&(enableECH="yes"===l||!0===l||"true"===l);const c=getConfigValue("customDNS","");customDNS=c&&c.trim()?c.trim():"https://dns.alidns.com/dns-query";const d=getConfigValue("customECHDomain","");customECHDomain=d&&d.trim()?d.trim():"cloudflare-ech.com",enableECH&&(disableNonTLS=!0);const p=getConfigValue("dkby","");p&&"yes"===p.toLowerCase()&&(disableNonTLS=!0),cp=getConfigValue("d","")||"",piu=getConfigValue("yxURL","")||"https://raw.githubusercontent.com/qwer-search/bestip/refs/heads/main/kejilandbestip.txt";const u=getConfigValue("p","");if(fallbackAddress=u?u.trim():"",socks5Config=getConfigValue("s","")||"",socks5Config)try{parsedSocks5Config=parseSocksConfig(socks5Config),isSocksEnabled=!0}catch(e){isSocksEnabled=!1}else isSocksEnabled=!1;const f=getConfigValue("yxby","");disablePreferred=!(!f||"yes"!==f.toLowerCase());const m="https://raw.githubusercontent.com/qwer-search/bestip/refs/heads/main/kejilandbestip.txt";piu!==m&&(directDomains.length=0,customPreferredIPs=[],customPreferredDomains=[])}function updateCustomPreferredFromYx(){const e=getConfigValue("yx","");if(e)try{const n=e.split(",").map(e=>e.trim()).filter(e=>e);customPreferredIPs=[],customPreferredDomains=[],n.forEach(e=>{let n="",t=e;if(e.includes("#")){const o=e.split("#");t=o[0].trim(),n=o[1].trim()}const{address:o,port:a}=parseAddressAndPort(t);n||(n="è‡ªå®šä¹‰ä¼˜é€‰-"+o+(a?":"+a:"")),isValidIP(o)?customPreferredIPs.push({ip:o,port:a,isp:n}):customPreferredDomains.push({domain:o,port:a,name:n})})}catch(e){customPreferredIPs=[],customPreferredDomains=[]}else customPreferredIPs=[],customPreferredDomains=[]}function parseYxToArray(e){if(!e||!e.trim())return[];const n=e.split(",").map(e=>e.trim()).filter(e=>e),t=[];for(const e of n){let n="",o=e;if(e.includes("#")){const t=e.split("#");o=t[0].trim(),n=t[1].trim()}const{address:a,port:r}=parseAddressAndPort(o);n||(n=a+(r?":"+r:"")),t.push({ip:a,port:r||443,name:n,addedAt:(new Date).toISOString()})}return t}function arrayToYx(e){return e&&0!==e.length?e.map(e=>{const n=e.port||443;return`${e.ip}:${n}#${e.name}`}).join(","):""}function isValidDomain(e){const n=/^(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/;return n.test(e)}async function parseTextToArray(e){var n=e.replace(/[	"'\r\n]+/g,",").replace(/,+/g,",");return","==n.charAt(0)&&(n=n.slice(1)),","==n.charAt(n.length-1)&&(n=n.slice(0,n.length-1)),n.split(",")}async function fetchPreferredAPI(e,n="443",t=3e3){if(!e?.length)return[];const o=new Set;return await Promise.allSettled(e.map(async e=>{try{const a=new AbortController,r=setTimeout(()=>a.abort(),t),s=await fetch(e,{signal:a.signal});clearTimeout(r);let i="";try{const e=await s.arrayBuffer(),n=(s.headers.get("content-type")||"").toLowerCase(),t=n.match(/charset=([^\s;]+)/i)?.[1]?.toLowerCase()||"";let o=["utf-8","gb2312"];(t.includes("gb")||t.includes("gbk")||t.includes("gb2312"))&&(o=["gb2312","utf-8"]);let a=!1;for(const n of o)try{const t=new TextDecoder(n).decode(e);if(t&&t.length>0&&!t.includes("ï¿½")){i=t,a=!0;break}if(t&&t.length>0)continue}catch(e){continue}if(a||(i=await s.text()),!i||0===i.trim().length)return}catch(e){return}const l=i.trim().split("\n").map(e=>e.trim()).filter(e=>e),c=l.length>1&&l[0].includes(","),d=/^[^\[\]]*:[^\[\]]*:[^\[\]]/;if(c){const t=l[0].split(",").map(e=>e.trim()),a=l.slice(1);if(t.includes("IPåœ°å€")&&t.includes("ç«¯å£")&&t.includes("æ•°æ®ä¸­å¿ƒ")){const e=t.indexOf("IPåœ°å€"),n=t.indexOf("ç«¯å£"),r=t.indexOf("å›½å®¶")>-1?t.indexOf("å›½å®¶"):t.indexOf("åŸå¸‚")>-1?t.indexOf("åŸå¸‚"):t.indexOf("æ•°æ®ä¸­å¿ƒ"),s=t.indexOf("TLS");a.forEach(t=>{const a=t.split(",").map(e=>e.trim());if(-1!==s&&"true"!==a[s]?.toLowerCase())return;const i=d.test(a[e])?`[${a[e]}]`:a[e];o.add(`${i}:${a[n]}#${a[r]}`)})}else if(t.some(e=>e.includes("IP"))&&t.some(e=>e.includes("å»¶è¿Ÿ"))&&t.some(e=>e.includes("ä¸‹è½½é€Ÿåº¦"))){const r=t.findIndex(e=>e.includes("IP")),s=t.findIndex(e=>e.includes("å»¶è¿Ÿ")),i=t.findIndex(e=>e.includes("ä¸‹è½½é€Ÿåº¦")),l=new URL(e).searchParams.get("port")||n;a.forEach(e=>{const n=e.split(",").map(e=>e.trim()),t=d.test(n[r])?`[${n[r]}]`:n[r];o.add(`${t}:${l}#CFä¼˜é€‰ ${n[s]}ms ${n[i]}MB/s`)})}}else l.forEach(t=>{const a=t.indexOf("#"),[r,s]=a>-1?[t.substring(0,a),t.substring(a)]:[t,""];let i=!1;if(r.startsWith("["))i=/\]:(\d+)$/.test(r);else{const e=r.lastIndexOf(":");i=e>-1&&/^\d+$/.test(r.substring(e+1))}const l=new URL(e).searchParams.get("port")||n;o.add(i?t:`${r}:${l}${s}`)})}catch(e){}})),Array.from(o)}import{connect}from"cloudflare:sockets";let at="eb262793-1d12-4501-9282-d24b85c0f574",fallbackAddress="",socks5Config="",customPreferredIPs=[],customPreferredDomains=[],enableSocksDowngrade=!1,disableNonTLS=!0,disablePreferred=!1,enableRegionMatching=!0,currentWorkerRegion="",manualWorkerRegion="",piu="",cp="",ev=!0,et=!1,ex=!1,tp="",enableECH=!0,customDNS="https://dns.alidns.com/dns-query",customECHDomain="cloudflare-ech.com",scu="https://url.v1.mk/sub";const remoteConfigUrl="https://raw.githubusercontent.com/dgutyanghs/CF-ECH/refs/heads/main/tist.ini";let epd=!1,epi=!0,egi=!0,kvStore=null,kvConfig={};const regionMapping={US:["ğŸ‡ºğŸ‡¸ ç¾å›½","US","United States"],SG:["ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡","SG","Singapore"],JP:["ğŸ‡¯ğŸ‡µ æ—¥æœ¬","JP","Japan"],KR:["ğŸ‡°ğŸ‡· éŸ©å›½","KR","South Korea"],DE:["ğŸ‡©ğŸ‡ª å¾·å›½","DE","Germany"],SE:["ğŸ‡¸ğŸ‡ª ç‘å…¸","SE","Sweden"],NL:["ğŸ‡³ğŸ‡± è·å…°","NL","Netherlands"],FI:["ğŸ‡«ğŸ‡® èŠ¬å…°","FI","Finland"],GB:["ğŸ‡¬ğŸ‡§ è‹±å›½","GB","United Kingdom"],Oracle:["ç”²éª¨æ–‡","Oracle"],DigitalOcean:["æ•°ç æµ·","DigitalOcean"],Vultr:["Vultr","Vultr"],Multacom:["Multacom","Multacom"]};let backupIPs=[{domain:"ProxyIP.US.CMLiussss.net",region:"US",regionCode:"US",port:443},{domain:"ProxyIP.SG.CMLiussss.net",region:"SG",regionCode:"SG",port:443},{domain:"ProxyIP.JP.CMLiussss.net",region:"JP",regionCode:"JP",port:443},{domain:"ProxyIP.KR.CMLiussss.net",region:"KR",regionCode:"KR",port:443},{domain:"ProxyIP.DE.CMLiussss.net",region:"DE",regionCode:"DE",port:443},{domain:"ProxyIP.SE.CMLiussss.net",region:"SE",regionCode:"SE",port:443},{domain:"ProxyIP.NL.CMLiussss.net",region:"NL",regionCode:"NL",port:443},{domain:"ProxyIP.FI.CMLiussss.net",region:"FI",regionCode:"FI",port:443},{domain:"ProxyIP.GB.CMLiussss.net",region:"GB",regionCode:"GB",port:443},{domain:"ProxyIP.Oracle.cmliussss.net",region:"Oracle",regionCode:"Oracle",port:443},{domain:"ProxyIP.DigitalOcean.CMLiussss.net",region:"DigitalOcean",regionCode:"DigitalOcean",port:443},{domain:"ProxyIP.Vultr.CMLiussss.net",region:"Vultr",regionCode:"Vultr",port:443},{domain:"ProxyIP.Multacom.CMLiussss.net",region:"Multacom",regionCode:"Multacom",port:443}];const directDomains=[{name:"cloudflare.182682.xyz",domain:"cloudflare.182682.xyz"},{name:"speed.marisalnc.com",domain:"speed.marisalnc.com"},{domain:"freeyx.cloudflare88.eu.org"},{domain:"bestcf.top"},{domain:"cdn.2020111.xyz"},{domain:"cfip.cfcdn.vip"},{domain:"cf.0sm.com"},{domain:"cf.090227.xyz"},{domain:"cf.zhetengsha.eu.org"},{domain:"cloudflare.9jy.cc"},{domain:"cf.zerone-cdn.pp.ua"},{domain:"cfip.1323123.xyz"},{domain:"cnamefuckxxs.yuchen.icu"},{domain:"cloudflare-ip.mofashi.ltd"},{domain:"115155.xyz"},{domain:"cname.xirancdn.us"},{domain:"f3058171cad.002404.xyz"},{domain:"8.889288.xyz"},{domain:"cdn.tzpro.xyz"},{domain:"cf.877771.xyz"},{domain:"xn--b6gac.eu.org"}],E_INVALID_DATA=atob("aW52YWxpZCBkYXRh"),E_INVALID_USER=atob("aW52YWxpZCB1c2Vy"),E_UNSUPPORTED_CMD=atob("Y29tbWFuZCBpcyBub3Qgc3VwcG9ydGVk"),E_UDP_DNS_ONLY=atob("VURQIHByb3h5IG9ubHkgZW5hYmxlIGZvciBETlMgd2hpY2ggaXMgcG9ydCA1Mw=="),E_INVALID_ADDR_TYPE=atob("aW52YWxpZCBhZGRyZXNzVHlwZQ=="),E_EMPTY_ADDR=atob("YWRkcmVzc1ZhbHVlIGlzIGVtcHR5"),E_WS_NOT_OPEN=atob("d2ViU29ja2V0LmVhZHlTdGF0ZSBpcyBub3Qgb3Blbg=="),E_INVALID_ID_STR=atob("U3RyaW5naWZpZWQgaWRlbnRpZmllciBpcyBpbnZhbGlk"),E_INVALID_SOCKS_ADDR=atob("SW52YWxpZCBTT0NLUyBhZGRyZXNzIGZvcm1hdA=="),E_SOCKS_NO_METHOD=atob("bm8gYWNjZXB0YWJsZSBtZXRob2Rz"),E_SOCKS_AUTH_NEEDED=atob("c29ja3Mgc2VydmVyIG5lZWRzIGF1dGg="),E_SOCKS_AUTH_FAIL=atob("ZmFpbCB0byBhdXRoIHNvY2tzIHNlcnZlcg=="),E_SOCKS_CONN_FAIL=atob("ZmFpbCB0byBvcGVuIHNvY2tzIGNvbm5lY3Rpb24=");let parsedSocks5Config={},isSocksEnabled=!1;const ADDRESS_TYPE_IPV4=1,ADDRESS_TYPE_URL=2,ADDRESS_TYPE_IPV6=3;export default{async fetch(e,n,t){try{await initKVStore(n),at=(n.u||n.U||at).toLowerCase();const o=(n.d||n.D||at).toLowerCase(),a=getConfigValue("p",n.p||n.P);let r=!1;const s=getConfigValue("wk",n.wk||n.WK);s&&s.trim()?(manualWorkerRegion=s.trim().toUpperCase(),currentWorkerRegion=manualWorkerRegion):a&&a.trim()?(r=!0,currentWorkerRegion="CUSTOM"):currentWorkerRegion=await detectWorkerRegion(e);const i=n.rm||n.RM;i&&"no"===i.toLowerCase()&&(enableRegionMatching=!1);const l=getConfigValue("p",n.p||n.P);if(l&&(fallbackAddress=l.trim()),socks5Config=getConfigValue("s",n.s||n.S)||socks5Config,socks5Config)try{parsedSocks5Config=parseSocksConfig(socks5Config),isSocksEnabled=!0}catch(e){isSocksEnabled=!1}const c=getConfigValue("yx",n.yx||n.YX);if(c)try{const e=c.split(",").map(e=>e.trim()).filter(e=>e);customPreferredIPs=[],customPreferredDomains=[],e.forEach(e=>{let n="",t=e;if(e.includes("#")){const o=e.split("#");t=o[0].trim(),n=o[1].trim()}const{address:o,port:a}=parseAddressAndPort(t);n||(n="è‡ªå®šä¹‰ä¼˜é€‰-"+o+(a?":"+a:"")),isValidIP(o)?customPreferredIPs.push({ip:o,port:a,isp:n}):customPreferredDomains.push({domain:o,port:a,name:n})})}catch(e){customPreferredIPs=[],customPreferredDomains=[]}const d=getConfigValue("qj",n.qj||n.QJ);d&&"no"===d.toLowerCase()&&(enableSocksDowngrade=!0);const p=getConfigValue("dkby",n.dkby||n.DKBY);p&&"yes"===p.toLowerCase()&&(disableNonTLS=!0);const u=n.yxby||n.YXBY;u&&"yes"===u.toLowerCase()&&(disablePreferred=!0);const f=getConfigValue("ev",n.ev);void 0!==f&&""!==f&&(ev="yes"===f||!0===f||"true"===f);const m=getConfigValue("et",n.et);void 0!==m&&""!==m&&(et="yes"===m||!0===m||"true"===m),tp=getConfigValue("tp",n.tp)||"";const g=getConfigValue("ex",n.ex);void 0!==g&&""!==g&&(ex="yes"===g||!0===g||"true"===g),scu=getConfigValue("scu",n.scu)||"https://url.v1.mk/sub";const h=getConfigValue("epd",n.epd||"no");void 0!==h&&""!==h&&(epd="no"!==h&&!1!==h&&"false"!==h);const y=getConfigValue("epi",n.epi);void 0!==y&&""!==y&&(epi="no"!==y&&!1!==y&&"false"!==y);const b=getConfigValue("egi",n.egi);void 0!==b&&""!==b&&(egi="no"!==b&&!1!==b&&"false"!==b);const x=getConfigValue("ech",n.ech);void 0!==x&&""!==x&&(enableECH="yes"===x||!0===x||"true"===x);const C=getConfigValue("customDNS","");C&&C.trim()&&(customDNS=C.trim());const I=getConfigValue("customECHDomain","");if(I&&I.trim()&&(customECHDomain=I.trim()),enableECH){disableNonTLS=!0;const e=getConfigValue("dkby","");"yes"!==e&&await setConfigValue("dkby","yes")}ev||et||ex||(ev=!0),piu=getConfigValue("yxURL",n.yxURL||n.YXURL)||"https://raw.githubusercontent.com/qwer-search/bestip/refs/heads/main/kejilandbestip.txt",cp=getConfigValue("d",n.d||n.D)||"";const w="https://raw.githubusercontent.com/qwer-search/bestip/refs/heads/main/kejilandbestip.txt";piu!==w&&(directDomains.length=0,customPreferredIPs=[],customPreferredDomains=[]);const v=new URL(e.url);if(v.pathname.includes("/api/config")){const n=v.pathname.split("/").filter(e=>e),t=n.indexOf("api");if(t>0){const o=n.slice(0,t),a=o.join("/");let r=!1;if(cp&&cp.trim()){const e=cp.trim().startsWith("/")?cp.trim().substring(1):cp.trim();r=a===e}else r=isValidFormat(a)&&a===at;return r?await handleConfigAPI(e):new Response(JSON.stringify({error:"è·¯å¾„éªŒè¯å¤±è´¥"}),{status:403,headers:{"Content-Type":"application/json"}})}return new Response(JSON.stringify({error:"æ— æ•ˆçš„APIè·¯å¾„"}),{status:404,headers:{"Content-Type":"application/json"}})}if(v.pathname.includes("/api/preferred-ips")){const n=v.pathname.split("/").filter(e=>e),t=n.indexOf("api");if(t>0){const o=n.slice(0,t),a=o.join("/");let r=!1;if(cp&&cp.trim()){const e=cp.trim().startsWith("/")?cp.trim().substring(1):cp.trim();r=a===e}else r=isValidFormat(a)&&a===at;return r?await handlePreferredIPsAPI(e):new Response(JSON.stringify({error:"è·¯å¾„éªŒè¯å¤±è´¥"}),{status:403,headers:{"Content-Type":"application/json"}})}return new Response(JSON.stringify({error:"æ— æ•ˆçš„APIè·¯å¾„"}),{status:404,headers:{"Content-Type":"application/json"}})}if("POST"===e.method&&ex){const n=await handleXhttpPost(e)
;return n?(t.waitUntil(n.closed),new Response(n.readable,{headers:{"X-Accel-Buffering":"no","Cache-Control":"no-store",Connection:"keep-alive","User-Agent":"Go-http-client/2.0","Content-Type":"application/grpc"}})):new Response("Internal Server Error",{status:500})}if(e.headers.get("Upgrade")===atob("d2Vic29ja2V0"))return await handleWsRequest(e);if("GET"===e.method){if(v.pathname.endsWith("/region")){const t=v.pathname.split("/").filter(e=>e);if(2===t.length&&"region"===t[1]){const o=t[0];let a=!1;if(cp&&cp.trim()){const e=cp.trim().startsWith("/")?cp.trim().substring(1):cp.trim();a=o===e}else a=isValidFormat(o)&&o===at;if(a){const t=getConfigValue("p",n.p||n.P),o=getConfigValue("wk",n.wk||n.WK);if(o&&o.trim())return new Response(JSON.stringify({region:o.trim().toUpperCase(),detectionMethod:"æ‰‹åŠ¨æŒ‡å®šåœ°åŒº",manualRegion:o.trim().toUpperCase(),timestamp:(new Date).toISOString()}),{headers:{"Content-Type":"application/json"}});if(t&&t.trim())return new Response(JSON.stringify({region:"CUSTOM",detectionMethod:"è‡ªå®šä¹‰ProxyIPæ¨¡å¼",ci:t,timestamp:(new Date).toISOString()}),{headers:{"Content-Type":"application/json"}});{const n=await detectWorkerRegion(e);return new Response(JSON.stringify({region:n,detectionMethod:"APIæ£€æµ‹",timestamp:(new Date).toISOString()}),{headers:{"Content-Type":"application/json"}})}}return new Response(JSON.stringify({error:"è®¿é—®è¢«æ‹’ç»",message:"è·¯å¾„éªŒè¯å¤±è´¥"}),{status:403,headers:{"Content-Type":"application/json"}})}}if(v.pathname.endsWith("/test-api")){const n=v.pathname.split("/").filter(e=>e);if(2===n.length&&"test-api"===n[1]){const t=n[0];let o=!1;if(cp&&cp.trim()){const e=cp.trim().startsWith("/")?cp.trim().substring(1):cp.trim();o=t===e}else o=isValidFormat(t)&&t===at;if(!o)return new Response(JSON.stringify({error:"è®¿é—®è¢«æ‹’ç»",message:"è·¯å¾„éªŒè¯å¤±è´¥"}),{status:403,headers:{"Content-Type":"application/json"}});try{const n=await detectWorkerRegion(e);return new Response(JSON.stringify({detectedRegion:n,message:"APIæµ‹è¯•å®Œæˆ",timestamp:(new Date).toISOString()}),{headers:{"Content-Type":"application/json"}})}catch(e){return new Response(JSON.stringify({error:e.message,message:"APIæµ‹è¯•å¤±è´¥"}),{status:500,headers:{"Content-Type":"application/json"}})}}}if("/"===v.pathname){const t=getConfigValue("homepage",n.homepage||n.HOMEPAGE);if(t&&t.trim())try{const n=await fetch(t.trim(),{method:"GET",headers:{"User-Agent":e.headers.get("User-Agent")||"Mozilla/5.0",Accept:e.headers.get("Accept")||"*/*","Accept-Language":e.headers.get("Accept-Language")||"en-US,en;q=0.9"},redirect:"follow"});if(n.ok){const e=n.headers.get("Content-Type")||"text/html; charset=utf-8",t=await n.text();return new Response(t,{status:n.status,headers:{"Content-Type":e,"Cache-Control":"no-cache, no-store, must-revalidate"}})}}catch(e){console.error("è·å–è‡ªå®šä¹‰é¦–é¡µå¤±è´¥:",e)}const o=e.headers.get("Cookie")||"";let a=null;if(o){const e=o.split(";").map(e=>e.trim());for(const n of e)if(n.startsWith("preferredLanguage=")){a=n.split("=")[1];break}}let r=!1;if("fa"===a||"fa-IR"===a)r=!0;else if("zh"===a||"zh-CN"===a)r=!1;else{const n=e.headers.get("Accept-Language")||"",t=n.split(",")[0].split("-")[0].toLowerCase();r="fa"===t||n.includes("fa-IR")||n.includes("fa")}const s=r?"fa-IR":"zh-CN",i={zh:{title:"ç»ˆç«¯",terminal:"ç»ˆç«¯",congratulations:"æ­å–œä½ æ¥åˆ°è¿™",enterU:"è¯·è¾“å…¥ä½ Uå˜é‡çš„å€¼",enterD:"è¯·è¾“å…¥ä½ Då˜é‡çš„å€¼",command:"å‘½ä»¤: connect [",uuid:"UUID",path:"PATH",inputU:"è¾“å…¥Uå˜é‡çš„å†…å®¹å¹¶ä¸”å›è½¦...",inputD:"è¾“å…¥Då˜é‡çš„å†…å®¹å¹¶ä¸”å›è½¦...",connecting:"æ­£åœ¨è¿æ¥...",invading:"æ­£åœ¨å…¥ä¾µ...",success:"è¿æ¥æˆåŠŸï¼è¿”å›ç»“æœ...",error:"é”™è¯¯: æ— æ•ˆçš„UUIDæ ¼å¼",reenter:"è¯·é‡æ–°è¾“å…¥æœ‰æ•ˆçš„UUID"},fa:{title:"ØªØ±Ù…ÛŒÙ†Ø§Ù„",terminal:"ØªØ±Ù…ÛŒÙ†Ø§Ù„",congratulations:"ØªØ¨Ø±ÛŒÚ© Ù…ÛŒâ€ŒÚ¯ÙˆÛŒÛŒÙ… Ø¨Ù‡ Ø´Ù…Ø§",enterU:"Ù„Ø·ÙØ§ Ù…Ù‚Ø¯Ø§Ø± Ù…ØªØºÛŒØ± U Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯",enterD:"Ù„Ø·ÙØ§ Ù…Ù‚Ø¯Ø§Ø± Ù…ØªØºÛŒØ± D Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯",command:"Ø¯Ø³ØªÙˆØ±: connect [",uuid:"UUID",path:"PATH",inputU:"Ù…Ø­ØªÙˆÛŒØ§Øª Ù…ØªØºÛŒØ± U Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡ Ùˆ Enter Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯...",inputD:"Ù…Ø­ØªÙˆÛŒØ§Øª Ù…ØªØºÛŒØ± D Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡ Ùˆ Enter Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯...",connecting:"Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„...",invading:"Ø¯Ø± Ø­Ø§Ù„ Ù†ÙÙˆØ°...",success:"Ø§ØªØµØ§Ù„ Ù…ÙˆÙÙ‚! Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª Ù†ØªÛŒØ¬Ù‡...",error:"Ø®Ø·Ø§: ÙØ±Ù…Øª UUID Ù†Ø§Ù…Ø¹ØªØ¨Ø±",reenter:"Ù„Ø·ÙØ§ UUID Ù…Ø¹ØªØ¨Ø± Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯"}},l=i[r?"fa":"zh"],c=`<!DOCTYPE html>\n        <html lang="${s}" dir="${r?"rtl":"ltr"}">\n    <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <title>${l.title}</title>\n        <style>\n            * { margin: 0; padding: 0; box-sizing: border-box; }\n            body {\n                font-family: "Courier New", monospace;\n                background: #000; color: #00ff00; min-height: 100vh;\n                overflow-x: hidden; position: relative;\n                display: flex; justify-content: center; align-items: center;\n            }\n            .matrix-bg {\n                position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n                background: #000;\n                z-index: -1;\n            }\n            @keyframes bg-pulse {\n                0%, 100% { background: linear-gradient(45deg, #000 0%, #001100 50%, #000 100%); }\n                50% { background: linear-gradient(45deg, #000 0%, #002200 50%, #000 100%); }\n            }\n            .matrix-rain {\n                position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n                background: transparent;\n                z-index: -1;\n                display: none;\n            }\n            @keyframes matrix-fall {\n                0% { transform: translateY(-100%); }\n                100% { transform: translateY(100vh); }\n            }\n            .matrix-code-rain {\n                position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n                pointer-events: none; z-index: -1;\n                overflow: hidden;\n                display: none;\n            }\n            .matrix-column {\n                position: absolute; top: -100%; left: 0;\n                color: #00ff00; font-family: "Courier New", monospace;\n                font-size: 14px; line-height: 1.2;\n                text-shadow: 0 0 5px #00ff00;\n            }\n            @keyframes matrix-drop {\n                0% { top: -100%; opacity: 1; }\n                10% { opacity: 1; }\n                90% { opacity: 0.3; }\n                100% { top: 100vh; opacity: 0; }\n            }\n            .matrix-column:nth-child(odd) {\n                animation-duration: 12s;\n                animation-delay: -2s;\n            }\n            .matrix-column:nth-child(even) {\n                animation-duration: 18s;\n                animation-delay: -5s;\n            }\n            .matrix-column:nth-child(3n) {\n                animation-duration: 20s;\n                animation-delay: -8s;\n            }\n            .terminal {\n                width: 90%; max-width: 800px; height: 500px;\n                background: rgba(0, 0, 0, 0.9);\n                border: 2px solid #00ff00;\n                border-radius: 8px;\n                box-shadow: 0 0 30px rgba(0, 255, 0, 0.5), inset 0 0 20px rgba(0, 255, 0, 0.1);\n                backdrop-filter: blur(10px);\n                position: relative; z-index: 1;\n                overflow: hidden;\n            }\n            .terminal-header {\n                background: rgba(0, 20, 0, 0.8);\n                padding: 10px 15px;\n                border-bottom: 1px solid #00ff00;\n                display: flex; align-items: center;\n            }\n            .terminal-buttons {\n                display: flex; gap: 8px;\n            }\n            .terminal-button {\n                width: 12px; height: 12px; border-radius: 50%;\n                background: #ff5f57; border: none;\n            }\n            .terminal-button:nth-child(2) { background: #ffbd2e; }\n            .terminal-button:nth-child(3) { background: #28ca42; }\n            .terminal-title {\n                margin-left: 15px; color: #00ff00;\n                font-size: 14px; font-weight: bold;\n            }\n            .terminal-body {\n                padding: 20px; height: calc(100% - 50px);\n                overflow-y: auto; font-size: 14px;\n                line-height: 1.4;\n            }\n            .terminal-line {\n                margin-bottom: 8px; display: flex; align-items: center;\n            }\n            .terminal-prompt {\n                color: #00ff00; margin-right: 10px;\n                font-weight: bold;\n            }\n            .terminal-input {\n                background: transparent; border: none; outline: none;\n                color: #00ff00; font-family: "Courier New", monospace;\n                font-size: 14px; flex: 1;\n                caret-color: #00ff00;\n            }\n            .terminal-input::placeholder {\n                color: #00aa00; opacity: 0.7;\n            }\n            .terminal-cursor {\n                display: inline-block; width: 8px; height: 16px;\n                background: #00ff00;\n                margin-left: 2px;\n            }\n            @keyframes blink {\n                0%, 50% { opacity: 1; }\n                51%, 100% { opacity: 0; }\n            }\n            .terminal-output {\n                color: #00aa00; margin: 5px 0;\n            }\n            .terminal-error {\n                color: #ff4444; margin: 5px 0;\n            }\n            .terminal-success {\n                color: #44ff44; margin: 5px 0;\n            }\n            .matrix-text {\n                position: fixed; top: 20px; right: 20px;\n                color: #00ff00; font-family: "Courier New", monospace;\n                font-size: 0.8rem; opacity: 0.6;\n            }\n            @keyframes matrix-flicker {\n                0%, 100% { opacity: 0.6; }\n                50% { opacity: 1; }\n            }\n        </style>\n    </head>\n    <body>\n        <div class="matrix-bg"></div>\n        <div class="matrix-rain"></div>\n        <div class="matrix-code-rain" id="matrixCodeRain"></div>\n            <div class="matrix-text">${l.terminal}</div>\n            <div style="position: fixed; top: 20px; left: 20px; z-index: 1000;">\n                <select id="languageSelector" style="background: rgba(0, 20, 0, 0.9); border: 2px solid #00ff00; color: #00ff00; padding: 8px 12px; font-family: 'Courier New', monospace; font-size: 14px; cursor: pointer; text-shadow: 0 0 5px #00ff00; box-shadow: 0 0 15px rgba(0, 255, 0, 0.4);" onchange="changeLanguage(this.value)">\n                    <option value="zh" ${r?"":"selected"}>ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>\n                    <option value="fa" ${r?"selected":""}>ğŸ‡®ğŸ‡· ÙØ§Ø±Ø³ÛŒ</option>\n                </select>\n            </div>\n        <div class="terminal">\n            <div class="terminal-header">\n                <div class="terminal-buttons">\n                    <div class="terminal-button"></div>\n                    <div class="terminal-button"></div>\n                    <div class="terminal-button"></div>\n                </div>\n                    <div class="terminal-title">${l.terminal}</div>\n            </div>\n            <div class="terminal-body" id="terminalBody">\n                <div class="terminal-line">\n                    <span class="terminal-prompt">root:~$</span>\n                        <span class="terminal-output">${l.congratulations}</span>\n                </div>\n                <div class="terminal-line">\n                    <span class="terminal-prompt">root:~$</span>\n                        <span class="terminal-output">${cp&&cp.trim()?l.enterD:l.enterU}</span>\n                </div>\n                <div class="terminal-line">\n                    <span class="terminal-prompt">root:~$</span>\n                        <span class="terminal-output">${l.command}${cp&&cp.trim()?l.path:l.uuid}]</span>\n                </div>\n                <div class="terminal-line">\n                    <span class="terminal-prompt">root:~$</span>\n                        <input type="text" class="terminal-input" id="uuidInput" placeholder="${cp&&cp.trim()?l.inputD:l.inputU}" autofocus>\n                    <span class="terminal-cursor"></span>\n                </div>\n            </div>\n        </div>\n        <script>\n            function createMatrixRain() {\n                const matrixContainer = document.getElementById('matrixCodeRain');\n                const matrixChars = '01ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';\n                const columns = Math.floor(window.innerWidth / 18);\n                \n                for (let i = 0; i < columns; i++) {\n                    const column = document.createElement('div');\n                    column.className = 'matrix-column';\n                    column.style.left = (i * 18) + 'px';\n                    column.style.animationDelay = Math.random() * 15 + 's';\n                    column.style.animationDuration = (Math.random() * 15 + 8) + 's';\n                    column.style.fontSize = (Math.random() * 4 + 12) + 'px';\n                    column.style.opacity = Math.random() * 0.8 + 0.2;\n                    \n                    let text = '';\n                    const charCount = Math.floor(Math.random() * 30 + 20);\n                    for (let j = 0; j < charCount; j++) {\n                        const char = matrixChars[Math.floor(Math.random() * matrixChars.length)];\n                        const brightness = Math.random() > 0.1 ? '#00ff00' : '#00aa00';\n                        text += '<span style="color: ' + brightness + ';">' + char + '</span><br>';\n                    }\n                    column.innerHTML = text;\n                    matrixContainer.appendChild(column);\n                }\n                \n                setInterval(function() {\n                    const columns = matrixContainer.querySelectorAll('.matrix-column');\n                    columns.forEach(function(column) {\n                        if (Math.random() > 0.95) {\n                            const chars = column.querySelectorAll('span');\n                            if (chars.length > 0) {\n                                const randomChar = chars[Math.floor(Math.random() * chars.length)];\n                                randomChar.style.color = '#ffffff';\n                                setTimeout(function() {\n                                    randomChar.style.color = '#00ff00';\n                                }, 200);\n                            }\n                        }\n                    });\n                }, 100);\n            }\n            \n            function isValidUUID(uuid) {\n                const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n                return uuidRegex.test(uuid);\n            }\n            \n            function addTerminalLine(content, type = 'output') {\n                const terminalBody = document.getElementById('terminalBody');\n                const line = document.createElement('div');\n                line.className = 'terminal-line';\n                \n                const prompt = document.createElement('span');\n                prompt.className = 'terminal-prompt';\n                prompt.textContent = 'root:~$';\n                \n                const output = document.createElement('span');\n                output.className = 'terminal-' + type;\n                output.textContent = content;\n                \n                line.appendChild(prompt);\n                line.appendChild(output);\n                terminalBody.appendChild(line);\n                \n                terminalBody.scrollTop = terminalBody.scrollHeight;\n            }\n            \n            function handleUUIDInput() {\n                const input = document.getElementById('uuidInput');\n                const inputValue = input.value.trim();\n                const cp = '${cp}';\n                \n                if (inputValue) {\n                    addTerminalLine(atob('Y29ubmVjdCA=') + inputValue, 'output');\n                        \n                        const translations = {\n                            zh: {\n                                connecting: 'æ­£åœ¨è¿æ¥...',\n                                invading: 'æ­£åœ¨å…¥ä¾µ...',\n                                success: 'è¿æ¥æˆåŠŸï¼è¿”å›ç»“æœ...',\n                                error: 'é”™è¯¯: æ— æ•ˆçš„UUIDæ ¼å¼',\n                                reenter: 'è¯·é‡æ–°è¾“å…¥æœ‰æ•ˆçš„UUID'\n                            },\n                            fa: {\n                                connecting: 'Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„...',\n                                invading: 'Ø¯Ø± Ø­Ø§Ù„ Ù†ÙÙˆØ°...',\n                                success: 'Ø§ØªØµØ§Ù„ Ù…ÙˆÙÙ‚! Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª Ù†ØªÛŒØ¬Ù‡...',\n                                error: 'Ø®Ø·Ø§: ÙØ±Ù…Øª UUID Ù†Ø§Ù…Ø¹ØªØ¨Ø±',\n                                reenter: 'Ù„Ø·ÙØ§ UUID Ù…Ø¹ØªØ¨Ø± Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯'\n                            }\n                        };\n                        const browserLang = navigator.language || navigator.userLanguage || '';\n                        const isFarsi = browserLang.includes('fa') || browserLang.includes('fa-IR');\n                        const t = translations[isFarsi ? 'fa' : 'zh'];\n                    \n                    if (cp) {\n                        const cleanInput = inputValue.startsWith('/') ? inputValue : '/' + inputValue;\n                            addTerminalLine(t.connecting, 'output');\n                        setTimeout(() => {\n                                addTerminalLine(t.success, 'success');\n                            setTimeout(() => {\n                                window.location.href = cleanInput;\n                            }, 1000);\n                        }, 500);\n                    } else {\n                        if (isValidUUID(inputValue)) {\n                            addTerminalLine(t.invading, 'output');\n                        setTimeout(() => {\n                                addTerminalLine(t.success, 'success');\n                            setTimeout(() => {\n                                    window.location.href = '/' + inputValue;\n                            }, 1000);\n                        }, 500);\n                    } else {\n                            addTerminalLine(t.error, 'error');\n                            addTerminalLine(t.reenter, 'output');\n                        }\n                    }\n                    \n                    input.value = '';\n                }\n            }\n                \n                function changeLanguage(lang) {\n                    localStorage.setItem('preferredLanguage', lang);\n                    // è®¾ç½®Cookieï¼ˆæœ‰æ•ˆæœŸ1å¹´ï¼‰\n                    const expiryDate = new Date();\n                    expiryDate.setFullYear(expiryDate.getFullYear() + 1);\n                    document.cookie = 'preferredLanguage=' + lang + '; path=/; expires=' + expiryDate.toUTCString() + '; SameSite=Lax';\n                    // åˆ·æ–°é¡µé¢ï¼Œä¸ä½¿ç”¨URLå‚æ•°\n                    window.location.reload();\n                }\n                \n                // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ localStorage å’Œ Cookieï¼Œå¹¶æ¸…ç†URLå‚æ•°\n                window.addEventListener('DOMContentLoaded', function() {\n                    function getCookie(name) {\n                        const value = '; ' + document.cookie;\n                        const parts = value.split('; ' + name + '=');\n                        if (parts.length === 2) return parts.pop().split(';').shift();\n                        return null;\n                    }\n                    \n                    const savedLang = localStorage.getItem('preferredLanguage') || getCookie('preferredLanguage');\n                    const urlParams = new URLSearchParams(window.location.search);\n                    const urlLang = urlParams.get('lang');\n                    \n                    // å¦‚æœURLä¸­æœ‰è¯­è¨€å‚æ•°ï¼Œç§»é™¤å®ƒå¹¶è®¾ç½®Cookie\n                    if (urlLang) {\n                        const currentUrl = new URL(window.location.href);\n                        currentUrl.searchParams.delete('lang');\n                        const newUrl = currentUrl.toString();\n                        \n                        // è®¾ç½®Cookie\n                        const expiryDate = new Date();\n                        expiryDate.setFullYear(expiryDate.getFullYear() + 1);\n                        document.cookie = 'preferredLanguage=' + urlLang + '; path=/; expires=' + expiryDate.toUTCString() + '; SameSite=Lax';\n                        localStorage.setItem('preferredLanguage', urlLang);\n                        \n                        // ä½¿ç”¨history APIç§»é™¤URLå‚æ•°ï¼Œä¸åˆ·æ–°é¡µé¢\n                        window.history.replaceState({}, '', newUrl);\n                    } else if (savedLang) {\n                        // å¦‚æœlocalStorageä¸­æœ‰ä½†Cookieä¸­æ²¡æœ‰ï¼ŒåŒæ­¥åˆ°Cookie\n                        const expiryDate = new Date();\n                        expiryDate.setFullYear(expiryDate.getFullYear() + 1);\n                        document.cookie = 'preferredLanguage=' + savedLang + '; path=/; expires=' + expiryDate.toUTCString() + '; SameSite=Lax';\n                    }\n                });\n            \n            document.addEventListener('DOMContentLoaded', function() {\n                const input = document.getElementById('uuidInput');\n                input.focus();\n                input.addEventListener('keypress', function(e) {\n                    if (e.key === 'Enter') {\n                        handleUUIDInput();\n                    }\n                });\n            });\n        </script>\n    </body>\n    </html>`;return new Response(c,{status:200,headers:{"Content-Type":"text/html; charset=utf-8"}})}if(cp&&cp.trim()){const n=cp.trim().startsWith("/")?cp.trim():"/"+cp.trim(),t=n.endsWith("/")&&n.length>1?n.slice(0,-1):n,o=v.pathname.endsWith("/")&&v.pathname.length>1?v.pathname.slice(0,-1):v.pathname;if(o===t)return await handleSubscriptionPage(e,at);if(o===t+"/sub")return await handleSubscriptionRequest(e,at,v);if(v.pathname.length>1&&"/"!==v.pathname){const e=v.pathname.replace(/\/$/,"").replace("/sub","").substring(1);if(isValidFormat(e))return new Response(JSON.stringify({error:"è®¿é—®è¢«æ‹’ç»",message:"å½“å‰ Worker å·²å¯ç”¨è‡ªå®šä¹‰è·¯å¾„æ¨¡å¼ï¼ŒUUID è®¿é—®å·²ç¦ç”¨"}),{status:403,headers:{"Content-Type":"application/json"}})}}else{if(v.pathname.length>1&&"/"!==v.pathname&&!v.pathname.includes("/sub")){const n=v.pathname.replace(/\/$/,"").substring(1);if(isValidFormat(n))return n===at?await handleSubscriptionPage(e,n):new Response(JSON.stringify({error:"UUIDé”™è¯¯ è¯·æ³¨æ„å˜é‡åç§°æ˜¯uä¸æ˜¯uuid"}),{status:403,headers:{"Content-Type":"application/json"}})}if(v.pathname.includes("/sub")){const n=v.pathname.split("/");if(2===n.length&&"sub"===n[1]){const t=n[0].substring(1);if(isValidFormat(t))return t===at?await handleSubscriptionRequest(e,t,v):new Response(JSON.stringify({error:"UUIDé”™è¯¯"}),{status:403,headers:{"Content-Type":"application/json"}})}}}if(v.pathname.toLowerCase().includes(`/${o}`))return await handleSubscriptionRequest(e,at)}return new Response(JSON.stringify({error:"Not Found"}),{status:404,headers:{"Content-Type":"application/json"}})}catch(e){return new Response(e.toString(),{status:500})}}};let echDebugInfo="",ACTIVE_CONNECTIONS=0;const XHTTP_BUFFER_SIZE=131072,CONNECT_TIMEOUT_MS=5e3,IDLE_TIMEOUT_MS=45e3,MAX_RETRIES=2,MAX_CONCURRENT=32;class XhttpCounter{#e;constructor(){this.#e=0}get(){return this.#e}add(e){this.#e+=e}}const hexTable=Array.from({length:256},(e,n)=>(n+256).toString(16).slice(1));